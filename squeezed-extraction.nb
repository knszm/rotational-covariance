(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    281907,       6794]
NotebookOptionsPosition[    271414,       6637]
NotebookOutlinePosition[    271861,       6654]
CellTagsIndexPosition[    271818,       6651]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Interferometric properties of the state extractable via an operation \
commuting with the interferometer\
\>", "Text",
 CellChangeTimes->{{3.929095994227631*^9, 
  3.929096094791791*^9}},ExpressionUUID->"11a8116b-a7a3-404f-94f0-\
4110b7cf94c8"],

Cell["\<\
In this notebook we will present calculations involving the properties of a \
(0+2)-photon approximation to squeezed vacuum, and show that it can be \
extracted using operations commuting with a balanced interferometer.\
\>", "Text",
 CellChangeTimes->{{3.929096099624773*^9, 
  3.92909618664589*^9}},ExpressionUUID->"468b8d79-6b7d-4042-877c-\
a358d8d2fe81"],

Cell[TextData[StyleBox["Matrices  definition",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232920600617*^9, 3.928232926079948*^9}, 
   3.928233160782165*^9, 
   3.92909609801503*^9},ExpressionUUID->"25439731-9b14-430c-8881-\
c1ba9dfdbd82"],

Cell[TextData[{
 "In the Heisenberg picture, one can interpret the action of passive optical \
elements as modifying the annihilation/creation operators with matrices. The \
output annihilation/creation operators are described as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              SubsuperscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], "1", "\[Prime]"], ",", 
              "\[Ellipsis]", ",", 
              SubsuperscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], 
               StyleBox["n", "TI"], "\[Prime]"], ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], "1", "\[Prime]\[Dagger]"], ",", 
              "\[Ellipsis]", ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], 
               StyleBox["n", "TI"], "\[Prime]\[Dagger]"]}], ")"}], 
          StyleBox["T", "TI"]], "\[LongEqual]", 
         StyleBox["U", "TI"], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              SubscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], "1"], ",", "\[Ellipsis]", ",", 
              SubsuperscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], 
               StyleBox["n", "TI"], "\[Prime]"], ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], "1", "\[Dagger]"], ",", "\[Ellipsis]", 
              ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], 
               StyleBox["n", "TI"], "\[Dagger]"]}], ")"}], 
          StyleBox["T", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\hat a'_1, \\ldots, \\hat a'_n, a'^\\dagger_1, \\ldots, \
a'^\\dagger_n)^T=U (\\hat a_1, \\ldots, \\hat a'_n, a^\\dagger_1, \\ldots, a^\
\\dagger_n)^T", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f3749cf2-e3d6-4652-be40-3e3a78ce6334"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["U", "TI"], TraditionalForm], "errors" -> {}, "input" -> "U", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "50c3659c-7a50-4f6b-b71e-86ddc32e8188"],
 " is an unitary operator describing the passive element. In the case of two \
modes, the following unitaries acting on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubsuperscriptBox[
            StyleBox["a", "TI"], "1", "\[Dagger]"], ",", 
           SubsuperscriptBox[
            StyleBox["a", "TI"], "2", "\[Dagger]"]}], ")"}], TraditionalForm],
      "errors" -> {}, "input" -> "(a_1, a_2, a_1^\\dagger, a_2^\\dagger)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfce391b-9ea3-4730-8262-aafa02e712c8"],
 " describe the two basic elements: ",
 StyleBox["beamsplitter",
  FontSlant->"Italic"],
 " (matrix ",
 StyleBox["B",
  FontWeight->"Bold"],
 "), and ",
 StyleBox["balanced phase shift",
  FontSlant->"Italic"],
 " (matrix ",
 StyleBox["P",
  FontWeight->"Bold"],
 "). \nWe are using the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"4", "\[Cross]", "4"}], TraditionalForm], "errors" -> {}, 
     "input" -> "4\\times 4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d0fe8f09-94b8-4d0d-858c-0e7afe367cec"],
 " matrices for easier calculations; this description also allows for easy \
generalization to squeezing operations. For ",
 StyleBox["passive",
  FontSlant->"Italic"],
 " elements, the matrices split into diagonal blocks as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "\[LongEqual]", 
         StyleBox["V", "TI"], "\[CirclePlus]", 
         SuperscriptBox[
          StyleBox["V", "TI"], "*"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "U=V\\oplus V^*", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "276d5557-add3-4d2d-853c-e1244765a3f8"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["V", "TI"], TraditionalForm], "errors" -> {}, "input" -> "V", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7862803f-7c0e-46db-a227-773993094cfd"],
 " acts on the annihilation operators and the conjugate matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["V", "TI"], "*"], TraditionalForm], "errors" -> {}, "input" -> 
     "V^*", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "daa772ac-e4df-4bb5-bc18-539a3bcdd93c"],
 "acts on creation operators."
}], "Text",
 CellChangeTimes->{{3.929096191305237*^9, 3.929096226719604*^9}, {
  3.929096259456402*^9, 3.9290963936186*^9}, {3.92909645395444*^9, 
  3.929096803300857*^9}},ExpressionUUID->"353e80a2-c3eb-4258-a6cf-\
e4beebfafee1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"B", "=", 
    FractionBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "\[ImaginaryI]", "0", "0"},
        {"\[ImaginaryI]", "1", "0", "0"},
        {"0", "0", "1", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "1"}
       }], "\[NoBreak]", ")"}], 
     SqrtBox["2"]]}], ";"}], " ", 
  RowBox[{"(*", "beamsplitter", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Phi]", "/", "2"}]}], "]"}], "0", "0", "0"},
       {"0", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"\[Phi]", "/", "2"}]}], "]"}], "0", "0"},
       {"0", "0", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"\[Phi]", "/", "2"}]}], "]"}], "0"},
       {"0", "0", "0", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Phi]", "/", "2"}]}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"balanced", " ", "phase", " ", "shift"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.87750029233671*^9, 3.8775003766541557`*^9}, {
   3.877500410288145*^9, 3.877500478263955*^9}, {3.877500529280114*^9, 
   3.87750064621939*^9}, {3.877502385964789*^9, 3.87750239758429*^9}, {
   3.877502509199201*^9, 3.877502517810066*^9}, {3.8775025597657213`*^9, 
   3.877502564352618*^9}, {3.877502674560464*^9, 3.8775026900187173`*^9}, {
   3.877502996468659*^9, 3.877502998246778*^9}, {3.877503034141143*^9, 
   3.877503050670691*^9}, {3.8775107544139986`*^9, 3.87751077750244*^9}, {
   3.877510854272921*^9, 3.877510873073705*^9}, 3.877535535012128*^9, {
   3.928228892046017*^9, 3.9282289059412937`*^9}, {3.928229008741539*^9, 
   3.9282290359004393`*^9}, 3.928233730307143*^9, {3.928237187489324*^9, 
   3.928237189016533*^9}, {3.928237587433998*^9, 3.9282376194989*^9}, {
   3.928237767649231*^9, 3.9282377935385857`*^9}, {3.928237835490532*^9, 
   3.928237928928327*^9}, {3.9282379975607986`*^9, 3.92823805180586*^9}, {
   3.928238084572597*^9, 3.928238145557184*^9}, {3.928238705794774*^9, 
   3.928238770690138*^9}, {3.928394556640839*^9, 3.928394591210416*^9}, {
   3.928394623987451*^9, 3.928394626690456*^9}, {3.928394717812331*^9, 
   3.92839477788388*^9}, {3.928395992052342*^9, 3.928395994314287*^9}, {
   3.928396127117742*^9, 3.928396131904269*^9}, {3.92882945021821*^9, 
   3.928829486936781*^9}, {3.92884525361839*^9, 3.928845282602647*^9}, {
   3.928845361994525*^9, 3.928845362170163*^9}, {3.928846582639616*^9, 
   3.928846611816808*^9}, 3.929094630914456*^9, {3.929096234138125*^9, 
   3.929096244041649*^9}, 3.929096490164065*^9, {3.929096717852838*^9, 
   3.929096730420252*^9}, 3.929096813125227*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"b9af32fb-3b0d-421c-bbbb-9173056c15a2"],

Cell[TextData[{
 "We will manipulate expressions involving comp\[LineSeparator]lex products \
of annihilation and creation operators with the internal ",
 StyleBox["Dot",
  FontWeight->"Bold"],
 " function (used in Wolfram language to denote the standard matrix \
product)",
 ", and they are not automatically handled with Mathematica. The following \
function defines rules simplifying such expressions: removal of numerical \
factors outside of the dot product, commutation rules, and mode index \
ordering."
}], "Text",
 CellChangeTimes->{{3.9290968170707808`*^9, 3.929096873283569*^9}, {
   3.929096913332741*^9, 3.929097134974153*^9}, 
   3.929102882581688*^9},ExpressionUUID->"b48d6638-1dea-49ff-a477-\
44cee38624cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"simprules", "[", 
     RowBox[{"order_", ":", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          RowBox[{"prefactor_", " ", "op_"}], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"id", ",", 
             SubscriptBox["a", "1"], ",", 
             SubscriptBox["A", "1"], ",", 
             SubscriptBox["a", "2"], ",", 
             SubscriptBox["A", "2"]}], "}"}], ",", "op"}], "]"}], ")"}]}], ":>", 
       RowBox[{"prefactor", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "op", ",", "ops2"}], "]"}]}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"move", " ", "non"}], "-", 
         RowBox[{"operator", " ", "prefactors", " ", 
          RowBox[{"outside", ".", " ", "a", ".", 
           RowBox[{"(", 
            RowBox[{"prefactor", " ", "b"}], ")"}]}]}]}], "=", 
        RowBox[{"prefactor", " ", 
         RowBox[{"a", ".", "b"}]}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          RowBox[{"prefactor_", " ", "op_"}], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "op", "]"}], "==", "Dot"}]}], ":>", 
       RowBox[{"prefactor", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "op", ",", "ops2"}], "]"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"collapse", " ", "stacked", " ", "dot", " ", "products"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"a", ".", 
          RowBox[{"(", 
           RowBox[{"prefactor", " ", 
            RowBox[{"b", ".", "c"}]}], ")"}], ".", "d"}], "=", 
         RowBox[{"prefactor", " ", 
          RowBox[{"a", ".", "b", ".", "c", ".", "d"}]}]}]}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"ops1_", ",", "id", ",", "ops2_"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"collapse", " ", "identity", " ", "operators"}], ",", " ", 
        RowBox[{"\[Times]", "3"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"id", ",", "ops1_", ",", "ops2_"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"ops1_", ",", "ops2_", ",", "id"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"i", "==", "j"}]}], ":>", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", 
          SubscriptBox["A", "j"], ",", 
          SubscriptBox["a", "i"], ",", "ops2"}], "]"}], "+", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "id", ",", "id", ",", "ops2"}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "creation", " ", "operators", " ", "to", " ", "the", " ",
          "left"}], ",", " ", 
        RowBox[{
        "adding", " ", "identity", " ", "due", " ", "to", " ", "commutation", 
         " ", "rules"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"i", "!=", "j"}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["A", "j"], ",", 
         SubscriptBox["a", "i"], ",", "ops2"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "creation", " ", "ops", " ", "to", " ", "the", " ", 
         "left"}], " ", "-", " ", 
        RowBox[{
        "they", " ", "commute", " ", "for", " ", "different", " ", 
         "modes"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["a", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"order", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ">", 
         RowBox[{"order", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["a", "j"], ",", 
         SubscriptBox["a", "i"], ",", "ops2"}], "]"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "enforce", " ", "mode", " ", "index", " ", "ordering", " ", "for", 
         " ", "easier", " ", "calculations"}], ",", " ", 
        RowBox[{"\[Times]", "2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["A", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"order", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         RowBox[{"order", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["A", "j"], ",", 
         SubscriptBox["A", "i"], ",", "ops2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pref_", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          SubscriptBox["a", "i_"], ",", "id"}], "]"}]}], ":>", " ", 
       RowBox[{"pref", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"id", ",", 
          SubscriptBox["a", "i"]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "identity", " ", "operators", " ", "to", " ", "the", " ",
          "center"}], ",", " ", 
        RowBox[{
        "they", " ", "have", " ", "to", " ", "be", " ", "preserved", " ", 
         "for", " ", "easier", " ", "symbolic", " ", "calculations"}]}], 
       "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pref_", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"id", ",", 
          SubscriptBox["A", "i_"]}], "]"}]}], ":>", " ", 
       RowBox[{"pref", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", "id"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.929097139765477*^9, 3.929097447872237*^9}, 
   3.929513788527834*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"0473cb4d-5aa6-439f-a42b-b7026eeaec40"],

Cell[TextData[{
 "If the total expression is presented as sum of terms in the normal ordering \
(each term having form ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["a", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"], "\[Dagger]"], "\[Ellipsis]", 
         SubscriptBox[
          StyleBox["a", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], 
           StyleBox["k", "TI"]]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "a^\\dagger_{i_1} \\ldots a_{i_k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f92ce4f6-5f84-4860-81c9-c8d556b75b77"],
 "), only the terms containing ",
 StyleBox["identity operators alone",
  FontSlant->"Italic"],
 " contribute to the vacuum expectation value: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"0", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "|", 
             SubsuperscriptBox[
              StyleBox["a", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"], "\[Dagger]"], "\[Ellipsis]", 
             SubscriptBox[
              StyleBox["a", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], 
               StyleBox["k", "TI"]]], "|", "\[NegativeThinSpace]", 
             "\[NegativeThinSpace]", "0"}], "\[RightAngleBracket]"}], 
         "\[LongEqual]", "0"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle 0\\!\\!\\lvert a^\\dagger_{i_1} \\ldots a_{i_k} \\lvert\\!\\!0\
\\rangle=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b44c7cc-b01b-4c19-b663-fe2447d1d0c6"],
 ", but ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
           
           RowBox[{"0", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "|", 
             "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0"}], 
           "\[RightAngleBracket]"}], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\langle 0\\!\\! \\lvert\\!\\!0\\rangle = 1",
      "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ae1ac83b-d10c-4d26-b732-c86fba5a76da"],
 ". The following function defines the rules to simplify the terms (for \
specific mode ",
 StyleBox["indices",
  FontWeight->"Bold"],
 " \[Dash] later it will be useful to assume that e.g. mode 1 is in vacuum, \
but mode 2 is in a superposition of finitely many Fock states)",
 ", leaving only products of identity operators."
}], "Text",
 CellChangeTimes->{{3.929097449434989*^9, 3.9290976397304993`*^9}, {
  3.929097720338671*^9, 3.929097883123159*^9}, {3.929097922395061*^9, 
  3.929098009971851*^9}},ExpressionUUID->"8fbd5220-25fb-431d-858e-\
adc7b93268ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expvacuumrules", "[", 
     RowBox[{"indices_", ",", 
      RowBox[{"order_", ":", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"simprules", "[", "order", "]"}], "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pref_", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{"ops1__", ",", 
            SubscriptBox["a", "i_"]}], "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"indices", ",", "i"}], "]"}]}], ":>", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pref_", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{
            SubscriptBox["A", "i_"], ",", "ops1__"}], "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"indices", ",", "i"}], "]"}]}], ":>", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pref_", " ", 
         RowBox[{"id", ".", "id", ".", "id"}]}], ":>", 
        RowBox[{"pref", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{"id", ",", "id"}], "]"}]}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.929097442626733*^9, 3.929097442811807*^9}, {
   3.929097509868264*^9, 3.92909751037886*^9}, 3.929097570755053*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"1fafb6b8-d35f-4851-9063-b6e1f54b3b04"],

Cell["\<\
So, the final expression for vacuum expectation value is calculated by the \
following rule, turning identity operators into ones.\
\>", "Text",
 CellChangeTimes->{{3.929097563100377*^9, 3.929097565609479*^9}, {
  3.929097886608778*^9, 3.929097915346574*^9}, {3.9290980158833714`*^9, 
  3.929098045051982*^9}},ExpressionUUID->"bd05db12-d219-4f48-88d2-\
4b9d37a4cba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalizerules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pref_", " ", 
      RowBox[{"id", ".", "id"}]}], ":>", 
     RowBox[{"pref", " ", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.929097898171425*^9, 3.929097902563404*^9}, {
  3.929098047476344*^9, 3.929098047627878*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"925bc0ab-c9c7-4ee5-ab9e-21f479c1cb4e"],

Cell[TextData[StyleBox["Unsqueezed  light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232930022177*^9, 3.9282329334651337`*^9}, {
  3.928846934819381*^9, 
  3.928846935547585*^9}},ExpressionUUID->"d3ce012f-b54d-4e1c-8579-\
c31a90c7844a"],

Cell[TextData[{
 "First, let us calculate the phase determination error of an interferometer \
having coherent state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma \\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "073d0c89-c805-4b4e-87d5-f2ba17de11d5"],
 " as one of its inputs, while the second mode is in vacuum. For consistency, \
we want to use only the vacuum expectation values, and thus the first part is \
to perform the displacement operation ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["D", "TI"], "(", "\[Gamma]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D(\\gamma)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "99bdb5f8-bd69-4b1e-906d-b9e76efec6f3"],
 ", turning ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ae5b9034-db76-490c-bc49-3e85128781f5"],
 " into ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["a", "TI"], "1"], "+", "\[Gamma]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "a_1+\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "071ccaec-cd8e-43d5-a16d-af6a243eaa93"],
 "."
}], "Text",
 CellChangeTimes->{{3.929098055629073*^9, 
  3.929098209060256*^9}},ExpressionUUID->"4b8aa022-6fa5-4f6b-925f-\
ee2390c93409"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "1"], "+", 
      RowBox[{"\[Gamma]", " ", "id"}]}], ",", 
     SubscriptBox["a", "2"], ",", 
     RowBox[{
      SubscriptBox["A", "1"], "+", 
      RowBox[{
       RowBox[{"\[Gamma]", "\[Conjugate]"}], " ", "id"}]}], ",", 
     SubscriptBox["A", "2"]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.92909821126877*^9, 3.929098222323228*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c734449c-f6bd-4297-bb6c-c318eb50541d"],

Cell[TextData[{
 "Then, the final modes at the interferometer output are modified by the \
matrices described above. Expectation value of the photon number difference \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["a", "TI"], "2", "\[Prime]\[Dagger]"], 
         SubsuperscriptBox[
          StyleBox["a", "TI"], "2", "\[Prime]"], "-", 
         SubsuperscriptBox[
          StyleBox["a", "TI"], "1", "\[Prime]\[Dagger]"], 
         SubscriptBox[
          StyleBox["a", "TI"], "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "a'^\\dagger_2 a'_2-a'^\\dagger_1 a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d7f4daf-6d38-44fd-ad7e-c9f87a7c479f"],
 " at the interferometer output will be calculated from the following \
expression ",
 StyleBox["exprC",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929098224196476*^9, 3.92909825235671*^9}, {
  3.929098341124178*^9, 3.929098406213184*^9}, {3.929098518138268*^9, 
  3.929098548229991*^9}},ExpressionUUID->"f93d8e2c-402c-47cd-9e89-\
560b8705fc45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        SubscriptBox["b", "2"], ",", 
        SubscriptBox["\[Beta]", "1"], ",", 
        SubscriptBox["\[Beta]", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exprC", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Distribute", "[", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["\[Beta]", "2"], ")"}], ".", 
        RowBox[{"(", 
         SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
      RowBox[{"Distribute", "[", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["\[Beta]", "1"], ")"}], ".", 
        RowBox[{"(", 
         SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
    RowBox[{"simprules", "[", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.877510104926837*^9, 3.877510179645915*^9}, {
   3.877510308434112*^9, 3.8775103204758377`*^9}, {3.8775104264861603`*^9, 
   3.877510451439056*^9}, 3.877510726559623*^9, {3.877510782283139*^9, 
   3.877510790383659*^9}, {3.877510869450303*^9, 3.877510879391086*^9}, {
   3.877533654144614*^9, 3.877533655028832*^9}, {3.877535536701421*^9, 
   3.877535538099533*^9}, {3.877535608629103*^9, 3.877535647662274*^9}, {
   3.87753580266549*^9, 3.877535997757814*^9}, {3.877536067276531*^9, 
   3.877536074922817*^9}, {3.877536120330261*^9, 3.877536121315572*^9}, {
   3.877540239184128*^9, 3.8775402439447517`*^9}, {3.928228922870145*^9, 
   3.928228923642014*^9}, {3.928232576648427*^9, 3.928232603926406*^9}, 
   3.928232749688284*^9, {3.928233089478608*^9, 3.928233089945859*^9}, 
   3.928233168100402*^9, {3.928233440762369*^9, 3.928233453298933*^9}, {
   3.9282351788997183`*^9, 3.928235187746468*^9}, {3.928235258991047*^9, 
   3.928235291215637*^9}, {3.928235427819099*^9, 3.928235455681892*^9}, {
   3.92823684161922*^9, 3.928236843230812*^9}, {3.928237034855301*^9, 
   3.928237036295669*^9}, {3.928238249366626*^9, 3.928238249537783*^9}, {
   3.928394212504321*^9, 3.928394256363037*^9}, 3.928394286646654*^9, {
   3.928394322931553*^9, 3.928394359048991*^9}, {3.928396042900866*^9, 
   3.92839604413211*^9}, {3.928845172056117*^9, 3.92884517297189*^9}, {
   3.929091816236569*^9, 3.929091857006268*^9}, {3.929091942836211*^9, 
   3.929092032346127*^9}, {3.9290921700946198`*^9, 3.929092428835946*^9}, {
   3.929092472909183*^9, 3.9290926365906773`*^9}, {3.929092693866211*^9, 
   3.929092767104327*^9}, {3.9290927976202097`*^9, 3.9290928649372873`*^9}, {
   3.929092900344981*^9, 3.929092940490257*^9}, {3.929093008100308*^9, 
   3.9290930183541594`*^9}, {3.929093079637093*^9, 3.929093093665015*^9}, {
   3.929093131397019*^9, 3.929093178502696*^9}, {3.929093214388701*^9, 
   3.929093214989604*^9}, {3.929093257038352*^9, 3.929093346444541*^9}, {
   3.929093386603266*^9, 3.9290934008123693`*^9}, {3.929093438080965*^9, 
   3.929093515318161*^9}, 3.929093673983427*^9, {3.929093732885015*^9, 
   3.929093743339943*^9}, {3.9290937899549*^9, 3.929093822821428*^9}, {
   3.929093886602148*^9, 3.9290939125783*^9}, {3.929093944755136*^9, 
   3.929093949459553*^9}, {3.9290940309219093`*^9, 3.929094032137701*^9}, {
   3.92909406332516*^9, 3.9290940900377693`*^9}, {3.9290941645031643`*^9, 
   3.929094220451377*^9}, {3.929094298530089*^9, 3.929094336633998*^9}, {
   3.9290947734806843`*^9, 3.92909485611444*^9}, {3.929095003775914*^9, 
   3.929095009871474*^9}, {3.929095052449793*^9, 3.929095052823015*^9}, {
   3.929095171102938*^9, 3.929095207591297*^9}, {3.929095243968359*^9, 
   3.9290952709477262`*^9}, {3.929095681855893*^9, 3.929095682408023*^9}, 
   3.929096808457825*^9, 3.929097434771515*^9, {3.9290981311994743`*^9, 
   3.929098133111816*^9}, {3.92909825999158*^9, 3.9290983043035507`*^9}, {
   3.929098372045371*^9, 3.9290983762039013`*^9}, 3.9290984084341717`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"f3fa0051-3ad0-4c1a-8fc5-36e6e57cd460"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Gamma]"}], " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"id", ".", "id"}]}], "-", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", "id"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.92909826299591*^9, 3.9290983314459743`*^9}, 
   3.929098376997556*^9, {3.929098409421619*^9, 3.929098415802911*^9}, 
   3.929098556463698*^9, 3.929102143911262*^9, 3.929102891904117*^9, 
   3.929434074520478*^9, 3.929515881355538*^9, 3.9295198536212683`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"7b2dac48-11b4-46cf-9fc3-56e69c6aa87e"]
}, Open  ]],

Cell[TextData[{
 "... while the variance of photon number difference depends on the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            SubsuperscriptBox[
             StyleBox["a", "TI"], "2", "\[Prime]\[Dagger]"], 
            SubsuperscriptBox[
             StyleBox["a", "TI"], "2", "\[Prime]"], "-", 
            SubsuperscriptBox[
             StyleBox["a", "TI"], "1", "\[Prime]\[Dagger]"], 
            SubscriptBox[
             StyleBox["a", "TI"], "1"]}], ")"}], "2"], TraditionalForm], 
     "errors" -> {}, "input" -> "(a'^\\dagger_2 a'_2-a'^\\dagger_1 a_1)^2", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "450e0335-07af-478b-abe0-974bf220e366"],
 " (too long to print out):"
}], "Text",
 CellChangeTimes->{{3.9290984177500763`*^9, 3.9290984683390007`*^9}, {
  3.929098566517588*^9, 
  3.9290985668798027`*^9}},ExpressionUUID->"7c124203-b043-4588-abb1-\
a5ed70085bf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr2C", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", 
      RowBox[{"exprC", ".", "exprC"}], "]"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"e1288059-4795-4b91-960b-8fd7528c39eb"],

Cell["\<\
The  expectation values of the photon number, as well as its second power, \
and the resulting variance are calculated here to be used later:\
\>", "Text",
 CellChangeTimes->{{3.929098475134253*^9, 3.929098509948094*^9}, {
  3.929098580647091*^9, 
  3.92909859195844*^9}},ExpressionUUID->"cd976194-c723-47a7-88b9-\
e76026365ed4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"firstmomCOH", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"exprC", "//.", 
        RowBox[{"expvacuumrules", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}], "//",
       "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"secmomCOH", "=", 
     RowBox[{
      RowBox[{"expr2C", "//.", 
       RowBox[{"expvacuumrules", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varCOH", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"secmomCOH", "-", 
         SuperscriptBox["firstmomCOH", "2"]}], "//", "Expand"}], "//", 
       "FullSimplify"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: \>\"", ",", 
     "firstmomCOH"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<variance of \!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\): \>\"", ",", "varCOH"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.928238177337919*^9, 3.9282381990114937`*^9}, {
   3.928238714854802*^9, 3.928238719395523*^9}, {3.92909286927872*^9, 
   3.929092885006557*^9}, {3.929092948217854*^9, 3.9290929615606194`*^9}, {
   3.9290930264409246`*^9, 3.929093029967545*^9}, {3.929094353870448*^9, 
   3.929094355806755*^9}, 3.929095209546673*^9, {3.929095275443971*^9, 
   3.929095280571444*^9}, {3.929098595734933*^9, 3.929098638064992*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"d3d75803-7d52-4103-aa44-45a779fd62f7"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \\(2\\)]\\)-\
\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "\[Gamma]"}], " ", 
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}],
  SequenceForm[
  "\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: ", \
-$CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
   Cos[$CellContext`\[Phi]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9290986225227213`*^9, 3.929098638373255*^9}, 
   3.929102146769012*^9, 3.929102895549313*^9, 3.929434078484003*^9, 
   3.929515883434529*^9, 3.9295198558831253`*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"c12c6479-6b18-4c3d-b4c6-98e5e2ba6cc1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"variance of \\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}],
  SequenceForm[
  "variance of \!\(\*SubscriptBox[\(N\), \(2\)]\)-\!\(\*SubscriptBox[\(N\), \
\(1\)]\): ", Abs[$CellContext`\[Gamma]]^2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9290986225227213`*^9, 3.929098638373255*^9}, 
   3.929102146769012*^9, 3.929102895549313*^9, 3.929434078484003*^9, 
   3.929515883434529*^9, 3.929519855884975*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"bb0f6dff-8a65-4397-b47d-25a495d2744a"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "We recover the standard result that the variance is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[Gamma]", 
         SuperscriptBox["|", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\lvert \\gamma\\rvert^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a09f9ed-eeee-44a3-b739-bfad2333eae3"],
 " for the input coherent state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c458ca66-48f4-4989-8dc6-82485a3cecbe"],
 "."
}], "Text",
 CellChangeTimes->{{3.929098639039614*^9, 
  3.929098675550449*^9}},ExpressionUUID->"ff9523a3-24aa-41de-b148-\
b2c3615af9be"],

Cell[TextData[StyleBox["Squeezed light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232948196589*^9, 3.9282329518692627`*^9}, {
  3.929095059585193*^9, 
  3.9290950615605793`*^9}},ExpressionUUID->"bb0f9ace-c590-4e13-a749-\
ed52fa08fb6b"],

Cell[TextData[{
 "If the originally vacuum input mode 2 is ",
 StyleBox["squeezed",
  FontSlant->"Italic"],
 ", the operators ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "2"], ",", 
         SubscriptBox[
          StyleBox["a", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "A_2, a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "86717686-348d-46b0-9b71-e5061206a5c7"],
 " are modified by the following matrix:"
}], "Text",
 CellChangeTimes->{{3.929098680648873*^9, 
  3.929098745975438*^9}},ExpressionUUID->"d8b6e969-b2dd-46da-af83-\
c46c4f6d0a14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       RowBox[{"Cosh", "[", "r", "]"}], "0", 
       RowBox[{"-", 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {"0", "0", "1", "0"},
      {"0", 
       RowBox[{"-", 
        RowBox[{"Sinh", "[", "r", "]"}]}], "0", 
       RowBox[{"Cosh", "[", "r", "]"}]}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"45308b44-34a9-43e3-9b65-d4add5083661"],

Cell[TextData[{
 "The first mode is, as before, assumed to be coherent ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
         "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
          "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
      "\\lvert\\!\\!\\gamma\\rangle", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], "."}], TraditionalForm]],ExpressionUUID->
  "ac5a280b-8f11-43a5-926b-845788e001ac"],
 " We can calculate the expectation values using the same procedure:"
}], "Text",
 CellChangeTimes->{{3.929098749760459*^9, 
  3.929098806535581*^9}},ExpressionUUID->"dd45bd92-90f3-4531-a081-\
17570ad8ca7d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"S", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", 
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["A", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", 
      SubscriptBox["\[Beta]", "1"], ",", 
      SubscriptBox["\[Beta]", "2"]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"id", " ", "\[Gamma]"}], ",", "0", ",", 
      RowBox[{"id", " ", 
       RowBox[{"\[Gamma]", "\[Conjugate]"}]}], ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        SubscriptBox["b", "2"], ",", 
        SubscriptBox["\[Beta]", "1"], ",", 
        SubscriptBox["\[Beta]", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exprS", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "2"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "1"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr2S", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"Distribute", "[", 
       RowBox[{"exprS", ".", "exprS"}], "]"}], "//.", 
      RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmomSQ", "=", 
   RowBox[{
    RowBox[{"exprS", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secmomSQ", "=", 
   RowBox[{
    RowBox[{"expr2S", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varSQ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"secmomSQ", "-", 
       SuperscriptBox["firstmomSQ", "2"]}], "//", "Expand"}], "//", 
     "FullSimplify"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: \>\"", ",", 
   "firstmomSQ"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<variance of \!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\): \>\"", ",", "varSQ"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.877500623652169*^9, 3.877500733117751*^9}, {
   3.8775021644995537`*^9, 3.877502165675181*^9}, {3.877502813670136*^9, 
   3.877502815476026*^9}, {3.877503022159945*^9, 3.877503056071042*^9}, {
   3.877503095737109*^9, 3.877503097031745*^9}, {3.877533658243441*^9, 
   3.877533659499853*^9}, {3.928228988334676*^9, 3.92822899096591*^9}, {
   3.928232887702626*^9, 3.928232888001494*^9}, {3.928233055833056*^9, 
   3.928233071115608*^9}, 3.928233189180749*^9, {3.928233355594795*^9, 
   3.9282333567932043`*^9}, {3.928233512590671*^9, 3.928233516546321*^9}, {
   3.92823368953423*^9, 3.9282337433816*^9}, {3.928234906133181*^9, 
   3.928234954096624*^9}, {3.928236816609837*^9, 3.928236818862172*^9}, {
   3.928237078919482*^9, 3.928237080505129*^9}, {3.928238800735076*^9, 
   3.92823880157329*^9}, 3.9288295139734783`*^9, {3.929094369536067*^9, 
   3.929094414673563*^9}, {3.929094485551856*^9, 3.929094490366754*^9}, {
   3.929094903482718*^9, 3.9290949046636767`*^9}, 3.929096250878549*^9, {
   3.92909881480707*^9, 3.929098860512885*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"f1549c00-d3c4-4eb4-852b-3b3c996f8b5d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \\(2\\)]\\)-\
\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Gamma]"}], " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}]}],
  SequenceForm[
  "\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: ", \
-$CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
    Cos[Rational[1, 2] $CellContext`\[Phi]]^2 + $CellContext`\[Gamma] 
    Conjugate[$CellContext`\[Gamma]] 
    Sin[Rational[1, 2] $CellContext`\[Phi]]^2 + 
   Cos[Rational[1, 2] $CellContext`\[Phi]]^2 Sinh[$CellContext`r]^2 - 
   Sin[Rational[1, 2] $CellContext`\[Phi]]^2 Sinh[$CellContext`r]^2],
  Editable->False]], "Print",
 CellChangeTimes->{3.92909886355081*^9, 3.929434085624631*^9, 
  3.929515889679658*^9, 3.92951986329683*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"a3bc8f44-13a5-4728-a426-4f0c379480a8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"variance of \\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[Gamma]", "2"], " ", 
     RowBox[{"Cosh", "[", "r", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
     RowBox[{"Sinh", "[", "r", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], " ", 
     RowBox[{"Cosh", "[", "r", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
     RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "4"], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
     RowBox[{"Sinh", "[", "r", "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"3", " ", "r"}], "]"}]}]}]}],
  SequenceForm[
  "variance of \!\(\*SubscriptBox[\(N\), \(2\)]\)-\!\(\*SubscriptBox[\(N\), \
\(1\)]\): ", 
   Rational[1, 2] $CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] + 
   Rational[1, 2] $CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
    Cosh[2 $CellContext`r] - $CellContext`\[Gamma]^2 Cosh[$CellContext`r] 
   Sin[$CellContext`\[Phi]]^2 Sinh[$CellContext`r] - 
   Conjugate[$CellContext`\[Gamma]]^2 Cosh[$CellContext`r] 
   Sin[$CellContext`\[Phi]]^2 Sinh[$CellContext`r] + 
   Rational[3, 4] Sinh[$CellContext`r]^2 + 
   Rational[-1, 4] Cos[2 $CellContext`\[Phi]] 
    Sinh[$CellContext`r]^2 - $CellContext`\[Gamma] 
   Conjugate[$CellContext`\[Gamma]] Cos[2 $CellContext`\[Phi]] 
   Sinh[$CellContext`r]^2 + 
   Rational[1, 2] Cos[$CellContext`\[Phi]]^2 Sinh[$CellContext`r] 
    Sinh[3 $CellContext`r]],
  Editable->False]], "Print",
 CellChangeTimes->{3.92909886355081*^9, 3.929434085624631*^9, 
  3.929515889679658*^9, 3.929519863298015*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"019644c5-a39b-485c-b381-f3fa5db2b139"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "Quite  complicated, but they are closed form expressions. As we can observe \
in the following plots of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
           SubscriptBox[
            StyleBox["N", "TI"], "2"], "-", 
           SubscriptBox[
            StyleBox["N", "TI"], "1"]}], "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle N_2-N_1\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5429f7ca-3484-4747-b9e0-7f75f0356129"],
 ", maximum sensitivity (measured by the derivative with respect to \
interferometric phase change ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46ba1632-b375-435f-9d9e-24b23404f50a"],
 ") appears around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", 
         FractionBox["\[Pi]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi=\\frac\\pi2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f974eba5-d7aa-4433-94bb-31493cedcf26"],
 "."
}], "Text",
 CellChangeTimes->{{3.929098871513104*^9, 
  3.929098996203375*^9}},ExpressionUUID->"b5de8e3a-0a6f-40b4-a9bd-\
9448c1aade7f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.928237696353594*^9, 3.928237723082648*^9}, {
  3.9290944357985363`*^9, 3.9290944704940853`*^9}, {3.929094508880398*^9, 
  3.929094514862227*^9}, {3.929094920633169*^9, 3.929094924751137*^9}, {
  3.929095230955749*^9, 3.929095232290694*^9}, {3.929095303075623*^9, 
  3.92909530619658*^9}, {3.9290988387869663`*^9, 
  3.929098851008794*^9}},ExpressionUUID->"695ad47f-4b6c-4840-be2c-\
510ccd93fac5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "10"}], ",", 
     RowBox[{"r", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstmomCOH", ",", "firstmomSQ"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"PlotLabels", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] squeezed vacuum |r=\>\"", "<>", 
         RowBox[{"ToString", "@", "r"}], "<>", "\"\<>\>\""}]}], "}"}]}], ",", 
     
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Phi]\>\"", ",", 
        "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]\>\""}], 
       "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.928234045117673*^9, 3.928234097291581*^9}, {
   3.928234142208759*^9, 3.928234142357723*^9}, {3.928234238368437*^9, 
   3.928234244167485*^9}, {3.928237111976069*^9, 3.9282371202094603`*^9}, {
   3.928829597420463*^9, 3.928829600674144*^9}, 3.928847859554748*^9, {
   3.928848031469861*^9, 3.928848040196064*^9}, {3.929098890417326*^9, 
   3.929098892128387*^9}, {3.929098999168831*^9, 3.929099278267648*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"e66bfa79-8520-4ec8-bf6f-b0a3ba4c9df3"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
L4EKB6SrVObT9ykYmBXYjs/nwP/fr/A/5Q/smA==
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 99.99999999999979}], 
           Offset[{2.977349764953069, 0.36795159618339157`}, {
            3.2698743536113763`, 99.99999999999979}], 
           Offset[{0, 0}, {3.337193296013457, 100.85697052019943`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            100.85697052019943`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 99.99999999999979}], 
           Offset[{2.977349764953069, 0.36795159618339157`}, {
            3.2698743536113763`, 99.99999999999979}], 
           Offset[{0, 0}, {3.337193296013457, 100.85697052019943`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            100.85697052019943`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{144., 8.000000000000032}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{144., -7.999999999999968}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., -7.999999999999997}, {3.337193296013457, 
            100.85697052019943`}], 
           Offset[{10., 8.000000000000002}, {3.337193296013457, 
            100.85697052019943`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{77., 1.709743457922741*^-14}, \
{3.337193296013457, 100.85697052019943}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 86.84588358199157}], 
           Offset[{2.9773497432001474`, -0.36795177220121733`}, {
            3.2698743536113763`, 86.84588358199157}], 
           Offset[{0, 0}, {3.337193296013457, 85.98891264557989}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            85.98891264557989}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 86.84588358199157}], 
           Offset[{2.9773497432001474`, -0.36795177220121733`}, {
            3.2698743536113763`, 86.84588358199157}], 
           Offset[{0, 0}, {3.337193296013457, 85.98891264557989}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., 2.220446049250313*^-15}, {3.337193296013457, 
            85.98891264557989}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{227., 8.000000000000052}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{227., -7.999999999999949}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., -7.999999999999998}, {3.337193296013457, 
            85.98891264557989}], 
           Offset[{10., 8.000000000000002}, {3.337193296013457, 
            85.98891264557989}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] squeezed vacuum |r=2>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{118.5, 2.631228568361621*^-14}, \
{3.337193296013457, 85.98891264557989}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\[Phi]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox[
     "\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]\"",
       HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 254.86269209895522`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, Pi}, {-99.99999999999979, 99.99999999999979}}, {{
     0, 3.141592653589793}, {-99.99999999999979, 99.99999999999979}}],
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.928234050916918*^9, 3.92823409759352*^9}, 
   3.928234142543556*^9, {3.928234238650971*^9, 3.92823424539441*^9}, {
   3.928237112847659*^9, 3.928237120587472*^9}, 3.928238818049718*^9, 
   3.928396016007423*^9, 3.92839606193083*^9, 3.928829536466553*^9, {
   3.928829597623012*^9, 3.928829600923201*^9}, 3.928843867461921*^9, 
   3.928845199819831*^9, 3.928846953243968*^9, 3.92884785989251*^9, 
   3.928848040728587*^9, 3.929094521766678*^9, 3.929094927665521*^9, 
   3.929095020992186*^9, 3.929095067934265*^9, 3.929095310650785*^9, 
   3.929095694571839*^9, {3.929099011496425*^9, 3.929099131348783*^9}, {
   3.929099166777546*^9, 3.929099224272694*^9}, {3.929099266841694*^9, 
   3.929099278766501*^9}, 3.929434097239084*^9, 3.929515894006731*^9, 
   3.929519863636734*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"ee909cb4-6f49-4453-8bc1-5c1375cdc856"]
}, Open  ]],

Cell[TextData[{
 "Error of phase determination around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", 
         FractionBox["\[Pi]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi=\\frac\\pi2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c2fc3e91-12bb-4f6f-8add-9101af4ac48b"],
 " is calculated using the standard error propagation formula: it is \
proportional to the square root of variance, and inverse proportional to the \
derivative of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
           SubscriptBox[
            StyleBox["N", "TI"], "2"], "-", 
           SubscriptBox[
            StyleBox["N", "TI"], "1"]}], "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle N_2-N_1\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a3057f72-bd16-484e-8ad6-3ea8c217e581"],
 " with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f95b4ed8-1ff0-4cd7-a62e-d66cadc4a5dd"],
 ". Squeezing improves the phase determination uncertainty significantly:"
}], "Text",
 CellChangeTimes->{{3.929099291652415*^9, 3.929099374194726*^9}, {
  3.929099472450871*^9, 
  3.929099521403895*^9}},ExpressionUUID->"c0c1408e-944f-435c-a93f-\
7a3f64888b94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "10"}], ",", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"errCOH", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varCOH"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomCOH", ",", "\[Phi]"}], "]"}]], "/.", 
      RowBox[{"\[Phi]", "->", "\[Theta]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"errSQ", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varSQ"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomSQ", ",", "\[Phi]"}], "]"}]], "/.", 
      RowBox[{"\[Phi]", "->", "\[Theta]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"improvement", "=", 
     RowBox[{"errSQ", "/", "errCOH"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"errCOH", ",", "errSQ"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<squeezing parameter r\>\"", ",", 
         "\"\<phase estimation inaccuracy\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabels", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] squeezed vacuum \
|r>\>\""}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.928234168558448*^9, 3.928234213597878*^9}, {
  3.928234834012498*^9, 3.928234837978031*^9}, {3.928237147265188*^9, 
  3.92823714780927*^9}, {3.928239148511973*^9, 3.9282392090238943`*^9}, {
  3.928239242720806*^9, 3.928239242863816*^9}, {3.928396232545305*^9, 
  3.928396322441305*^9}, {3.92909931130685*^9, 3.929099311387757*^9}, {
  3.929099381568681*^9, 3.929099492977828*^9}, {3.929099529293942*^9, 
  3.92909970500648*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"182858f8-3e46-436e-86a2-509929521696"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwA2IQnbx+wvv//9kPzJoJAjvt72vnBsT8QfDrVG8dSGtH
8GfNVp50lg/Bn3+/Iz+Qkw3OF7sQ7K8pygrnnwgIdjmtygLne2iqligrMcP5
Vutilp3XZ4Lzf3WlCRtpMsL5X78vmRqnzgDnH1GaZLIv999+GN+atX6zdsof
OH+Kg7m5Y+0vOD95TsTTV/N/wPnnl8txMs76BufL8Www3L/tC5zPpfDs/MtV
n+D8nJDWGStWfIDzEw7fPy036S2cr2T7L/Bo40s4f2XG5oe7tz2F87M+b4zp
nvUQzterY41kU74N5wtXXuGeNvsynH89JUdr/eNjcH55lVbfyanr4PxV/RYO
SwzW2sP4fZmN1xKajsP5vF98rNcEXobzH5QcMylruQ3nv9vpe6j8xEM4f1n7
woSUzqdwvuq31cIVs1/C+fc2ye+1zngL54dOf9DxesIHOH/e0p69PtM+wfks
0blvWSu/wPnnElYuD2r5Budv5ZWK/Z7zA85Xm6X4gt3nF5z/q6zl7+rgP3D+
61/SfCss/sH5C9Lbr0grMzjA+BMcz/RIqjLC+Xz5q50OizLB+ftcduzdJsUM
5//NjTcL42OB8xnZL83U/ovgm3kUHfJiYIPzf91Z80L0E4Kvd0zuDVclO5x/
D5Jf4HxofoLzAXImzqk=
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
AI6LfYg=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ], {}}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.9999998775510206`, 0.1}], 
           Offset[{2.999946174378683, 0.01797083277714874}, {
            3.2449998675510203`, 0.1}], 
           Offset[{0, 0}, {3.3657096058998603`, 0.10019499948147943`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.9999998775510206`, 0.1}], 
           Offset[{2.999946174378683, 0.01797083277714874}, {
            3.2449998675510203`, 0.1}], 
           Offset[{0, 0}, {3.3657096058998603`, 0.10019499948147943`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.10019499948147943`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{144., 8.000000000000032}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{144., -7.999999999999968}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., -7.999999999999997}, {3.3657096058998603`, 
            0.10019499948147943`}], 
           Offset[{10., 8.000000000000002}, {3.3657096058998603`, 
            0.10019499948147943`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{77., 1.709743457922741*^-14}, \
{3.3657096058998603, 0.10019499948147943}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.9999998775510206`, 1.}], 
           Offset[{2.999821746650141, -0.0327030323501927}, {
            3.2449998675510203`, 1.}], 
           Offset[{0, 0}, {3.3657096058998603`, 0.9996451283621159}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.9996451283621159}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.9999998775510206`, 1.}], 
           Offset[{2.999821746650141, -0.0327030323501927}, {
            3.2449998675510203`, 1.}], 
           Offset[{0, 0}, {3.3657096058998603`, 0.9996451283621159}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3657096058998603`, 
            0.9996451283621159}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{213., 8.000000000000048}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{213., -7.999999999999953}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., -7.999999999999998}, {3.3657096058998603`, 
            0.9996451283621159}], 
           Offset[{10., 8.000000000000002}, {3.3657096058998603`, 
            0.9996451283621159}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] squeezed vacuum |r>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{111.5, 2.475797344914099*^-14}, \
{3.3657096058998603, 0.9996451283621159}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"squeezing parameter r\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation inaccuracy\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 240.10813535447375`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., 1.}},
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.929094549574757*^9, 3.929094587823131*^9, 3.929094930919038*^9, 
   3.92909502541684*^9, 3.929095070514318*^9, 3.929095313239493*^9, 
   3.929095698344741*^9, 3.929099311565793*^9, 3.929099408205792*^9, {
   3.929099440579236*^9, 3.929099493361874*^9}, {3.929099583149643*^9, 
   3.929099663075268*^9}, 3.929099706735907*^9, 3.929434098853071*^9, 
   3.929515896532328*^9, 3.9295198637969027`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"f0baecfd-c851-4218-b287-d3701dbd3825"]
}, Open  ]],

Cell[TextData[StyleBox["Zero+One approximation to squeezed light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928845210265777*^9, 
  3.92884522417776*^9}},ExpressionUUID->"85797ec8-37bd-41dc-907d-\
70e23204ed2d"],

Cell[TextData[{
 "In  the article, we show that a finite photon number approximation to the \
squeezed vacuum represented as a superposition of two Fock states (",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\psi\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9b31153-10a3-40cf-9aa3-261d3e0e3df5"],
 ") also improves accuracy to some degree, and can be probabilistically \
prepared by a ",
 StyleBox["device commuting with the interferometer given input ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "vacuum", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\text{vacuum}\\\
rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e3ef7bd8-6060-4db7-8bc3-a23cf99c1af6"],
 StyleBox[" ",
  FontSlant->"Italic"],
 ". This means that the device can be placed before the interferometer (and \
used to prepare the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5e4b2cd8-c2f0-420a-ab50-b4d77cee3edc"],
 "), or transform the output state of the interferometer (product of coherent \
states) ",
 StyleBox["into a result of feeding the interferometer with ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "77c846d8-ddbd-456f-be0d-bc1db72ba388"],
 ". In short: postprocessing is equivalent to preparation, given certain \
mathematical criteria. In this section we show that the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d51589a2-5991-43c1-9f86-7f21a3fdc674"],
 " offers a reduction in phase estimation inaccuracy  (compared to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "vacuum", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\text{vacuum}\\\
rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a64251b5-d24e-40fa-9e99-828ae2f186cb"],
 StyleBox[" ",
  FontSlant->"Italic"],
 ")  of factor ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"3", "-", 
          SqrtBox["6"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\sqrt{3-\\sqrt6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d9cb347-c34e-4502-8ee4-a3b98be5a8f2"],
 " (asymptotically). First, the calculations are done as previously:"
}], "Text",
 CellChangeTimes->{{3.929100065861938*^9, 3.929100371534491*^9}, {
  3.929100424147745*^9, 3.929100437733879*^9}, {3.929100468220813*^9, 
  3.929100736228984*^9}, {3.929434163447237*^9, 
  3.929434168159276*^9}},ExpressionUUID->"9ca9269b-87b5-4409-a84b-\
b69961ff3699"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", 
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["A", "2"]}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", ">", "0"}], ",", 
         RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", 
      SubscriptBox["\[Beta]", "1"], ",", 
      SubscriptBox["\[Beta]", "2"]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Gamma]", " ", "id"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"\[Gamma]", "\[Conjugate]"}], "id"}], ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["b", "1"], ",", 
         SubscriptBox["b", "2"], ",", 
         SubscriptBox["\[Beta]", "1"], ",", 
         SubscriptBox["\[Beta]", "2"]}], "}"}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Phi]", ">", "0"}], ",", 
         RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr01", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "2"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "1"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr201", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", 
      RowBox[{"expr01", ".", "expr01"}], "]"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928845308722274*^9, 3.928845336220846*^9}, {
   3.928845406971631*^9, 3.928845431329391*^9}, {3.928845463700645*^9, 
   3.928845590498641*^9}, {3.92884562392206*^9, 3.928845950324718*^9}, {
   3.928846228075332*^9, 3.928846231297236*^9}, {3.928846273044492*^9, 
   3.928846290665881*^9}, {3.928846335140945*^9, 3.928846335354129*^9}, {
   3.928846718766649*^9, 3.9288467190050983`*^9}, {3.928846967010287*^9, 
   3.928847070623625*^9}, {3.928847238929918*^9, 3.928847239701251*^9}, {
   3.928847595264288*^9, 3.928847614141056*^9}, {3.92884765375803*^9, 
   3.928847696797955*^9}, {3.929094935730975*^9, 3.9290949943611603`*^9}, 
   3.929095031035021*^9, {3.929100739602658*^9, 3.929100740079557*^9}, {
   3.9291007752419*^9, 3.929100778386445*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"9f936469-8256-4b4d-bcc0-73799fc82387"],

Cell[TextData[{
 "Remember that ",
 StyleBox["expr01",
  FontWeight->"Bold"],
 " is a polynomial in the annihilation and creation operators of the input \
modes (and ",
 StyleBox["expr201",
  FontWeight->"Bold"],
 " is its square):"
}], "Text",
 CellChangeTimes->{{3.929100744958555*^9, 
  3.9291008129116364`*^9}},ExpressionUUID->"4850de06-7b2c-4f4f-8f20-\
ce44629c60d6"],

Cell[CellGroupData[{

Cell[BoxData["expr01"], "Input",
 CellChangeTimes->{{3.929100814209503*^9, 3.9291008151436243`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"609dcc98-0a9d-4156-950d-eb2ba7f9a006"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Gamma]"}], " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"id", ".", "id"}]}], "-", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", "id"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.929100815366357*^9, 3.9294341082081413`*^9, 
  3.929515900015833*^9, 3.929519867114087*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"eae00e4a-6f7d-426c-b22a-9178104ae1f1"]
}, Open  ]],

Cell[TextData[{
 "We now have to assume that the input mode 1 is in vacuum (which is then \
displaced by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["D", "TI"], "(", "\[Gamma]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D(\\gamma)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "16f98787-6b32-4c37-822a-cf14beeacbb9"],
 " and fed into the interferometer), and the monomials ending with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "79e5c612-f99d-459a-ab1e-8c5f25cce3df"],
 " (or beginning with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["a", "TI"], "1", "\[Dagger]"], TraditionalForm], 
     "errors" -> {}, "input" -> "a^\\dagger_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e570dfe1-834f-41a6-87f8-8f5e761ad6ca"],
 " ) do not contribute to the expectation values, while we replace the \
operators ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bbbe1e64-d9d2-4d81-baf0-1228d8cccce6"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["a", "TI"], "2", "\[Dagger]"], TraditionalForm], 
     "errors" -> {}, "input" -> "a_2^\\dagger", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f5a90216-c239-41a0-802e-54e9fe61a915"],
 " with finite-dimensional matrices (which leads to strict result, since the \
state has finite maximal photon number), and calculate the expectation values \
of with the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\psi\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3df9243c-1285-4bbb-b9ce-7e9ecb074676"],
 ".\nFirst, let\[CloseCurlyQuote]s define the state and the matrices:"
}], "Text",
 CellChangeTimes->{{3.929100818673018*^9, 
  3.9291010895288477`*^9}},ExpressionUUID->"b47f42d5-246b-4ad2-8c25-\
bea0a0c2437f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxdim", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ANN", "[", "dim_", "]"}], ":=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       SqrtBox["k"], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec01", "=", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}]}], "}"}], ",", "maxdim"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covec01", "=", 
   RowBox[{
    RowBox[{"vec01", "\[ConjugateTranspose]"}], "//", "ComplexExpand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<truncated dimension = \>\"", ",", "maxdim"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<2-photon approximation = \>\"", ",", 
    RowBox[{"vec01", "//", "MatrixForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Truncated annihilation operator = \>\"", ",", 
    RowBox[{
     RowBox[{"ANN", "[", "maxdim", "]"}], "//", "MatrixForm"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.929101075306791*^9, 3.929101196887734*^9}, 
   3.929101424333439*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"26c656fe-df68-4f3d-a245-f1fc929c23b4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"truncated dimension = \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["truncated dimension = ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.9295198683333597`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"5b6c5c09-2969-4924-a4ef-35c510733dbc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"2-photon approximation = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"Cos", "[", "\[Tau]", "]"}]},
        {"0"},
        {
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Tau]", "]"}]}]},
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["2-photon approximation = ", 
   MatrixForm[{
     Cos[$CellContext`\[Tau]], 0, -Sin[$CellContext`\[Tau]], 0, 0, 0, 0, 0}]],
  
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.9295198683530703`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4bb22d0b-7cc2-4cd1-82e6-ae7f0e93215b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Truncated annihilation operator = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", 
        SqrtBox["2"], "0", "0", "0", "0", "0"},
       {"0", "0", "0", 
        SqrtBox["3"], "0", "0", "0", "0"},
       {"0", "0", "0", "0", "2", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SqrtBox["5"], "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        SqrtBox["6"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        SqrtBox["7"]},
       {"0", "0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Truncated annihilation operator = ", 
   MatrixForm[{{0, 1, 0, 0, 0, 0, 0, 0}, {
     0, 0, 2^Rational[1, 2], 0, 0, 0, 0, 0}, {
     0, 0, 0, 3^Rational[1, 2], 0, 0, 0, 0}, {0, 0, 0, 0, 2, 0, 0, 0}, {
     0, 0, 0, 0, 0, 5^Rational[1, 2], 0, 0}, {
     0, 0, 0, 0, 0, 0, 6^Rational[1, 2], 0}, {
     0, 0, 0, 0, 0, 0, 0, 7^Rational[1, 2]}, {0, 0, 0, 0, 0, 0, 0, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.929519868354343*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7e2b3d41-8e79-4d9f-94e8-6e0db749cba9"]
}, Open  ]]
}, Open  ]],

Cell["The expectation values are calculated in the following step.", "Text",
 CellChangeTimes->{{3.929101202896002*^9, 
  3.9291012241842613`*^9}},ExpressionUUID->"28a49835-5a16-4645-b881-\
67a2d25990fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"finalizetomatrices", "[", 
    RowBox[{"idx_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "idx"], "->", 
      RowBox[{"ANN", "[", "dim", "]"}]}], ",", 
     RowBox[{
      SubscriptBox["A", "idx"], "->", 
      RowBox[{
       RowBox[{"ANN", "[", "dim", "]"}], "\[ConjugateTranspose]"}]}], ",", 
     RowBox[{"id", "->", 
      RowBox[{"IdentityMatrix", "[", "dim", "]"}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmom01OP", "=", 
   RowBox[{
    RowBox[{"expr01", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", "1", "}"}], "]"}]}], "/.", 
    RowBox[{"finalizetomatrices", "[", 
     RowBox[{"2", ",", "maxdim"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"secmom01OP", "=", 
    RowBox[{
     RowBox[{"expr201", "//.", 
      RowBox[{"expvacuumrules", "[", 
       RowBox[{"{", "1", "}"}], "]"}]}], "/.", 
     RowBox[{"finalizetomatrices", "[", 
      RowBox[{"2", ",", "maxdim"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmom01", "=", 
   RowBox[{"covec01", ".", "firstmom01OP", ".", "vec01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secmom01", "=", 
   RowBox[{"covec01", ".", "secmom01OP", ".", "vec01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"var01", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"secmom01", "-", 
      SuperscriptBox["firstmom01", "2"]}], "//", "Expand"}], "//", 
    "FullSimplify"}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.9290950889557*^9, 3.929095119017602*^9}, {
   3.929095362348563*^9, 3.929095552693774*^9}, {3.9290957256444902`*^9, 
   3.92909575245385*^9}, 3.929101095812745*^9, {3.929101201058881*^9, 
   3.9291012273286457`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"eea2a739-1737-455e-8e17-b0f9f6d3867e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", "\[Tau]"}], "]"}]}], "-", 
  RowBox[{
   SqrtBox["2"], " ", 
   SuperscriptBox["\[Gamma]", "2"], " ", 
   RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "-", 
  RowBox[{
   SqrtBox["2"], " ", 
   SuperscriptBox[
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], " ", 
   RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.92884767123901*^9, 3.928847758191268*^9}, 
   3.928911253989176*^9, 3.928911295284363*^9, {3.929095723205349*^9, 
   3.929095756115891*^9}, 3.929101231076439*^9, 3.929101429863179*^9, 
   3.929102161128192*^9, 3.929102907095174*^9, 3.929434117516408*^9, 
   3.929434221458383*^9, 3.929515905552671*^9, 3.929519872474265*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"f494c898-63c6-4c45-977a-12eee3775985"]
}, Open  ]],

Cell[TextData[{
 "As before, the maximal accuracy of phase determination is attained around \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", "\[LongEqual]", 
         FractionBox["\[Pi]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi=\\frac\\pi2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6fc35830-a201-4da1-91c1-164b59d1aba9"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929101318745997*^9, 
  3.929101352392041*^9}},ExpressionUUID->"2877c0e7-23c8-42e5-8f11-\
55f88b7bdcc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "5"}], ",", 
     RowBox[{"\[Tau]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstmomCOH", ",", "firstmom01"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"PlotLabels", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] |\[Psi] \
(\[Tau]=\[Pi]/2)>\>\""}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Phi]\>\"", ",", 
        "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]\>\""}], 
       "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.929101290562842*^9, 3.9291013168669686`*^9}, {
  3.929101361277061*^9, 3.9291013938961983`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"208af341-3a27-414f-870d-b7f49091e66d"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJwt1wkwV93/B3Bb3+/9poTQT5SUSpYQ+h6h80lSWqyhRKSUVIqkkuVJsoSy
9lCyVJby2LIv1X0sPUSSvmQtJFv2Iln/p5n/mblz5jVz5t5zPvM+d+YjbXfR
xJ6Hi4trmDx/Zt7XS+u+qjvvHF/8MxC9ceCV5toIQ3x/dq/2H89kKZ1qCbfB
3jsVJ+eIs6dwo1DGGaw6lLn5N/E3EYfp/PCLeATXc34QB4tXLc8ouYxjg+/O
DREny1rFc2VcxS1a3+N6iGn2mLJpwg081tBb0krcqudblhTujbv6b5q+//M9
uWVyHmU3saXyS/syYv9tTS5JJbdwkUvMRA6xyI6Ekrrc21ggbNXME+LEXY58
0+n+WMIXeYQTb9VXOySdEogNreaveROXGC1E7U8IwjW7zow5EjfahG9+FH4P
Rx5QMtT+cx7VrehrZSiO2h66XYb4Kjui/WpZGNYrfRjNIubD1hsTSyJw7pai
2vcLiH6rU1atXhiJk6Lq4rKIw/Q2O73NjcIZT6O+3yNeazCe/yP9b8xdBJP6
xD3G5scCnkfj2UXZFzLEaWYli5IpMdj5Qs3A/DyikfXtfXoJD3H+7n3VacQm
58Vbo8Pj8b7ys/qTc4hehvDr+3sT8LCnY3s58ViRs1BXZQKObdoxGEqc/7Ip
70pZIq75Yu62iXh3ZcJCXMkTrD/abIRnEb1p70ejAY2n2Dz8RTE38dLqJU9U
C5/ic9uvxpfNILq+1nFvVW4Snv9Z34KJrTlqoePpKfhqAltY9jeiwfxMt6ZC
Kq6caTH9PI1omeYYNb/nqXjd0wDBCOLBtoXm1SnPcNrBNbO/fpH6fa2S1k1I
w70Lz6Iyp0h9Jqxy7odn4oef6noafyA6RPSBFr08C9c/Swg4R9yQfVtK3SQL
b1PIObk4gehjg1bf1rZl4UajotfSxE7H+J0nhrJx9zM5QeMxREdqOwTECOZi
t51Cqy2HEN3SYnpOwCwXS15vVP/4ndTfDRvcisnF187bB+4nTskQE7mwPg+n
5a1oVh1EdLFUZTyo5eMWrxSR8T5Ef+FeX9BnUYj9jSVFxL6S88Utf2AVW4hz
1K5lu3Qj2mHHb48PnYV447UD/u+6ED3hUq9TcrYIn/Lyb/fsJPno8aq7e6MY
x2inbq3uQLTcm7Zv6vGlWGRJiMfSZkRrVu5fqnOZxhHZEWtQDaIFOcnv2RE0
3rjiSKDjW5KPbp4oxRwa31O9fPZhNaLvcpVIif+gsUtol9/0f4ju1pRXH3P5
F1trCaCECkQHvOC3jXMpw2sMrngnvUR0U3xt3oxzBV4xMbUkIIPkK0P2xlhY
BVY547YqMB3Rf730hd7sCsyKEI8P+AfRW9q0aj6MV2A/SX6hW88R7SGW3pnq
XImF82xv2icjekNICL+F8xsseOnw485HiL7kbnAi51IV9jtx5HhWEKL3O2ml
UqFVeIQ3y9DvDllvJzdqnVmFp8zCqiwDyX70GZ7USBUOG0TGi36I1hZ/FW19
rhobjq2it/uQ/BUq1jNPv8UXVUHG5hqikyaXYatjtTjGSzH4/klEew3M3M52
r8XnmtQjtO0QfaSjv5bxoBZ3flSR+WpL7kNlhWV2cy22+mLRs+U4ol0iPdwY
5u/w57nkL0lHSF5Vh9KzjOrwvsExjsUhRF8otL/Ls6EeSwq8MX2q/uf/YLyO
W60e5+6ZvjmrSu5Ti9aLRd16/ENcf9ZoG6JdZ1c2zZ2ux868r99PbUW0+86y
Nb+e1+OpW4d4t8oi2q9ibfr3bR9wmFtf5v7ViE6o/1TD0WnAIpuH57Tn2TSn
X5+VYsfBXm5RRStfsenRGNk9t1w4WH9PkuH6Uja99ADzpo0PBzMsQi4pFbNp
SK+YXvWYg1t6bU335LPpNGfcH9DFwetVryTYZLBpnxm1/xxtG/HzszGXDeLY
tNKydbe3Hm/Ce43y20U92fQdpSmu/KPN+FMI/5zJdjbtLF8VRSe14x1LVKvc
A7fTMyfPZXQ4deLy153+nm/UabuX5kahp7tx65x8e9mMGn1ynEPTAT349tIn
jSMMNTpYueBisl8vVrC64lsooErz0AVsX/d+fNBMR42ftY0WkjtQ9yV6EGc1
6PkXtCjT++J1noyFD+F7Jb79GseU6FWjtXreBSM4SaSpVyJDgX7wXzE379kx
HMTbusxzeAuttWbX4rpT4zhVuE/yss5mWr5TsMfTdQJznJ9VndWVodNThR3y
XH7gsTC8POWUNO3x2fqjvN9PbCvtCnoOkrSzFjoQFzmJa9I+m0zwidEz8bp2
30OnMCNIWFZ8YgVdf+mB7dXHv7D9123zYy94aI296xc6EqdxF3f15Uy+gdfV
ezRSIfY3xsUnphM7+3BSdoxGd9oMHvkQuENZjRdENyg4Hn82i4v4bVdnua+A
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
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
okLmU1ix+t+tk4tZMPT/+RX+B4dfAAA=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 24.999999999999947`}], 
           Offset[{2.7732838702759928`, 1.1440701791704087`}, {
            3.2698743536113763`, 24.999999999999947`}], 
           Offset[{0, 0}, {3.3506868053156045`, 25.85850809478397}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            25.85850809478397}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 24.999999999999947`}], 
           Offset[{2.7732838702759928`, 1.1440701791704087`}, {
            3.2698743536113763`, 24.999999999999947`}], 
           Offset[{0, 0}, {3.3506868053156045`, 25.85850809478397}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            25.85850809478397}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{138., 8.00000000000003}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{138., -7.99999999999997}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., -7.999999999999998}, {3.3506868053156045`, 
            25.85850809478397}], 
           Offset[{10., 8.000000000000002}, {3.3506868053156045`, 
            25.85850809478397}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=5\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{74., 1.6431300764452317*^-14}, \
{3.3506868053156045, 25.85850809478397}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 22.99999999999995}], 
           Offset[{2.7732828128279836`, -1.1440727424744055`}, {
            3.2698743536113763`, 22.99999999999995}], 
           Offset[{0, 0}, {3.3506868053156045`, 22.141489654369057`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            22.141489654369057`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, 22.99999999999995}], 
           Offset[{2.7732828128279836`, -1.1440727424744055`}, {
            3.2698743536113763`, 22.99999999999995}], 
           Offset[{0, 0}, {3.3506868053156045`, 22.141489654369057`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3506868053156045`, 
            22.141489654369057`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{157., 8.000000000000034}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{157., -7.999999999999965}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., -7.999999999999997}, {3.3506868053156045`, 
            22.141489654369057`}], 
           Offset[{10., 8.000000000000002}, {3.3506868053156045`, 
            22.141489654369057`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=5\[RightAngleBracket]\
\[CircleTimes] |\[Psi] (\[Tau]=\[Pi]/2)>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{83.5, 1.8540724511240114*^-14}, \
{3.3506868053156045, 22.141489654369057}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\[Phi]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox[
     "\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]\"",
       HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 187.33667972722264`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, Pi}, {-24.999999999999947`, 24.999999999999947`}}, {{
     0, 3.141592653589793}, {-24.999999999999947`, 24.999999999999947`}}],
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.929101302783597*^9, 3.929101317082081*^9}, {
   3.929101353570821*^9, 3.929101394306154*^9}, 3.929101431594524*^9, 
   3.929102162452602*^9, 3.929434120533881*^9, 3.929434225958493*^9, 
   3.929515905655013*^9, 3.929519872567637*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"f8b038f8-0caf-47a7-81ee-4a88c6eec59c"]
}, Open  ]],

Cell["\<\
And there is a modest improvement in phase determination inaccuracy around \
this point:\
\>", "Text",
 CellChangeTimes->{{3.92910144583396*^9, 3.9291014799060097`*^9}, {
  3.929101625794734*^9, 
  3.929101644290411*^9}},ExpressionUUID->"9171b97e-9ab2-4a74-b702-\
729924f50017"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "100"}], ",", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"errCOH", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varCOH"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomCOH", ",", "\[Phi]"}], "]"}]], "/.", 
      RowBox[{"\[Phi]", "->", "\[Theta]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"err01", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["var01"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmom01", ",", "\[Phi]"}], "]"}]], "/.", 
      RowBox[{"\[Phi]", "->", "\[Theta]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"errCOH", ",", "err01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2", "errCOH"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<state parameter \[Tau]\>\"", ",", 
         "\"\<phase estimation inaccuracy\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabels", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] |\[Psi](\[Tau])\
\[RightAngleBracket]\>\""}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.929101491442459*^9, 3.929101637308511*^9}, {
  3.929102596362795*^9, 3.929102603055075*^9}, {3.929434125329625*^9, 
  3.929434125903805*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"02e14d07-6722-480e-8116-e623907e891b"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQzbyf69xj00S7apF17g+rWuyDciRvzZjUbw/jT/wU
s3napPlwvvVRLy6n4g1wfkGVX+Lmgh1wfu6O1D4m5QNw/pUXnpzLk47A+V36
3xi2RZ6A8wu1T0w9sPQMnP8rOXvd3bwLcH7S3rCACWmX4Pzkj1cOHOi4Auf3
GGzPX9Z2Dc5nOrDdvKXqBpwvqOV97v6MW3C+x3ynxR8m3YHzxd+fcavffg/O
n3V8FyNz5gM430bW8b9CykM4X/uBwJPakkdw/toVQhlbix7D+TX3Yi9rtz1B
+M/GwnvelKcI/813SXo94Rmcf6FgVkL5oudwvqW70r+7C1/A+SddLVc4zHkJ
5y/dONPy0epXcL6osk5W3MrXcP4lRo4myT1v4PytHMXLLpx8C+friApkJR19
B+e/7/smYnztPZyv3N6un5/1Ac5/FHX7ltNzBN/j6eWfW/M+wvkVRakZYm8R
fL9ts73Eyj7B+e/+ZNUwf0PwF15v3JJX/BkRHhm2CZW/EXzZvxOjC6u+wPnP
3LtPcbB8hfMPq52xl+tG8LM4lrEocn6D87cvULE9PBHBP2dtczRI8Duc/yNr
dnBCH4J/ImB+KK/YD0R6s7RZvnwKgu+1q6gy8DaCb2i90vu34k84HwBRMpEO

       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJwV13k8VVsbB3ChUt3uSyVDaaAraZCpiPrVUaGBUqK6mcKNDJll2PsYiibD
IUVkKA3mKJRkuIeQ6QyGjFGkFCJkqN51/zif/fn+tZ619rOe/TtrrZyNbAQF
BAS6yO+/p1DJwvr36pa7+oykNXp8gvHXp1daq6KA6DQXCUOvYEznKFm/ZRni
QVhXTLFbMPqWnfuRzzLHhgXrveMdgtG2P7g8leWM6xPlPEuzYDSZs9YnsGh0
cb3sFzGCYeQg1XabFQ6ZacufnQuCETn6d14MKxFv1ZiVSXeCoFVxYCHDLQf3
2L3q4QWBuOBjYJl3oRALLTQWB40GwLHQJkxQrhTdV4SNxXUCwB/QX/DQio2f
yldshOOZGI5V2Bfkysa9M5Vir2OZWHhwfoB5IBvPn+xiXLvFxO5M9g+JFDZy
q96pSEYxke6CgdAeNnYov/9n71UmAqfVXttbVEDFYmtVvzcTSn+subTFrBJ6
RlLRpiZMHCj+VbrQqRJOwv0ah42ZsHbqnO33r0RRbNJFnWNMxDXGuScmVMKm
v4qjZsjEvJvi1qKdlRg01PqmqMtEh8windHTryG46VKYzXYmripNCOSfrELP
lVwdKSkmfLz0N/bbV8HSL8lnhQQTdiXxxsv9qtB0WClntTgTeoY6aZ53qzDd
9kx6ixgT850jjm1/XwWvicm5ZxcwEZyl+KDQoRqbjT1GTn+nQW02P1hE12Cx
m09Y/AsaTh65HoMRNZi4wZiRK6Bxpnhu0oqUGiw/knknO4+G9uGM777sGmTL
DPjzMmjMOEwlaC94A8vM5eOHE2l4Z0SNFLPewCd7wdL/XaLhsrHqZmlqLYI2
2w/UHqPxweYDMym/FtmZd/wGj9A4kSTgwHxdi7KxqUN/GtDYIa7J2P2pFu83
ZD200KMh+PvxUMmmOoy9K7DX2EmDxb2mW5JXh8B16keerachvPiRSiK7DmrQ
1JX8i4anLluGbqpDqalXOC1L49TL2bFdk3XQck6XPC1DQ/aBY9KrHfWo/ty6
df9SGrkXDaeKy+rhLM2+8vU3hXVPz39I4NZDPmB2fcxPCjFDIQ3+7+vRb1qr
qDNDwedsaerOuQ0wnayxSpugwDisbFSs14BSHZGXmV8p8NYsTX/Z0ICRO56L
rnRQmD57PqvTqRF3jce8YospWIiNeb/0bIT+xeeHhosoVLzy0blDNWJbQ5Go
/gsKEVJXW03DGlHItbITKaCwvuGRID+zEWVhFi75ORSO7+g/UfOlEWP0tFfj
fQovPjquffy9ERb0vJs29yisvjk+GDLbCIaMfsavZAqfh4UD9v3BQd/ExBvt
RAoBqXLppRs5UFyk0TMQSyFL1PJ3vj0Hf97nfhSIoLDs1UD1TVcOtGaPjTSF
Ubh4/kK0uw8HKk4nZ7NuUNhbSW9QucqBNmv+WsdrFNp97x7LfMxBmJZSulQI
hd0b5Fddf8KB68SKrj8vU3jQnDlg/5wD4+/XJUUuUXBVLvZXqOZAfWtb6rwg
CiIf2x/eG+Dg/Sx3ixpNwSn6rGvgCAd64Ylp+hQ5zz2D2pY/OLDkUcpn/Snc
jZ/mrBLhYm6AtFWKLwV1I6nZ2PVcHPL5cPKoN4W430mV3kpcGMFFM8SLgkCm
QqTJdi58Hm9cX+ZJoXa+hry4LhdW+6O37PGgYFV84kiELRcR7c8nXFwpqORL
LpFy5sLBW135hQsFwew2XrIXF+dSw1XnE6ckmZnkhXKRXW8Zme1M9hO7Rko7
kotc1+ivC4kZrN42diwXkd+ll553otAbZGvWnMbF1iS/Ik1HCrl+CmvM87iQ
6Pm565EDhUCPzz0fi7hI3rT6xgpi2X+cbKZqubDMcrkqep7Ud8DTYeUwF5he
KqZmR+rT0diSOsnF2E6bb1XnSH3a08ObBXhoZLvetSJO2Uy5QYyHteaJ5vf/
IfXJ71avkuJh6oi8+yFixmrBySOyPFTs0TwxZUvqE73sY6XKg8XG/CBL4twF
etqDWjyIy7o1rCQOFFz4y20vDzVLrD512FAwmnlTMnuIB+mxVE4ysez3GwGX
jHnIlTYPPU88+sVQ508zHn4z0hfvIC7vE5t7y5aHgcuplouJWV28ytXOPIRZ
2Qb3WZP9tdwMfeRF1ssT8iwnVmk0OaDM5OF8fsS2+8SC1VJ/vAjlYcmiVZVX
ibll7XWMSB4kcp6v8yROeZEQ/iaWB46ws5EtsWue+dHjKcRV+w1PEzMy1i7t
TOOheoXuCmPiJanv+TZ5PET6u+UfI+5NSI0ZKuJhTn3tGhPi3Jh/TL3YPAgf
PnrKnDgwfIO0QB0PMXGzVg7ERqGD7aFNPNTlv95BEcsGZCaIdZH9zXncE008
etHZPK6fhwva0SY5xOWuymvlhnkwDPGJbyRmnR/rTZ/koffsgZzx//Zv/ey+
mgAfBk+HWavJ+aic8bItFuEjsOjYXgNiwROaCvvFiGXOsAOIuQYzn+ql+Ejv
Hl7ygjhFtzjdRJaPL+e+Kk0Su+6mHd8p8jEvUG2FJnl/DM09SnaqfHw2TubT
/71vxYpcn718FFUaPllB+iFXLsRd6DAfvg+1+ReIA1fqb7tuTNZ7k8quIZb9
s+55gi0fQ1nyi2+Q/hqdF+4r78zHJy7fepy4/PeRndlefBwW3nTFivTn2W/8
0tJQPnQK+rYdtCfzzifCpDCCj+vMM9aviP8WOjSUfZuP2INvStRJf58Q/3dF
4iM+FMfv/95K+l9P84mnfxUf5QMP4k+S+7Ov3GGxRyMf27pVVIeIGQcV7ju0
8tE48Hz8MrlvWmcSOacH+OBci/nJvkBhS8CNTTtEmlBiqCjq5kZBcaH+v8qi
TSio1/6l4E7maZTwqQ2STfjiyRV/T7wm1TdEUqEJ4l7ypWfJfFhabdc7oduE
9EzzyZiLFH6I7r+dF9IEv32IZTMpfI+do5Qe3oTGMJXRlwEUvskWV6TcakLz
FV2n54Fk3qqpjUU+bMKzkpm6V8EUOk1lDS68bsKMkcKqmVByXkm/hDbPb4ac
t0GEJovCqw0v4tb9rxnJP9u63aIoFOV6KK+UaEaY+P4DudEUnrK/mC1a34x/
O2wdtW5ReDjQ9vzT/mbIJqh3UPEUrm8tcH5wuRke2Vqc6ocUalRa+j3CmnH3
uLLQrsdkvqpPntkX04yvGedk8tMoBGtuP/QhtRndFYIiuZkUfBkFCrIVzZi3
3+Reax4F++MFPQlCLYjt6DN9V0rh0YkWU8dFLZiyTy9mlVPkOzjZoL20BVkl
0b/12BQsz2x/1S7bArERvkTZawqmtgVxUowWZIxUBHfXU9D1Ljh2k9mCo0+O
JfM7yfo+LTXWoS1Q3+Xry+4m5+E3uUctogWuY2vlC3so7ArYvpWX2IKT5yI+
pfVR2Ha14A+xkhYsiZcWe0W+r+viCyqu/2yBo3/46rhf5H6UFmwP9mlF8F2P
Flk5GmmLlzz4GdgKJYm9USUkDxiddljmda0VrfkNjy0UaNybWPPNLr4VpfI/
erI309i7+Wqa4atWlE3KngrUoHE57m+ZFYJvoeexbM8EySMLPeYI5V55i5Oq
MwaiNMkL5addNrLeYpWORIV6IMkXovnd9+PeYko8x86c5J30dPuXt9Lf4mLv
eY2SazQO9fI8/OveYuW1A+U5t2mEGT4Y0BNrg03rNvVTJE+JKR6s777dBncU
lRUN0uifnyhWldQG7RNm+n8N03jRN3o851EbupzL9FmjNKyT49qZhW1Q3eqT
7TlFo1Dy88Da1jaMVj5zfyrEhNn8K0LWEu1YHr9z/AfJfxkfKjUGbraDv+/G
gUolkg8TGfdGWB0wn4hcfPACEyFVjZ2BdzrQldgnccuVicpvZpLi9zvgmeE3
+cGdiX17fW9oPuuAQXeByuWLTDA+5XkFtnRgsagi3RXIhLbqX4eWreyERD6d
0HeTia2v549vT+1EierIUd1iJiSGa/fTBV0wWcreJicWgLjXL+YI2b3DlKeq
/OjrAGjL7Pm9xroH2XuNY6hLgdj4TvSDv3svNvhlvoyyDkLmoyXnnrm+RzK7
+6o9+X/g13WGt/HyB0RNeWdV7boEF22Ng3ej++B769St1bsvYzpxr9VgRD+e
pM+rKdwWgsYLcRZeKR9R/07QY59uKEmJsr86kwdgvcnk1iL9K6jep/lod/wn
aG6KKwvXvYrUJ7Gavemf4evoMGD/9zWIy22yN3s8iInY1HI7s+vgzhEJlHr5
BdKFexDpfgPPRNweNFZ/Rf3RHRkqQWHYJC5qb1UxhEf5xziP/cIxHDaxTLV5
GDN1mtVxOhGQCwlRcrYfgfh4jTm3OAK9p9rbGB9H4GwnKWKgGgm9Pt7UM6dv
sNBPk+7PjoS3q8255V+/wXZ8aFx5LQsG+XcOLPccxZohxu5rt1kYmrX3E5oY
Rd76nV5BwlFIbgl46uQ2htDT7V8H7aMwfW6nxcWZMXQtapgYa4qCzM/I0y4+
3/FzTnRZt3o0BBYEPPzy9jt8l2Xp9vhE4//CI8HB
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.5707962947378287`, 0.01}], 
          Offset[{0.9397573063352647, -2.84900968850397}, {
           1.6349371421306265`, 0.01}], 
          Offset[{0, 0}, {1.729184917891472, 0.0041136361749561055`}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.0041136361749561055`}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.5707962947378287`, 0.01}], 
          Offset[{0.9397573063352647, -2.84900968850397}, {
           1.6349371421306265`, 0.01}], 
          Offset[{0, 0}, {1.729184917891472, 0.0041136361749561055`}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.0041136361749561055`}]}]}, 
       {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]]}], 
        PolygonBox[{
         Offset[{151., 8.000000000000034}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{151., -7.999999999999966}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., -7.999999999999998}, {1.729184917891472, 
           0.0041136361749561055`}], 
          Offset[{10., 8.000000000000002}, {1.729184917891472, 
           0.0041136361749561055`}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox["\<\"coherent |\[Gamma]=100\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], Offset[{80.5, 1.787459069646502*^-14}, 
        {1.729184917891472, 0.0041136361749561055}], NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.3032042067648604`, 0.02}], 
          Offset[{2.8025123377443, -1.0704786764765455`}, {
           1.6349371421306265`, 0.02}], 
          Offset[{0, 0}, {1.729184917891472, 0.019258349363415042`}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.019258349363415042`}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.3032042067648604`, 0.02}], 
          Offset[{2.8025123377443, -1.0704786764765455`}, {
           1.6349371421306265`, 0.02}], 
          Offset[{0, 0}, {1.729184917891472, 0.019258349363415042`}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.019258349363415042`}]}]}, 
       {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]]}], 
        PolygonBox[{
         Offset[{137., 8.00000000000003}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{137., -7.99999999999997}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., -7.999999999999998}, {1.729184917891472, 
           0.019258349363415042`}], 
          Offset[{10., 8.000000000000002}, {1.729184917891472, 
           0.019258349363415042`}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox["\<\"coherent |\[Gamma]=100\[RightAngleBracket]\
\[CircleTimes] |\[Psi](\[Tau])\[RightAngleBracket]\"\>",
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{73.5, 1.63202784619898*^-14}, \
{1.729184917891472, 0.019258349363415042}], NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}]}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"state parameter \[Tau]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation inaccuracy\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 201.08}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., 0.02}},
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.929101529043542*^9, 3.9291016461446466`*^9}, 
   3.929102163836358*^9, {3.929102596915943*^9, 3.929102603774197*^9}, {
   3.9294341237557793`*^9, 3.929434126324258*^9}, 3.9294342298534718`*^9, 
   3.929515907608964*^9, 3.929519872994125*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"f141961e-040b-4fd3-aad0-f5d37d63d95e"]
}, Open  ]],

Cell[TextData[{
 "The asymptotic improvement of accuracy can be determined analytically. Let\
\[CloseCurlyQuote]s assume for simplicity that the input coherent state has \
real positive displacement \[Gamma], and calculate the ",
 StyleBox["improvement",
  FontWeight->"Bold"],
 " as a function of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "295a941f-3f4c-4522-b4b4-31a2d7ec5b1b"],
 " and the parameterization angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa46877d-14ce-4ebf-94fb-191345610ff6"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929101656764954*^9, 3.929101697506556*^9}, {
  3.92910176408313*^9, 3.929101860027881*^9}, {3.929101894732038*^9, 
  3.929101895803157*^9}},ExpressionUUID->"3c0058f5-616b-43e9-9a55-\
a8eae74ad4d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"errCOH", "=", 
   FractionBox[
    SqrtBox["varCOH"], 
    RowBox[{"D", "[", 
     RowBox[{"firstmomCOH", ",", "\[Phi]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err01", "=", 
   FractionBox[
    SqrtBox[
     RowBox[{"var01", "//", "ComplexExpand"}]], 
    RowBox[{"D", "[", 
     RowBox[{"firstmom01", ",", "\[Phi]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"improvement", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"err01", "/", "errCOH"}], "/.", 
      RowBox[{"\[Phi]", "->", 
       RowBox[{"\[Pi]", "/", "2"}]}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Improvement = \>\"", ",", "improvement"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.929101702683208*^9, 3.929101757780043*^9}, {
  3.929101795189035*^9, 3.929101807675816*^9}, {3.929101864870141*^9, 
  3.929101928917044*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"cb5b2296-32bc-43e5-bb22-a932ec3c9538"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Improvement = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Gamma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{
           SqrtBox["2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Tau]"}], "]"}]}]}], ")"}]}]}]]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Gamma]", "2"], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Tau]"}], "]"}]}]]}],
  SequenceForm[
  "Improvement = ", $CellContext`\[Gamma] (-1 + $CellContext`\[Gamma]^2 + 
     Cos[2 $CellContext`\[Tau]])^(-1) (1 - (1 + 2 $CellContext`\[Gamma]^2) 
     Cos[2 $CellContext`\[Tau]] + $CellContext`\[Gamma]^2 (3 - 
       2^Rational[1, 2] Sin[2 $CellContext`\[Tau]]))^Rational[1, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9291019271540117`*^9, 3.929101929213242*^9}, 
   3.929102167011374*^9, 3.929102911667788*^9, 3.929434135848633*^9, 
   3.9294342314292393`*^9, 3.9295159096779428`*^9, 3.929519874353231*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"df38315b-61e2-4dfd-a69f-3884b6c6c417"]
}, Open  ]],

Cell[TextData[{
 "The minimum (and extremum, removed manually) can be determined by \
postulating that the derivative with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8a2b906c-a232-46a6-9563-fdbe125d4466"],
 " vanishes. The optimal \[Tau] can be determined for arbitrary \[Gamma], \
although it is a rather involved function of it. With increasing \[Gamma] it \
quickly stabilizes, so let\[CloseCurlyQuote]s determine its asymptotic value \
instead. For this, let\[CloseCurlyQuote]s calculate the derivative of ",
 StyleBox["improvement",
  FontWeight->"Bold"],
 " (squared, for easier calculations) and expand it around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\gamma \\rightarrow\\infty", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d963fc69-31be-414d-a3cc-12bc10205331"],
 ", and then find the solutions:"
}], "Text",
 CellChangeTimes->{{3.929101905350159*^9, 3.929102061045022*^9}, {
  3.929103151282426*^9, 3.929103270451091*^9}, {3.929103385907072*^9, 
  3.92910342301194*^9}},ExpressionUUID->"2dae0297-3c3e-4403-b2b7-\
3db2fa8635df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dd", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     SuperscriptBox["improvement", "2"], ",", "\[Tau]"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"dd", ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//",
       "Normal"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"dd", "==", "0"}], ",", "\[Tau]"}], "]"}], "//", "Normal"}], 
     ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"1"},
       "C"], "->", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928848288456199*^9, 3.92884850527309*^9}, {
  3.929102076449527*^9, 3.929102108813753*^9}, {3.929102172992856*^9, 
  3.92910217483001*^9}, {3.929102462337941*^9, 3.929102465314139*^9}, {
  3.929102779008226*^9, 3.929102806505568*^9}, {3.929103033684037*^9, 
  3.929103078322719*^9}, {3.929103278956938*^9, 3.929103312411542*^9}, {
  3.9291033501337748`*^9, 3.92910338165222*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"5ebe5836-e604-4a96-96a9-d74d3ee56230"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Gamma]", "2"], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], ")"}], "3"]], 
  RowBox[{
   SuperscriptBox["\[Gamma]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Gamma]", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Tau]"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "4"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Tau]"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9291030439343653`*^9, 3.929103078980011*^9}, {
   3.929103282239019*^9, 3.929103314794714*^9}, {3.929103352746044*^9, 
   3.929103382513404*^9}, 3.9291034250966263`*^9, 3.929434145802839*^9, 
   3.929434233231762*^9, 3.929515919409546*^9, 3.929519875993594*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"1da4d48d-1f77-496d-9526-c4a305b3e352"]
}, Open  ]],

Cell["The first solution corresponds to the minimum. It is:", "Text",
 CellChangeTimes->{{3.929102262054519*^9, 3.929102293398402*^9}, {
  3.929103433387639*^9, 3.9291034339480543`*^9}, {3.929103524372547*^9, 
  3.929103525988099*^9}},ExpressionUUID->"2eeb011a-dcfa-4c51-9dd8-\
1043366114fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Asymptotically optimal \[Tau] = \>\"", ",", 
    RowBox[{"\[Tau]", "/.", 
     RowBox[{"sols", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<For this \[Tau], improvement = \>\"", ",", 
   RowBox[{
    RowBox[{"improvement", "/.", 
     RowBox[{"sols", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Asymptotic improvement = \>\"", ",", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"improvement", "/.", 
       RowBox[{"sols", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"\[Gamma]", "->", "\[Infinity]"}]}], "]"}], "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"improvement", "/.", 
      RowBox[{"sols", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     SqrtBox[
      RowBox[{"3", "-", 
       SqrtBox["6"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Gamma]", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"Dotted", ",", "Black"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Input coherent state amplitude \[Gamma]\>\"", ",", 
      "\"\<phase estimation improvement\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.92910305612397*^9, 3.929103076385487*^9}, {
  3.929103437986318*^9, 3.929103438307919*^9}, {3.929103527412791*^9, 
  3.929103764007015*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"6c09b3d5-8cb2-4a16-b968-9b4ded5c5eb1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Asymptotically optimal \[Tau] = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox["1", 
      SqrtBox["2"]], "]"}]}]}],
  SequenceForm[
  "Asymptotically optimal \[Tau] = ", Rational[1, 2] 
   ArcTan[2^Rational[-1, 2]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.929519877548809*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"8c7cbd38-d372-4cbd-8f3d-f625ef83ae50"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"For this \[Tau], improvement = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{"9", "-", 
       RowBox[{"3", " ", 
        SqrtBox["6"]}]}]], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     SqrtBox["6"], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["\[Gamma]", "2"]}]}]]}],
  SequenceForm[
  "For this \[Tau], improvement = ", (9 - 3 6^Rational[1, 2])^
    Rational[1, 2] $CellContext`\[Gamma] (1 + 3 $CellContext`\[Gamma]^2)^
    Rational[1, 2]/(-3 + 6^Rational[1, 2] + 3 $CellContext`\[Gamma]^2)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.929519877620644*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"b1192a45-a3f4-423f-9a8a-4325e839e8b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Asymptotic improvement = \"\>", "\[InvisibleSpace]", 
   SqrtBox[
    RowBox[{"3", "-", 
     SqrtBox["6"]}]]}],
  SequenceForm[
  "Asymptotic improvement = ", (3 - 6^Rational[1, 2])^Rational[1, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.92951987765239*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"5563c9a6-ed27-40e6-969f-d062adefc87c"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[
  InterpretationBox[{
    TagBox[{{{}, {}, 
       TagBox[
        {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], 
         Opacity[1.], LineBox[CompressedData["
1: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
XFiloFQvn/fXCNcf7F5YWyPmN+k4E0r4v7KueYw=
          "]]},
        Annotation[#, "Charting`Private`Tag#1"]& ], 
       TagBox[
        {GrayLevel[0], AbsoluteThickness[2], Opacity[1.], Dashing[{0, Small}],
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
          "]]},
        Annotation[#, "Charting`Private`Tag#2"]& ]}, {}},
     {"WolframDynamicHighlight", <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
    StyleBox[
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
           Annotation[{
             Directive[
              Opacity[1.], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]], 
             Line[CompressedData["
1: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
XFiloFQvn/fXCNcf7F5YWyPmN+k4E0r4v7KueYw=
              "]]}, "Charting`Private`Tag#1"], 
           Annotation[{
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              Dashing[{0, Small}], 
              GrayLevel[0]], 
             Line[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
              "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {1.0000001836734715`, 0}, 
           "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              Dashing[{0, Small}], 
              GrayLevel[0]], 
             Directive[
              Opacity[1.], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {1.0000001836734715`, 0}, 
          "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             Dashing[{0, Small}], 
             GrayLevel[0]], 
            Directive[
             Opacity[1.], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}],
     Selectable->False]},
   Annotation[{{{{}, {}, 
       Annotation[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Line[CompressedData["
1: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
XFiloFQvn/fXCNcf7F5YWyPmN+k4E0r4v7KueYw=
          "]]}, "Charting`Private`Tag#1"], 
       Annotation[{
         Directive[
          Opacity[1.], 
          AbsoluteThickness[2], 
          Dashing[{0, Small}], 
          GrayLevel[0]], 
         Line[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
          "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
    "HighlightElements" -> <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
     "LayoutOptions" -> <|
      "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
       "Frame" -> {{False, False}, {False, False}}, 
       "AxesOrigin" -> {1.0000001836734715`, 0}, 
       "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
       "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
         Directive[
          Opacity[1.], 
          AbsoluteThickness[2], 
          Dashing[{0, Small}], 
          GrayLevel[0]], 
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]]}, 
       "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), 
         "ScalingFunctions" -> {{Identity, Identity}, {Identity, Identity}}|>,
        "Primitives" -> {}, "GCFlag" -> False|>, 
     "Meta" -> <|
      "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
       Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"Input coherent state amplitude \[Gamma]\"", HoldForm], 
     TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation improvement\"", HoldForm], TraditionalForm]},
  AxesOrigin->{1.0000001836734715`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.929103648678112*^9, 3.929103686143764*^9}, {
   3.92910373385146*^9, 3.929103764977265*^9}, 3.929434150658032*^9, 
   3.929434234437051*^9, 3.9295159219409*^9, 3.92951987769389*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"94437d0b-8d18-477e-82e2-19b3cfc7e446"]
}, Open  ]],

Cell[TextData[StyleBox["Characteristic functions",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.9288301696625957`*^9, 
  3.928830174796299*^9}},ExpressionUUID->"6f743431-7967-4419-b533-\
60392802e628"],

Cell[TextData[{
 "Such a state offers metrological advantage, and here we show that it can be \
produced from bimodal input of coherent and vacuum states. First, let\
\[CloseCurlyQuote]s calculate its characteristic function with respect to the \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "709b43a9-01d6-4eb6-933f-920a12ea51db"],
 " group corresponding to the interferometer action. The ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "26eafe96-bacc-47a6-b35b-79e6d980de3e"],
 " parameter is exactly the angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b25ab966-c4b8-447a-a668-09f8de3865ea"],
 " of differential phase shift inside the interferometer. \nThe ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ca7f768f-fb08-41fa-9374-be408db68005"],
 " group is a subgroup of the overall ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0f198cc3-d252-4748-af09-e6feae6d5f65"],
 " structure, related to arbitrary mode mixing operations. Let us notice that \
the matrix describing the interferometer action on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["a", "TI"], "1"], ",", 
         SubscriptBox[
          StyleBox["a", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "a_1, a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "613a3300-45f1-4f6e-bd66-55dba538a885"],
 " operators is indeed a standard 2D rotation, which can be thought of as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1841430b-0cfd-4925-88d0-237ffab9d827"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929104138228947*^9, 3.929104330896306*^9}, {
  3.929434529366324*^9, 3.929434571308627*^9}, {3.9294346106097403`*^9, 
  3.929434670359533*^9}, {3.929434721779547*^9, 3.929434726116576*^9}, {
  3.929434791272606*^9, 
  3.929434858244568*^9}},ExpressionUUID->"477af2e5-eed7-47ee-90ba-\
3bb6eff880be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B"}], ")"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "//", "FullSimplify"}],
   "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.92943472692667*^9, 3.929434761030216*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"ca0732f6-37bc-48a1-a3d7-047171f1c90d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.929434731935095*^9, 3.929434761424795*^9}, 
   3.92943485933433*^9, 3.929515934155878*^9, 3.929519879087347*^9},
 CellLabel->
  "Out[61]//MatrixForm=",ExpressionUUID->"a5f4e896-cafd-4ddd-bc65-\
b34bbf91fd99"]
}, Open  ]],

Cell[TextData[{
 "Comparing it to the most general form of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "59aa103d-5184-4876-a38f-127a1fc89f1f"],
 " matrix , ",
 Cell[BoxData[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"u", 
      RowBox[{"-", 
       RowBox[{"v", "\[Conjugate]"}]}]},
     {"v", 
      RowBox[{"u", "\[Conjugate]"}]}
    }], "\[NoBreak]", ")"}]], "Input",
  CellChangeTimes->{{3.928844015916676*^9, 3.9288440160807743`*^9}},
  ExpressionUUID->"45523dd9-88e8-405b-adbe-c5c2526e6124"],
 ", we see that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["u", "TI"], "\[LongEqual]", "cos", 
         FractionBox["\[Theta]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "u=\\cos{\\frac{\\theta}2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e06f7dae-73c7-4174-a3da-2d90bd17b167"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", "sin", 
         FractionBox["\[Theta]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=\\sin{\\frac{\\theta}2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e4939087-e646-4886-bdbd-046a9480ff4e"],
 ". With ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", 
         StyleBox["u", "TI"], "+", 
         StyleBox["i", "TI"], 
         StyleBox["v", "TI"], "\[LongEqual]", "exp", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "\[Theta]", "/", "2"}], ")"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "z=u+i v=\\exp(i\\theta/2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "967afdb2-8163-46f4-9689-30ea2ee0a10a"],
 " (and the constraint that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", 
         StyleBox["z", "TI"], "|", "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\lvert z\\rvert=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ac0ae8f-80f0-4ca5-a91f-8426c98708ce"],
 "), one can write the matrix as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "z"}]], 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"1", "+", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]},
        {
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}], 
         RowBox[{"1", "+", 
          SuperscriptBox["z", "2"]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], TraditionalForm]],ExpressionUUID->
  "5f5efa57-2e32-417b-a517-3392fcd82f95"],
 ", and this can be directly used in the calculation of the characteristic \
functions related to the interferometer action. \n\nThe initial state is",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "834fa225-7aad-48c2-8820-278875f310dd"],
 " , where  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\psi\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "98650aed-eb08-48e8-a24c-12a6ff58b8c4"],
 " and  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-|", "\[Alpha]", 
            SuperscriptBox["|", "2"]}]], 
         UnderscriptBox["\[Sum]", 
          StyleBox["n", "TI"], LimitsPositioning -> True], 
         FractionBox[
          SuperscriptBox["\[Alpha]", 
           StyleBox["n", "TI"]], 
          SqrtBox[
           RowBox[{
             StyleBox["n", "TI"], "!"}]]], "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "\[RightAngleBracket]"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle=e^{-\\lvert \
\\alpha\\rvert^2}\\sum_{n}\\frac{\\alpha^n}{\\sqrt{n!}} \
\\lvert\\!\\!n\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b726d83c-da7d-48d8-a940-b89dbc2363fe"],
 " is a coherent state, and in the product basis the total state can be \
written as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-|", "\[Alpha]", 
            SuperscriptBox["|", "2"]}]], 
         RowBox[{"(", 
           RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
             RowBox[{"0", ",", "0"}]}], "\[RightAngleBracket]"}], "cos", 
         "\[Tau]", "+", "\[Alpha]", "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", 
         RowBox[{"1", ",", "0"}], "\[RightAngleBracket]", "cos", "\[Tau]", 
         "+", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "2"}], LimitsPositioning -> 
          True], 
         RowBox[{"[", 
           RowBox[{
             FractionBox[
              SuperscriptBox["\[Alpha]", 
               StyleBox["n", "TI"]], 
              SqrtBox[
               RowBox[{
                 StyleBox["n", "TI"], "!"}]]], "|", "\[NegativeThinSpace]", 
             "\[NegativeThinSpace]", 
             StyleBox["n", "TI"], ",", "0"}], "\[RightAngleBracket]"}], "cos",
          "\[Tau]", "-", 
         FractionBox[
          SuperscriptBox["\[Alpha]", 
           RowBox[{
             StyleBox["n", "TI"], "-", "2"}]], 
          SqrtBox[
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 StyleBox["n", "TI"], "-", "2"}], ")"}], "!"}]]], "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "-", "2", ",", "2", "\[RightAngleBracket]", 
         "sin", "\[Tau]", "]", ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle=e^{-\\\
lvert \\alpha\\rvert^2}\\left( \
\\lvert\\!\\!{0,0}\\rangle\\cos\\tau+\\alpha\\lvert\\!\\!{1,0}\\rangle\\cos\\\
tau+\\sum_{n=2} [\\frac{\\alpha^n}{\\sqrt{n!}} \\lvert\\!\\! n,0\\rangle  \
\\cos\\tau-\\frac{\\alpha^{n-2}}{\\sqrt{(n-2)!}}  \\lvert\\!\\! n-2,2\\rangle \
\\sin\\tau ] \\right)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "19ca021b-1053-4ca7-bc16-6a6e2928d512"],
 " .\nThus, for characteristic function we need only the matrix elements of \
the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e5f8fa0d-7db6-46f3-8316-e3f654d29f08"],
 " unitary representation between ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], ",", "0", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\! n,0\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db25b241-0871-4198-8ec1-dc06fb11f6c2"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "-", "2", ",", "2", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\! n-2,2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1f17a803-275e-4d7b-acc8-5a75ea9be21e"],
 "  states. They can be found explicitly, and the following code defines the \
matrix elements (as a ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"2", "\[Cross]", "2"}], TraditionalForm], "errors" -> {}, 
     "input" -> "2\\times 2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b855061-f912-4c9f-8da7-abdc556b2b23"],
 " matrix) in the function ",
 StyleBox["RedSU2",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.929434861314918*^9, 3.9294349956800747`*^9}, {
  3.9294350350605283`*^9, 3.929435153520013*^9}, {3.9294354602770643`*^9, 
  3.929435597700728*^9}, {3.929518336494903*^9, 
  3.92951835832664*^9}},ExpressionUUID->"e39aa447-bbab-44ae-b8e1-\
3ffcda782ec1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"statetopoly", "[", 
    RowBox[{"j_", ",", "\[Psi]_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"j", "-", "m"}], ")"}]}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"2", "j"}], ",", 
         RowBox[{"j", "-", "m"}]}], "]"}], "]"}], 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "m"}], ")"}], "+", "1"}], "]"}], "]"}], 
      RowBox[{"z1", "^", 
       RowBox[{"(", 
        RowBox[{"j", "+", "m"}], ")"}]}], 
      RowBox[{"z2", "^", 
       RowBox[{"(", 
        RowBox[{"j", "-", "m"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "j"}], ",", "j"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Majorana", " ", "polynomial", " ", "for", " ", "a", " ", "given", " ", 
    "state", " ", "\[Psi]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transformpoly", "[", 
    RowBox[{"poly_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"poly", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z1", ",", "z2"}], "}"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z1", ",", "z2"}], "}"}], ".", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"u", 
            RowBox[{"-", "v"}]},
           {"V", "U"}
          }], "\[NoBreak]", ")"}]}], ")"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getcoeff", "[", 
    RowBox[{"j_", ",", "poly_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "coeff", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff", " ", "=", 
       RowBox[{"Reverse", "@", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"poly", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeff", "=", 
       RowBox[{"Diagonal", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"coeff", "=", 
       RowBox[{"coeff", " ", "*", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}]}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"2", "*", "j"}], ",", 
              RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}]}], "}"}]}], "]"}]}]}]}]}], 
    "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"state", " ", "for", " ", "a", " ", "given", " ", "polynomial"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SU2Unitary", "[", "j_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basisstates", ",", "basispolys", ",", "z"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"basisstates", "=", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{
         RowBox[{"2", "j"}], "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"basispolys", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"transformpoly", "[", 
          RowBox[{
           RowBox[{"statetopoly", "[", 
            RowBox[{"j", ",", "#", ",", 
             RowBox[{"{", 
              RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], "&"}], "/@", 
        "basisstates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"getcoeff", "[", 
         RowBox[{"j", ",", "#", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], "&"}], "/@", 
       "basispolys"}]}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Hilbert", " ", "state", " ", "picture", " ", "of", " ", "the", " ", 
    "transformation", " ", "defined", " ", "in", " ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"how", " ", "are", " ", "basis", " ", "states", " ", 
      RowBox[{"transformed", "?"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SU2Unitary", "[", 
   RowBox[{"jmin_", ",", "jmax_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Hold", "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SU2Unitary", "[", "j", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jmin", ",", "jmax", ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "]"}], "//", 
    "ReleaseHold"}], "//", "ArrayFlatten"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SUB1Unitary", "[", "j_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"SU2Unitary", "[", "j", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "+", 
          RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], ",", 
      RowBox[{"v", "->", 
       RowBox[{"\[ImaginaryI]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}]}], ",", 
      RowBox[{"U", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "+", 
          RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], ",", 
      RowBox[{"V", "->", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "z"}], "-", "z"}], ")"}], "/", "2"}]}]}]}], 
     "}"}]}], "//", "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RedSU2", "[", "j_", "]"}], ":=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SuperscriptBox["u", 
        RowBox[{"2", "j"}]], 
       RowBox[{
        SqrtBox[
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"2", "j"}], ",", "2"}], "]"}]], " ", 
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "2"}]], " ", 
        SuperscriptBox["V", "2"]}]},
      {
       RowBox[{
        SqrtBox[
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"2", "j"}], ",", "2"}], "]"}]], " ", 
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "2"}]], " ", 
        SuperscriptBox["v", "2"]}], 
       RowBox[{
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "4"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["U", "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "j"}], "-", "4"}], ")"}], " ", "u", " ", "U", " ", 
           "v", " ", "V"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "j"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "j"}]}], ")"}], " ", 
           SuperscriptBox["v", "2"], " ", 
           SuperscriptBox["V", "2"]}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]}], "Input",
 CellChangeTimes->{{3.928844015916676*^9, 3.9288440160807743`*^9}, {
  3.9294356011077003`*^9, 3.929435609102232*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"7f765123-f10d-4ce3-9553-995633c30e81"],

Cell[TextData[{
 "Characteristic  function  is parameterized by a complex variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a6966fa-abaf-4c2f-92c6-55f0ac62064f"],
 ", as mentioned before. The characteristic function can be calculated \
explicitly by the following code block. Here, for simplification we \
reparameterize ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cos", "\[Tau]", "\[RightTeeArrow]", 
         SqrtBox[
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\cos\\tau \\mapsto \\sqrt{1-r}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "730c296d-9a13-4bbf-b60c-72f71b9f5c3d"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", "\[Tau]", "\[RightTeeArrow]", 
         SqrtBox[
          StyleBox["r", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\sin\\tau\\mapsto\\sqrt{r}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e9a62f4a-f71a-4215-aa3c-9518d9259974"],
 ", perform the summation, and switch back to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b84560c2-8345-41d8-9bc7-ea96bcc48cb6"],
 " variables at the end; the characteristic function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Chi]", "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\chi(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20be789b-6da4-4870-8c18-241e3b36c27d"],
 " is exactly the overlap between the output of the interferometer and its \
input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "17da9948-da06-493f-ae75-ff321241f44e"],
 ", for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "exp", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "\[Theta]", "/", "2"}], ")"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> "z=\\exp(i\\theta/2)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "10073d3a-269f-4018-aa77-fa74d141a1c6"],
 "."
}], "Text",
 CellChangeTimes->{{3.929104338727257*^9, 3.929104349839161*^9}, {
  3.929104654778036*^9, 3.929104687844733*^9}, {3.929435646943065*^9, 
  3.929435725501505*^9}, {3.929435771333397*^9, 
  3.929435896710464*^9}},ExpressionUUID->"5254597e-d0ab-4e49-a673-\
c469d2754bb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"u", "=", 
       FractionBox[
        RowBox[{"z", "+", 
         RowBox[{"1", "/", "z"}]}], "2"]}], ",", 
      RowBox[{"U", "=", 
       FractionBox[
        RowBox[{"z", "+", 
         RowBox[{"1", "/", "z"}]}], "2"]}], ",", 
      RowBox[{"v", "=", 
       FractionBox[
        RowBox[{"z", "-", 
         RowBox[{"1", "/", "z"}]}], 
        RowBox[{"2", "\[ImaginaryI]"}]]}], ",", 
      RowBox[{"V", "=", 
       FractionBox[
        RowBox[{"z", "-", 
         RowBox[{"1", "/", "z"}]}], 
        RowBox[{"2", "\[ImaginaryI]"}]]}], ",", "n"}], "}"}], ",", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vec", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "/", "2"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Gamma]", "n"], 
           SqrtBox[
            RowBox[{"1", "-", "r"}]]}], 
          SqrtBox[
           RowBox[{"n", "!"}]]], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", 
            SuperscriptBox["\[Gamma]", 
             RowBox[{"n", "-", "2"}]]}], 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}], "!"}]]], 
          SqrtBox["r"]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"covec", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "/", "2"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "n"], 
           SqrtBox[
            RowBox[{"1", "-", "r"}]]}], 
          SqrtBox[
           RowBox[{"n", "!"}]]], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], 
             RowBox[{"n", "-", "2"}]]}], 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}], "!"}]]], 
          SqrtBox["r"]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ex0", "=", 
      RowBox[{
       RowBox[{"covec", ".", 
        RowBox[{"RedSU2", "[", "j", "]"}], ".", "vec"}], "//", "Expand"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ex1", "=", "ex0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"ex1", ",", 
         RowBox[{"Assumptions", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", ">=", "2"}], ",", 
            RowBox[{"r", ">", "0"}], ",", 
            RowBox[{"r", "<", "1"}]}], "}"}]}]}], "]"}], "//", "Expand"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{"ex2", "/.", 
       RowBox[{
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "r", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], "!"}], " ", 
            RowBox[{"n", "!"}]}], ")"}]}]], ":>", 
        RowBox[{
         RowBox[{"n", "!"}], 
         SqrtBox[
          RowBox[{"r", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{"ex2", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"ex2", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", "\[Infinity]"}], "}"}]}], "]"}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Gamma]"}], " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "z"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["z", "2"]}], ")"}], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "z"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"\[Chi]", "/.", 
        RowBox[{"{", 
         RowBox[{"r", "->", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"]}]}], "}"}]}], "//", 
       "Simplify"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.928835865621401*^9, 3.928836032169384*^9}, {
   3.928836079526668*^9, 3.928836137177278*^9}, {3.928836171615386*^9, 
   3.9288361887964582`*^9}, {3.928836245494801*^9, 3.928836284864968*^9}, {
   3.928836338163987*^9, 3.928836488812563*^9}, {3.9288365271133842`*^9, 
   3.928836598287652*^9}, {3.928836695563793*^9, 3.928836871863175*^9}, {
   3.928836912754777*^9, 3.928836914937295*^9}, {3.928836954116003*^9, 
   3.928837054772881*^9}, {3.92883710071955*^9, 3.92883719396315*^9}, {
   3.928837275774677*^9, 3.9288374468413*^9}, {3.928837511028903*^9, 
   3.928837597654594*^9}, 3.928837849140325*^9, {3.92883787970463*^9, 
   3.928837880567122*^9}, {3.928838087714375*^9, 3.92883813404102*^9}, {
   3.928838328477874*^9, 3.928838433672863*^9}, {3.928839036380371*^9, 
   3.928839045617124*^9}, {3.928839437294225*^9, 3.92883950625383*^9}, {
   3.928839583048129*^9, 3.928839584365975*^9}, {3.928839731184886*^9, 
   3.928839744736106*^9}, {3.9288398009540043`*^9, 3.9288398256977997`*^9}, {
   3.928840033811348*^9, 3.928840034406275*^9}, {3.928840145730562*^9, 
   3.928840145866111*^9}, 3.92884063049382*^9, {3.928844035511318*^9, 
   3.92884403643027*^9}, {3.929104371904838*^9, 3.92910441015731*^9}, {
   3.929104459455519*^9, 3.929104467475481*^9}, {3.9291045365838213`*^9, 
   3.929104636169947*^9}, {3.929104693044354*^9, 3.9291047349805803`*^9}, {
   3.929104800792921*^9, 3.929104935377956*^9}, {3.92910519422802*^9, 
   3.929105235057697*^9}, {3.9294357666938467`*^9, 3.929435767469143*^9}, {
   3.929435801278122*^9, 3.929435808435357*^9}, {3.929435916534561*^9, 
   3.929435917512598*^9}, {3.929435956753663*^9, 3.92943595694708*^9}, {
   3.929435997518243*^9, 3.929436027643856*^9}, {3.92943633301816*^9, 
   3.9294363559867*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"6d9dba03-a33a-475b-9169-89547d2fb890"],

Cell[TextData[{
 "It  is a rather complex expression involving the defining variables ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ffe11949-ebf4-478b-8cac-6a768a2c3922"],
 " (coherent state amplitude), ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d3bb7a5-9abc-4fca-9da5-9065f5ef5f1f"],
 " (squeezed state approximation parameter), and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0d72a360-dfac-451c-8b1c-f697f333771d"],
 " (describing the interferometer phase difference angle). If we plug in the \
calculated (in the previous section) optimal angle we obtain:"
}], "Text",
 CellChangeTimes->{{3.9294359736319437`*^9, 3.929435982415983*^9}, {
  3.929436042215863*^9, 
  3.929436135496669*^9}},ExpressionUUID->"130d0ac1-556b-4f33-a082-\
644e1d3f4d13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Chi]opt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Tau]", "->", "\[InvisibleSpace]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ArcTan", "[", 
          FractionBox["1", 
           SqrtBox["2"]], "]"}]}]}], "}"}]}], "//", "TrigToExp"}], "//", 
    "Expand"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.929435968056211*^9, 3.929435970184808*^9}, {
  3.92943613685322*^9, 3.9294361379857283`*^9}, {3.929436364001829*^9, 
  3.929436395082978*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"bf5ded0b-f9a8-427c-9293-a13e3c7e66c8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    SqrtBox["6"], " ", 
    SuperscriptBox["z", "4"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "-", 
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SuperscriptBox["z", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]], " ", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
           RowBox[{"2", " ", "z"}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"], "+", 
           SuperscriptBox["\[Gamma]", "2"], "+", 
           RowBox[{
            SuperscriptBox["z", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"6", " ", 
               SqrtBox["6"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Gamma]", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["z", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              SqrtBox["6"], "+", 
              SuperscriptBox["\[Gamma]", "2"]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"8", " ", "z", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]], " ", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
           RowBox[{"2", " ", "z"}]]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]}], ")"}], " ", 
      "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
         RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
        RowBox[{"2", " ", "z"}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["z", "2"]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["z", "4"], " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"8", "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              SqrtBox["6"]}], ")"}], " ", 
            SuperscriptBox["\[Gamma]", "2"]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.929435970617123*^9, 3.9294360392916193`*^9, 3.929436090679518*^9, 
   3.929436138436926*^9, {3.929436387227943*^9, 3.929436395999606*^9}, 
   3.92951595586476*^9, 3.929519892641469*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"50328a66-8916-4420-a3b0-40820274ba65"]
}, Open  ]],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Tau]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\tau=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1b1839f1-625a-448e-bf41-8af9666aafcc"],
 ", the characteristic function corresponds to the interferometer input being \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!0\\rangle", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f2bd44da-d8bd-4fdd-a453-b0e495eb7df9"],
 " \[Dash] coherent in the first port, vacuum in the second. As it turns out, \
the form of the characteristic function of this state is a (rescaled) \
generating function of the modified Bessel functions ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], "(", 
         StyleBox["a", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5c1bf090-24d6-4468-ade2-a832090c2ce4"],
 " (see Appendix B of [1], Eq. B.51), and can be decomposed into a sum ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Chi]", "\[LongEqual]", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[Element]", 
            StyleBox["Z", FontSlant -> "Plain"]}], LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["k", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            SuperscriptBox["\[Gamma]\[Gamma]", "*"]}]], 
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           SuperscriptBox["\[Gamma]\[Gamma]", "*"], ")"}]}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "\\chi=\\sum_{k\\in \\mathbb{Z}} z^k e^{-\\gamma \\gamma^*}I_k(\\gamma \
\\gamma^*)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e942b33e-e385-422c-a77a-9bad368a62a8"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929436156090006*^9, 3.929436217969096*^9}, {
  3.929436521193947*^9, 3.92943658003662*^9}, {3.929516850874923*^9, 
  3.929516866947013*^9}, {3.929518419251515*^9, 3.929518467713565*^9}, {
  3.92952067648927*^9, 3.9295206781825323`*^9}, {3.9295207352552433`*^9, 
  3.9295207697674417`*^9}, {3.929520832107142*^9, 
  3.929520863266062*^9}},ExpressionUUID->"96eb2e9c-435b-4da2-ba6f-\
6cce03e83b92"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Chi]coh", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]", "/.", 
     RowBox[{"\[Tau]", "->", "0"}]}], "//", "FullSimplify"}], "//", 
   "PowerExpand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BesselIGeneratingFn", "[", 
   RowBox[{"a_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"a", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Is \!\(\*SubscriptBox[\(\[Chi]\), \(\(coherent\)\(\\\ \)\)]\)equal to \
\!\(\*SuperscriptBox[\(e\), \(\(-\[Gamma]\)\\\  \[Gamma]\[Conjugate] \
\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(\[Sum]\), \(\[Infinity]\)], \(k = \
\(-\[Infinity]\)\)]\)\!\(\*SuperscriptBox[\(z\), \
\(k\)]\)\!\(\*SubscriptBox[\(I\), \(k\)]\)(\[Gamma]\[Gamma]\[Conjugate])? :\>\
\"", ",", 
   RowBox[{
    RowBox[{"\[Chi]coh", "==", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", 
        RowBox[{"\[Gamma]", "\[Conjugate]"}]}], "]"}], 
      RowBox[{"BesselIGeneratingFn", "[", 
       RowBox[{
        RowBox[{"\[Gamma]", " ", 
         RowBox[{"\[Gamma]", "\[Conjugate]"}]}], ",", "z"}], "]"}]}]}], "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ck", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
    RowBox[{"BesselI", "[", 
     RowBox[{"k", ",", 
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9294362202147284`*^9, 3.929436280897497*^9}, {
  3.929436405124446*^9, 3.929436429250927*^9}, {3.9294364938053927`*^9, 
  3.929436515068973*^9}, {3.929436582384362*^9, 3.9294365883423367`*^9}, {
  3.929436682209029*^9, 3.929436721949092*^9}, {3.9294390701264057`*^9, 
  3.929439160734522*^9}, {3.929439197481487*^9, 3.929439198392118*^9}, {
  3.929439234813191*^9, 3.929439263924613*^9}, {3.929439295839961*^9, 
  3.929439381771067*^9}, {3.92943941296488*^9, 3.929439548810053*^9}, {
  3.929439812024003*^9, 3.929439885329472*^9}, {3.929440748501072*^9, 
  3.929440769176251*^9}, {3.929516879185458*^9, 3.929517034738635*^9}, {
  3.929518475164882*^9, 3.929518551155999*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"b4bb6867-fd32-4a33-aa04-98bed124fbc6"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
   RowBox[{"2", " ", "z"}]]]], "Output",
 CellChangeTimes->{{3.929439149700138*^9, 3.929439161136772*^9}, {
   3.92943924904593*^9, 3.929439264290958*^9}, {3.929439307008562*^9, 
   3.92943934202562*^9}, {3.929439375251663*^9, 3.929439382012821*^9}, {
   3.929439418798646*^9, 3.9294394975589437`*^9}, {3.929439528125622*^9, 
   3.929439549320179*^9}, {3.92943982803125*^9, 3.929439885948931*^9}, {
   3.929440760614939*^9, 3.929440769680421*^9}, 3.929515965264391*^9, {
   3.929516879965859*^9, 3.929516917728491*^9}, {3.9295169477481203`*^9, 
   3.929516968581228*^9}, 3.929517035097662*^9, 3.929518475785369*^9, {
   3.9295185289646072`*^9, 3.929518552416358*^9}, 3.929519892778652*^9, 
   3.929520864412726*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"a73f96b4-1b73-4adb-abca-024f98ca7a75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Is \\!\\(\\*SubscriptBox[\\(\[Chi]\\), \
\\(\\(coherent\\)\\(\\\\ \\)\\)]\\)equal to \\!\\(\\*SuperscriptBox[\\(e\\), \
\\(\\(-\[Gamma]\\)\\\\  \[Gamma]\[Conjugate] \
\\)]\\)\\!\\(\\*SubscriptBox[SuperscriptBox[\\(\[Sum]\\), \\(\[Infinity]\\)], \
\\(k = \\(-\[Infinity]\\)\\)]\\)\\!\\(\\*SuperscriptBox[\\(z\\), \
\\(k\\)]\\)\\!\\(\\*SubscriptBox[\\(I\\), \\(k\\)]\\)(\[Gamma]\[Gamma]\
\[Conjugate])? :\"\>", "\[InvisibleSpace]", "True"}],
  SequenceForm[
  "Is \!\(\*SubscriptBox[\(\[Chi]\), \(\(coherent\)\(\\ \)\)]\)equal to \
\!\(\*SuperscriptBox[\(e\), \(\(-\[Gamma]\)\\  \[Gamma]\[Conjugate] \)]\)\!\(\
\*SubscriptBox[SuperscriptBox[\(\[Sum]\), \(\[Infinity]\)], \(k = \(-\
\[Infinity]\)\)]\)\!\(\*SuperscriptBox[\(z\), \
\(k\)]\)\!\(\*SubscriptBox[\(I\), \(k\)]\)(\[Gamma]\[Gamma]\[Conjugate])? :", 
   True],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9295185289661694`*^9, 3.929518552417985*^9}, 
   3.9295198927948637`*^9, 3.9295208644140577`*^9},
 CellLabel->
  "During evaluation of \
In[124]:=",ExpressionUUID->"e0f2a467-560c-4993-8011-d619f5139b2b"]
}, Open  ]],

Cell[TextData[{
 "The  characteristic function ",
 StyleBox["\[Chi]opt",
  FontWeight->"Bold"],
 " of the optimal state is the one of the coherent state ",
 StyleBox["\[Chi]coh",
  FontWeight->"Bold"],
 " multiplied by a expression involving powers of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f43dacd8-7303-4d48-9d2d-e29340f0c2d0"],
 " from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["z", "TI"], "-4"], TraditionalForm], "errors" -> {}, "input" -> 
     "z^{-4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "728de9af-cbe1-428c-9b44-a4d6e577b274"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["z", "TI"], "4"], TraditionalForm], "errors" -> {}, "input" -> 
     "z^{4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0e7de1c8-f2ef-4de0-84c5-d6e34808fcd5"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929436459106413*^9, 3.929436478762716*^9}, {
   3.929439592956551*^9, 3.9294396859657183`*^9}, 
   3.929439799041803*^9},ExpressionUUID->"71cab039-3de7-40a2-a986-\
856847ad4839"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"charfnprod", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["\[Chi]opt", 
           RowBox[{"\[Chi]coh", " ", 
            SuperscriptBox["z", 
             RowBox[{"-", "4"}]]}]], "//", "FullSimplify"}], ")"}], 
        SuperscriptBox["z", 
         RowBox[{"-", "4"}]]}], "//", "Expand"}], ")"}], ",", "z"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.928835507715638*^9, 3.928835576502369*^9}, {
  3.928835614315892*^9, 3.928835651769873*^9}, {3.928835717491887*^9, 
  3.928835725000546*^9}, {3.928836661330082*^9, 3.928836685920833*^9}, {
  3.92910501451429*^9, 3.929105021080008*^9}, {3.929436445428214*^9, 
  3.929436456603797*^9}, {3.929439712150739*^9, 3.929439794082394*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"e8fdb5b9-f07c-46f2-b00a-0b73aadb0691"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["6"]}]], "-", 
  FractionBox[
   SuperscriptBox["\[Gamma]", "2"], 
   RowBox[{"4", " ", 
    SqrtBox["6"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "32"], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["3", "2"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
  FractionBox[
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "64"], "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
     RowBox[{"32", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "4"]], "+", 
  RowBox[{
   SuperscriptBox["z", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "64"], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
      RowBox[{"32", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
   RowBox[{"4", " ", 
    SqrtBox["6"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "8"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "3"]], "+", 
  RowBox[{
   SuperscriptBox["z", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "8"], " ", "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
     FractionBox[
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]]}], "z"], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], " ", "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
     FractionBox[
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    FractionBox["1", "8"], "-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]], "+", 
    FractionBox[
     SuperscriptBox["\[Gamma]", "2"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]], "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "16"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "2"]], "+", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["1", 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[Gamma]", "2"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "16"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.928835509513639*^9, 3.928835579213209*^9}, {
   3.928835633309031*^9, 3.9288356521741877`*^9}, {3.9288357202994432`*^9, 
   3.928835725495573*^9}, {3.928836656157196*^9, 3.92883668616003*^9}, 
   3.928841370583318*^9, {3.9288438985910254`*^9, 3.928843928517374*^9}, 
   3.9288440497057257`*^9, 3.929104439801717*^9, 3.929104476055002*^9, 
   3.929105026997994*^9, 3.929105083793121*^9, 3.929105277223466*^9, 
   3.929436459659875*^9, {3.929439715655026*^9, 3.929439797069887*^9}, 
   3.92951603579163*^9, 3.929517049169763*^9, 3.929518560379745*^9, 
   3.9295198954825363`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"4236b0ac-11ae-454d-81bf-7970192dc6be"]
}, Open  ]],

Cell[TextData[{
 "Thus, the characteristic function ",
 StyleBox["\[Chi]opt",
  FontWeight->"Bold"],
 " can be written as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Chi]", "opt"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[LongEqual]", "-", "\[Infinity]"}], 
          "\[Infinity]", LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["k", "TI"]], 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\chi_{\\text{opt}}=\\sum_{k=-\\infty}^{\\infty}z^k P_k", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04822151-036e-48ee-b62a-0fe172c4ec70"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a63d564b-56a2-4282-a8f7-9086f5f1827f"],
 " is convolution of the coherent state coefficients ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["k", "TI"]], "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            SuperscriptBox["\[Gamma]\[Gamma]", "*"]}]], 
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           SuperscriptBox["\[Gamma]\[Gamma]", "*"], ")"}]}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "C_k=e^{-\\gamma \\gamma^*}I_k(\\gamma \\gamma^*)", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bed4301-9155-4c3e-b64d-2e01377057e3"],
 " and the following zero-centered list:"
}], "Text",
 CellChangeTimes->{{3.9294399242353773`*^9, 3.929439970115415*^9}, {
  3.929440000398734*^9, 3.929440082426811*^9}, {3.929440119293194*^9, 
  3.929440121213119*^9}, {3.929518569184698*^9, 3.929518569601443*^9}, {
  3.929518600351902*^9, 
  3.9295186024397917`*^9}},ExpressionUUID->"839138bd-5834-48e7-a35a-\
02d3a4d73838"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"convcoeffs", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"charfnprod", " ", 
       SuperscriptBox["z", "4"]}], " ", ",", "z"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"convcoeffs", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.928835666643525*^9, 3.928835729958687*^9}, {
  3.928835781587989*^9, 3.928835816104151*^9}, {3.928841412672934*^9, 
  3.928841439463752*^9}, {3.928841747423244*^9, 3.928841879237912*^9}, {
  3.928841970199197*^9, 3.928841971955068*^9}, {3.9288420616383133`*^9, 
  3.928842170368587*^9}, {3.928842275377273*^9, 3.928842321254661*^9}, {
  3.9288433373336*^9, 3.928843357583253*^9}, {3.9291053314304867`*^9, 
  3.929105368548133*^9}, {3.929105527709672*^9, 3.929105531166029*^9}, {
  3.929439919483512*^9, 3.929439921267784*^9}, {3.929440064110744*^9, 
  3.929440107923448*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"fc50b002-2630-4ca8-8322-d1fe8a885d4a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "192"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "24"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "48"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"2", " ", 
           SqrtBox["6"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "24"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "96"], " ", 
        RowBox[{"(", 
         RowBox[{"72", "+", 
          RowBox[{"8", " ", 
           SqrtBox["6"]}], "-", 
          RowBox[{"4", " ", 
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "-", 
          RowBox[{"4", " ", 
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "24"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "48"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"2", " ", 
           SqrtBox["6"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "24"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "192"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.928842081310185*^9, 3.928842170726266*^9}, {
   3.928842278327949*^9, 3.928842321609696*^9}, {3.928843340935176*^9, 
   3.9288433584007587`*^9}, 3.928843899804861*^9, 3.928843930028338*^9, 
   3.928844051752718*^9, {3.929105357192143*^9, 3.929105369177505*^9}, 
   3.929105531584475*^9, 3.9294399223705397`*^9, {3.929440064403727*^9, 
   3.9294401224867783`*^9}, 3.929517056131875*^9, {3.9295185954202127`*^9, 
   3.929518603403113*^9}, 3.9295198958132553`*^9},
 CellLabel->
  "Out[77]//MatrixForm=",ExpressionUUID->"2f81e566-e805-4882-b30e-\
4140a9225b1d"]
}, Open  ]],

Cell[TextData[{
 "Let' s  assume that the coherent light amplitude is real an positive; then ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[LongEqual]", 
         SqrtBox[
          StyleBox["a", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma=\\sqrt{a}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2eed41ae-af70-481b-9e84-eb565d3e2b35"],
 " and the tails of the resulting ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9495d40-9576-4ca1-b39a-b965cb8389f1"],
 " determine feasibility of the state extraction. The state can be extracted \
if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["k", "TI"]], "\[LongEqual]", 
         StyleBox["p", "TI"], 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"]], "+", 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             StyleBox["p", "TI"]}], ")"}], 
         SubscriptBox[
          StyleBox["D", "TI"], 
          StyleBox["k", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "C_k=p P_k +(1-p) D_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a24f04d0-a035-4aa2-9143-dbdfe1102a14"],
 ", with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"0", "\[LessEqual]", 
         StyleBox["p", "TI"], "\[LessEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "0\\le p \\le 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c40ba93d-a7bf-45be-b2e6-d63c86ce6a56"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["D", "TI"], 
          StyleBox["k", "TI"]], "\[GreaterEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D_k\\ge 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e0dd3567-5498-4e27-808f-249f4bcca877"],
 ": the extraction succeeds with probability ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["p", "TI"], TraditionalForm], "errors" -> {}, "input" -> "p", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a9771112-138e-48ac-8f8d-10f27bdbfda8"],
 ", and with probability ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{"1", "-", 
           StyleBox["p", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(1-p)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4d93ca64-d5d0-46b4-8d07-b03632afd3e3"],
 " a state corresponding to the probability distribution ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["D", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "D_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f77c15eb-908d-48c3-a820-31c715a11dda"],
 " is prepared. This is possible if the tails of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a0aa690b-7158-45e7-abe8-4edbb1d78b4c"],
 " (variable ",
 StyleBox["Pk",
  FontWeight->"Bold"],
 ") fall off at least as quickly as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "C_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d67eb68-2c34-4575-a8e2-530a2724b7dc"],
 ". Here we calculate the the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "44eb9b63-c4a5-4079-bb80-c34081cd8638"],
 " coefficients."
}], "Text",
 CellChangeTimes->{{3.929440172695979*^9, 3.9294401964154863`*^9}, {
  3.929440291327694*^9, 3.929440325923628*^9}, {3.929440369218334*^9, 
  3.929440375667289*^9}, {3.9294405277125*^9, 3.9294406175060883`*^9}, {
  3.929440672162531*^9, 3.929440735283312*^9}, {3.929518623221471*^9, 
  3.9295186724957657`*^9}},ExpressionUUID->"0d28ae4a-153b-45de-b2bf-\
f7e739fe95cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"convexpr", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"convcoeffs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"\[Gamma]", "->", 
          SqrtBox["a"]}]}], ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{"a", ">", "0"}], "}"}]}]}], "]"}], 
      RowBox[{"DiscreteDelta", "[", 
       RowBox[{"k", "+", "i", "-", "5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "convcoeffs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cks", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Ck", "/.", 
      RowBox[{"\[Gamma]", "->", 
       SqrtBox["a"]}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"a", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pk", "=", 
   RowBox[{
    RowBox[{"DiscreteConvolve", "[", 
     RowBox[{"Cks", ",", "convexpr", ",", "k", ",", "l"}], "]"}], "/.", 
    RowBox[{"l", "->", "k"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928842437144192*^9, 3.928842495537055*^9}, {
   3.9291053916217403`*^9, 3.929105394720165*^9}, {3.929440199321819*^9, 
   3.9294402815884933`*^9}, 3.929440347106402*^9, {3.929440462931896*^9, 
   3.929440541520206*^9}, 3.929517364817901*^9, {3.929518894225994*^9, 
   3.9295189341846037`*^9}, {3.929519016238762*^9, 3.929519020214203*^9}, {
   3.929519132540462*^9, 3.9295191340387497`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"d6706272-bcd4-49dc-9cf3-36acabaf1920"],

Cell[TextData[{
 "Asymptotically (for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "k\\rightarrow\\infty", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3a3a5ef7-ffb0-49b7-ae4c-905e6cfa8cad"],
 "), the Bessel function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], "(", 
         StyleBox["a", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bcce534-c5eb-4cc5-994a-5bdea9f2cdfd"],
 " has the expansion of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           StyleBox["a", "TI"], ")"}], "\[TildeTilde]", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["a", "TI"], "/", "2"}], ")"}], 
           StyleBox["k", "TI"]], 
          RowBox[{
            StyleBox["k", "TI"], "!"}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a) \\approx \\frac{(a/2)^k}{k!}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "318f4afb-5e0d-4e5b-bf00-120bae8b12a9"],
 "(Appendix B of [1], Eq. B.47). Thus, the ratio of tails can be calculated: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["P", "TI"], 
             StyleBox["k", "TI"]], "(", 
            RowBox[{
              RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
              StyleBox["a", "TI"]}], ")"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["C", "TI"], 
             StyleBox["k", "TI"]], "(", 
            StyleBox["a", "TI"], ")"}]], "\[Rule]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{P_k ((1-\\varepsilon)a)}{C_k(a)}\\rightarrow 0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "557cc109-72b8-4d02-8ac4-45027acbb1d4"],
 " with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "k\\rightarrow \\infty", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "098ef6ea-8786-4e1b-910a-aba8df745e45"],
 " if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Epsilon]", ">", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\varepsilon>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bdec13e-2def-4f90-a8c0-552e94e52b0a"],
 ". Therefore, a state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         SuperscriptBox["\[Gamma]", "\[Prime]"], "\[RightAngleBracket]", 
         "\[CircleTimes]", "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", "\[Psi]", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma' \\rangle \\otimes \\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "421aac57-eabd-4391-bca0-f00abb03ec8b"],
 " can be extracted from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert \\!\\!\\gamma\\rangle \\otimes \\lvert\\!\\!0\\rangle", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "acfc132d-06e5-4e58-9f33-e23b1d131da5"],
 " for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Gamma]", "\[Prime]"], "<", "\[Gamma]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\gamma'<\\gamma", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fae5bce1-755b-4bba-95f4-fce613e6bfe1"],
 " with nonzero probability: one has to sacrifice arbitrarily small amplitude \
of the input coherent state in order to extract the end state."
}], "Text",
 CellChangeTimes->{{3.929440782218281*^9, 3.929440785603823*^9}, {
  3.929440865280184*^9, 3.929440871268714*^9}, {3.9295170681442337`*^9, 
  3.929517081216177*^9}, {3.9295173730035973`*^9, 3.929517415332082*^9}, {
  3.929517544270033*^9, 3.929517550062297*^9}, {3.929517987710252*^9, 
  3.929517989072079*^9}, {3.929518021288886*^9, 3.929518063280748*^9}, {
  3.929518102193203*^9, 3.929518177137145*^9}, {3.929518240408703*^9, 
  3.929518311960938*^9}, {3.9295188335203333`*^9, 3.92951888050786*^9}, {
  3.929520777719838*^9, 
  3.929520791721651*^9}},ExpressionUUID->"34025c3b-37e3-4d4c-8880-\
241a7d4649a5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BesselIasymp", "[", 
    RowBox[{"k_", ",", "a_"}], "]"}], ":=", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", " ", 
      RowBox[{"a", "/", "2"}], ")"}], "k"], 
    RowBox[{"k", "!"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ckasymp", "=", 
   RowBox[{
    RowBox[{"BesselIasymp", "[", 
     RowBox[{"k", ",", "a"}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", "a"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pkasymp", "=", 
   RowBox[{
    RowBox[{"DiscreteConvolve", "[", 
     RowBox[{"Ckasymp", ",", "convexpr", ",", "k", ",", "l"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "a"}]}], ",", 
      RowBox[{"l", "->", "k"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Limit of \!\(\*SubscriptBox[\(P\), \(k\)]\)/\!\(\*SubscriptBox[\(C\), \
\(k\)]\) for k\[Rule]\[Infinity]: \>\"", ",", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{
      FractionBox["Pkasymp", 
       RowBox[{"Ckasymp", "\[IndentingNewLine]"}]], "//", "Expand"}], ",", 
     RowBox[{"k", "->", "\[Infinity]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Epsilon]", "<", "1"}], ",", 
        RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.928842937049304*^9, 3.9288430022443542`*^9}, {
   3.928843032596299*^9, 3.928843087615505*^9}, {3.928843143680833*^9, 
   3.928843150694783*^9}, {3.92884434001333*^9, 3.928844342397996*^9}, {
   3.928844396847191*^9, 3.9288444933514357`*^9}, 3.92884452844178*^9, 
   3.928844582857114*^9, 3.928844850266835*^9, {3.928844895487753*^9, 
   3.928844899714588*^9}, {3.928844932194846*^9, 3.928844948555367*^9}, {
   3.929105458692974*^9, 3.92910550213408*^9}, {3.92910554463015*^9, 
   3.929105544758781*^9}, {3.929105753410906*^9, 3.929105754553975*^9}, {
   3.929517592874148*^9, 3.929517681734695*^9}, {3.929517755002388*^9, 
   3.92951776099509*^9}, {3.929518037101331*^9, 3.929518038772575*^9}, {
   3.929518181748121*^9, 3.929518181885063*^9}, {3.929518220947361*^9, 
   3.929518231808968*^9}, 3.929518313900527*^9, {3.929518791554606*^9, 
   3.929518824192205*^9}, {3.929519024394299*^9, 3.929519048369509*^9}, {
   3.929519137825513*^9, 3.929519147456764*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"5339f98d-ff59-456a-8804-87087f315eea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Limit of \\!\\(\\*SubscriptBox[\\(P\\), \
\\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(C\\), \\(k\\)]\\) for \
k\[Rule]\[Infinity]: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[
  "Limit of \!\(\*SubscriptBox[\(P\), \(k\)]\)/\!\(\*SubscriptBox[\(C\), \
\(k\)]\) for k\[Rule]\[Infinity]: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.929519149295738*^9, 3.929519897441711*^9},
 CellLabel->
  "During evaluation of \
In[81]:=",ExpressionUUID->"78675956-ead8-4168-b315-4c45d8382bb0"]
}, Open  ]],

Cell["\<\
[1] Francesco Mainardi, Fractional Calculus and Waves in Linear \
Viscoelasticity, Francesco Mainardi\
\>", "Text",
 CellChangeTimes->{{3.929520681470402*^9, 
  3.929520727319387*^9}},ExpressionUUID->"beb3cffc-497f-43a1-b601-\
877c2b3c3e9b"]
},
WindowSize->{805.5, 851.25},
WindowMargins->{{-2.25, Automatic}, {Automatic, -22.5}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2526b19d-949c-4101-9ec6-f428d626e6ae"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 254, 6, 35, "Text",ExpressionUUID->"11a8116b-a7a3-404f-94f0-4110b7cf94c8"],
Cell[815, 28, 368, 7, 81, "Text",ExpressionUUID->"468b8d79-6b7d-4042-877c-a358d8d2fe81"],
Cell[1186, 37, 251, 5, 35, "Text",ExpressionUUID->"25439731-9b14-430c-8881-c1ba9dfdbd82"],
Cell[1440, 44, 5293, 134, 206, "Text",ExpressionUUID->"353e80a2-c3eb-4258-a6cf-e4beebfafee1"],
Cell[6736, 180, 3066, 64, 239, "Input",ExpressionUUID->"b9af32fb-3b0d-421c-bbbb-9173056c15a2"],
Cell[9805, 246, 723, 15, 127, "Text",ExpressionUUID->"b48d6638-1dea-49ff-a477-44cee38624cc"],
Cell[10531, 263, 7124, 189, 488, "Input",ExpressionUUID->"0473cb4d-5aa6-439f-a42b-b7026eeaec40"],
Cell[17658, 454, 2940, 69, 135, "Text",ExpressionUUID->"8fbd5220-25fb-431d-858e-adc7b93268ee"],
Cell[20601, 525, 1459, 40, 115, "Input",ExpressionUUID->"1fafb6b8-d35f-4851-9063-b6e1f54b3b04"],
Cell[22063, 567, 377, 7, 58, "Text",ExpressionUUID->"bd05db12-d219-4f48-88d2-4b9d37a4cba4"],
Cell[22443, 576, 410, 10, 31, "Input",ExpressionUUID->"925bc0ab-c9c7-4ee5-ab9e-21f479c1cb4e"],
Cell[22856, 588, 251, 5, 35, "Text",ExpressionUUID->"d3ce012f-b54d-4e1c-8579-c31a90c7844a"],
Cell[23110, 595, 1876, 46, 85, "Text",ExpressionUUID->"4b8aa022-6fa5-4f6b-925f-ee2390c93409"],
Cell[24989, 643, 718, 21, 31, "Input",ExpressionUUID->"c734449c-f6bd-4297-bb6c-c318eb50541d"],
Cell[25710, 666, 1154, 28, 83, "Text",ExpressionUUID->"f93d8e2c-402c-47cd-9e89-560b8705fc45"],
Cell[CellGroupData[{
Cell[26889, 698, 4305, 80, 72, "Input",ExpressionUUID->"f3fa0051-3ad0-4c1a-8fc5-36e6e57cd460"],
Cell[31197, 780, 3415, 104, 161, "Output",ExpressionUUID->"7b2dac48-11b4-46cf-9fc3-56e69c6aa87e"]
}, Open  ]],
Cell[34627, 887, 1022, 25, 41, "Text",ExpressionUUID->"7c124203-b043-4588-abb1-a5ed70085bf1"],
Cell[35652, 914, 320, 8, 29, "Input",ExpressionUUID->"e1288059-4795-4b91-960b-8fd7528c39eb"],
Cell[35975, 924, 339, 7, 58, "Text",ExpressionUUID->"cd976194-c723-47a7-88b9-e76026365ed4"],
Cell[CellGroupData[{
Cell[36339, 935, 1847, 45, 154, "Input",ExpressionUUID->"d3d75803-7d52-4103-aa44-45a779fd62f7"],
Cell[CellGroupData[{
Cell[38211, 984, 904, 20, 23, "Print",ExpressionUUID->"c12c6479-6b18-4c3d-b4c6-98e5e2ba6cc1"],
Cell[39118, 1006, 711, 16, 23, "Print",ExpressionUUID->"bb0f6dff-8a65-4397-b47d-25a495d2744a"]
}, Open  ]]
}, Open  ]],
Cell[39856, 1026, 991, 24, 37, "Text",ExpressionUUID->"ff9523a3-24aa-41de-b148-b2c3615af9be"],
Cell[40850, 1052, 250, 5, 35, "Text",ExpressionUUID->"bb0f9ace-c590-4e13-a749-ed52fa08fb6b"],
Cell[41103, 1059, 707, 20, 37, "Text",ExpressionUUID->"d8b6e969-b2dd-46da-af83-c46c4f6d0a14"],
Cell[41813, 1081, 515, 15, 77, "Input",ExpressionUUID->"45308b44-34a9-43e3-9b65-d4add5083661"],
Cell[42331, 1098, 706, 16, 60, "Text",ExpressionUUID->"dd45bd92-90f3-4531-a081-17570ad8ca7d"],
Cell[CellGroupData[{
Cell[43062, 1118, 4978, 136, 239, "Input",ExpressionUUID->"f1549c00-d3c4-4eb4-852b-3b3c996f8b5d"],
Cell[CellGroupData[{
Cell[48065, 1258, 1734, 43, 39, "Print",ExpressionUUID->"a3bc8f44-13a5-4728-a426-4f0c379480a8"],
Cell[49802, 1303, 2865, 71, 112, "Print",ExpressionUUID->"019644c5-a39b-485c-b381-f3fa5db2b139"]
}, Open  ]]
}, Open  ]],
Cell[52694, 1378, 1499, 38, 97, "Text",ExpressionUUID->"b5de8e3a-0a6f-40b4-a9bd-9448c1aade7f"],
Cell[54196, 1418, 445, 7, 29, "Input",ExpressionUUID->"695ad47f-4b6c-4840-be2c-510ccd93fac5"],
Cell[CellGroupData[{
Cell[54666, 1429, 1787, 38, 143, "Input",ExpressionUUID->"e66bfa79-8520-4ec8-bf6f-b0a3ba4c9df3"],
Cell[56456, 1469, 18319, 347, 221, "Output",ExpressionUUID->"ee909cb4-6f49-4453-8bc1-5c1375cdc856"]
}, Open  ]],
Cell[74790, 1819, 1615, 39, 97, "Text",ExpressionUUID->"c0c1408e-944f-435c-a93f-7a3f64888b94"],
Cell[CellGroupData[{
Cell[76430, 1862, 2514, 61, 268, "Input",ExpressionUUID->"182858f8-3e46-436e-86a2-509929521696"],
Cell[78947, 1925, 16509, 318, 255, "Output",ExpressionUUID->"f0baecfd-c851-4218-b287-d3701dbd3825"]
}, Open  ]],
Cell[95471, 2246, 222, 4, 35, "Text",ExpressionUUID->"85797ec8-37bd-41dc-907d-70e23204ed2d"],
Cell[95696, 2252, 5193, 110, 241, "Text",ExpressionUUID->"9ca9269b-87b5-4409-a84b-b69961ff3699"],
Cell[100892, 2364, 3978, 111, 154, "Input",ExpressionUUID->"9f936469-8256-4b4d-bcc0-73799fc82387"],
Cell[104873, 2477, 372, 12, 58, "Text",ExpressionUUID->"4850de06-7b2c-4f4f-8f20-ce44629c60d6"],
Cell[CellGroupData[{
Cell[105270, 2493, 179, 2, 29, "Input",ExpressionUUID->"609dcc98-0a9d-4156-950d-eb2ba7f9a006"],
Cell[105452, 2497, 3248, 102, 161, "Output",ExpressionUUID->"eae00e4a-6f7d-426c-b22a-9178104ae1f1"]
}, Open  ]],
Cell[108715, 2602, 3024, 69, 161, "Text",ExpressionUUID->"b47f42d5-246b-4ad2-8c25-bea0a0c2437f"],
Cell[CellGroupData[{
Cell[111764, 2675, 1585, 47, 164, "Input",ExpressionUUID->"26c656fe-df68-4f3d-a245-f1fc929c23b4"],
Cell[CellGroupData[{
Cell[113374, 2726, 520, 11, 23, "Print",ExpressionUUID->"5b6c5c09-2969-4924-a4ef-35c510733dbc"],
Cell[113897, 2739, 1349, 40, 132, "Print",ExpressionUUID->"4bb22d0b-7cc2-4cd1-82e6-ae7f0e93215b"],
Cell[115249, 2781, 1798, 43, 149, "Print",ExpressionUUID->"7e2b3d41-8e79-4d9f-94e8-6e0db749cba9"]
}, Open  ]]
}, Open  ]],
Cell[117074, 2828, 204, 3, 35, "Text",ExpressionUUID->"28a49835-5a16-4645-b881-67a2d25990fb"],
Cell[CellGroupData[{
Cell[117303, 2835, 1951, 54, 170, "Input",ExpressionUUID->"eea2a739-1737-455e-8e17-b0f9f6d3867e"],
Cell[119257, 2891, 1973, 50, 109, "Output",ExpressionUUID->"f494c898-63c6-4c45-977a-12eee3775985"]
}, Open  ]],
Cell[121245, 2944, 583, 15, 47, "Text",ExpressionUUID->"2877c0e7-23c8-42e5-8f11-55f88b7bdcc6"],
Cell[CellGroupData[{
Cell[121853, 2963, 1444, 34, 143, "Input",ExpressionUUID->"208af341-3a27-414f-870d-b7f49091e66d"],
Cell[123300, 2999, 17834, 339, 267, "Output",ExpressionUUID->"f8b038f8-0caf-47a7-81ee-4a88c6eec59c"]
}, Open  ]],
Cell[141149, 3341, 288, 7, 35, "Text",ExpressionUUID->"9171b97e-9ab2-4a74-b702-729924f50017"],
Cell[CellGroupData[{
Cell[141462, 3352, 2188, 56, 248, "Input",ExpressionUUID->"02e14d07-6722-480e-8116-e623907e891b"],
Cell[143653, 3410, 12897, 257, 240, "Output",ExpressionUUID->"f141961e-040b-4fd3-aad0-f5d37d63d95e"]
}, Open  ]],
Cell[156565, 3670, 1110, 27, 85, "Text",ExpressionUUID->"3c0058f5-616b-43e9-9a55-a8eae74ad4d9"],
Cell[CellGroupData[{
Cell[157700, 3701, 1164, 35, 146, "Input",ExpressionUUID->"cb5b2296-32bc-43e5-bb22-a932ec3c9538"],
Cell[158867, 3738, 1488, 38, 53, "Print",ExpressionUUID->"df38315b-61e2-4dfd-a69f-3884b6c6c417"]
}, Open  ]],
Cell[160370, 3779, 1420, 30, 131, "Text",ExpressionUUID->"2dae0297-3c3e-4403-b2b7-3db2fa8635df"],
Cell[CellGroupData[{
Cell[161815, 3813, 1440, 40, 72, "Input",ExpressionUUID->"5ebe5836-e604-4a96-96a9-d74d3ee56230"],
Cell[163258, 3855, 1843, 52, 101, "Output",ExpressionUUID->"1da4d48d-1f77-496d-9526-c4a305b3e352"]
}, Open  ]],
Cell[165116, 3910, 292, 4, 35, "Text",ExpressionUUID->"2eeb011a-dcfa-4c51-9dd8-1043366114fd"],
Cell[CellGroupData[{
Cell[165433, 3918, 2002, 55, 177, "Input",ExpressionUUID->"6c09b3d5-8cb2-4a16-b968-9b4ded5c5eb1"],
Cell[CellGroupData[{
Cell[167460, 3977, 730, 18, 41, "Print",ExpressionUUID->"8c7cbd38-d372-4cbd-8f3d-f625ef83ae50"],
Cell[168193, 3997, 1123, 29, 50, "Print",ExpressionUUID->"b1192a45-a3f4-423f-9a8a-4325e839e8b4"],
Cell[169319, 4028, 639, 15, 26, "Print",ExpressionUUID->"5563c9a6-ed27-40e6-969f-d062adefc87c"]
}, Open  ]],
Cell[169973, 4046, 20634, 402, 257, "Output",ExpressionUUID->"94437d0b-8d18-477e-82e2-19b3cfc7e446"]
}, Open  ]],
Cell[190622, 4451, 209, 4, 35, "Text",ExpressionUUID->"6f743431-7967-4419-b533-60392802e628"],
Cell[190834, 4457, 3290, 79, 183, "Text",ExpressionUUID->"477af2e5-eed7-47ee-90ba-3bb6eff880be"],
Cell[CellGroupData[{
Cell[194149, 4540, 539, 16, 29, "Input",ExpressionUUID->"ca0732f6-37bc-48a1-a3d7-047171f1c90d"],
Cell[194691, 4558, 997, 29, 80, "Output",ExpressionUUID->"a5f4e896-cafd-4ddd-bc65-b34bbf91fd99"]
}, Open  ]],
Cell[195703, 4590, 10834, 268, 395, "Text",ExpressionUUID->"e39aa447-bbab-44ae-b8e1-3ffcda782ec1"],
Cell[206540, 4860, 8466, 256, 565, "Input",ExpressionUUID->"7f765123-f10d-4ce3-9553-995633c30e81"],
Cell[215009, 5118, 3427, 82, 134, "Text",ExpressionUUID->"5254597e-d0ab-4e49-a673-c469d2754bb2"],
Cell[218439, 5202, 7036, 183, 393, "Input",ExpressionUUID->"6d9dba03-a33a-475b-9169-89547d2fb890"],
Cell[225478, 5387, 1317, 31, 83, "Text",ExpressionUUID->"130d0ac1-556b-4f33-a082-644e1d3f4d13"],
Cell[CellGroupData[{
Cell[226820, 5422, 662, 17, 51, "Input",ExpressionUUID->"bf5ded0b-f9a8-427c-9293-a13e3c7e66c8"],
Cell[227485, 5441, 5319, 154, 332, "Output",ExpressionUUID->"50328a66-8916-4420-a3b0-40820274ba65"]
}, Open  ]],
Cell[232819, 5598, 3040, 71, 124, "Text",ExpressionUUID->"96eb2e9c-435b-4da2-ba6f-6cce03e83b92"],
Cell[CellGroupData[{
Cell[235884, 5673, 2492, 60, 152, "Input",ExpressionUUID->"b4bb6867-fd32-4a33-aa04-98bed124fbc6"],
Cell[238379, 5735, 1056, 21, 49, "Output",ExpressionUUID->"a73f96b4-1b73-4adb-abca-024f98ca7a75"],
Cell[239438, 5758, 1121, 21, 31, "Print",ExpressionUUID->"e0f2a467-560c-4993-8011-d619f5139b2b"]
}, Open  ]],
Cell[240574, 5782, 1390, 38, 60, "Text",ExpressionUUID->"71cab039-3de7-40a2-a986-856847ad4839"],
Cell[CellGroupData[{
Cell[241989, 5824, 939, 22, 75, "Input",ExpressionUUID->"e8fdb5b9-f07c-46f2-b00a-0b73aadb0691"],
Cell[242931, 5848, 4787, 152, 299, "Output",ExpressionUUID->"4236b0ac-11ae-454d-81bf-7970192dc6be"]
}, Open  ]],
Cell[247733, 6003, 2381, 63, 82, "Text",ExpressionUUID->"839138bd-5834-48e7-a35a-02d3a4d73838"],
Cell[CellGroupData[{
Cell[250139, 6070, 1007, 19, 52, "Input",ExpressionUUID->"fc50b002-2630-4ca8-8322-d1fe8a885d4a"],
Cell[251149, 6091, 4729, 142, 256, "Output",ExpressionUUID->"2f81e566-e805-4882-b30e-4140a9225b1d"]
}, Open  ]],
Cell[255893, 6236, 5019, 131, 138, "Text",ExpressionUUID->"0d28ae4a-153b-45de-b2bf-f7e739fe95cf"],
Cell[260915, 6369, 1691, 45, 112, "Input",ExpressionUUID->"d6706272-bcd4-49dc-9cf3-36acabaf1920"],
Cell[262609, 6416, 5442, 133, 153, "Text",ExpressionUUID->"34025c3b-37e3-4d4c-8880-241a7d4649a5"],
Cell[CellGroupData[{
Cell[268076, 6553, 2527, 59, 187, "Input",ExpressionUUID->"5339f98d-ff59-456a-8804-87087f315eea"],
Cell[270606, 6614, 538, 12, 23, "Print",ExpressionUUID->"78675956-ead8-4168-b315-4c45d8382bb0"]
}, Open  ]],
Cell[271159, 6629, 251, 6, 35, "Text",ExpressionUUID->"beb3cffc-497f-43a1-b601-877c2b3c3e9b"]
}
]
*)

