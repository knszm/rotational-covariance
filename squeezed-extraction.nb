(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    287629,       6882]
NotebookOptionsPosition[    277007,       6722]
NotebookOutlinePosition[    277458,       6739]
CellTagsIndexPosition[    277415,       6736]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Interferometric properties of the state extractable via an operation \
commuting with the interferometer\
\>", "Title",
 CellChangeTimes->{{3.929095994227631*^9, 3.929096094791791*^9}, {
  3.929607743287281*^9, 
  3.929607744502034*^9}},ExpressionUUID->"11a8116b-a7a3-404f-94f0-\
4110b7cf94c8"],

Cell[TextData[{
 "Supplementary material to quant-ph:2401.06064",
 StyleBox["\nK. Szymanski, F. Otto, 2024",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.929607680954829*^9, 3.9296076931090593`*^9}, {
  3.929607728278699*^9, 
  3.9296077559108047`*^9}},ExpressionUUID->"d0b994b3-16be-4731-9d24-\
871a0127f604"],

Cell["\<\
In this notebook we will present calculations involving the properties of a \
(0+2)-photon approximation to squeezed vacuum, and show that it can be \
extracted using operations commuting with a balanced interferometer.\
\>", "Text",
 CellChangeTimes->{{3.929096099624773*^9, 
  3.92909618664589*^9}},ExpressionUUID->"468b8d79-6b7d-4042-877c-\
a358d8d2fe81"],

Cell[TextData[StyleBox["Matrices  definition",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232920600617*^9, 3.928232926079948*^9}, 
   3.928233160782165*^9, 
   3.92909609801503*^9},ExpressionUUID->"25439731-9b14-430c-8881-\
c1ba9dfdbd82"],

Cell[TextData[{
 "In the Heisenberg picture, one can interpret the action of passive optical \
elements as modifying the annihilation/creation operators with matrices. The \
output annihilation/creation operators are described as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              SubscriptBox[
               OverscriptBox[
                StyleBox["b", "TI"], "^"], "1"], ",", "\[Ellipsis]", ",", 
              SubscriptBox[
               OverscriptBox[
                StyleBox["b", "TI"], "^"], 
               StyleBox["n", "TI"]], ",", 
              SubsuperscriptBox[
               StyleBox["b", "TI"], "1", "\[Dagger]"], ",", "\[Ellipsis]", 
              ",", 
              SubsuperscriptBox[
               StyleBox["b", "TI"], 
               StyleBox["n", "TI"], "\[Dagger]"]}], ")"}], 
          StyleBox["T", "TI"]], "\[LongEqual]", 
         StyleBox["U", "TI"], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              SubscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], "1"], ",", "\[Ellipsis]", ",", 
              SubsuperscriptBox[
               OverscriptBox[
                StyleBox["a", "TI"], "^"], 
               StyleBox["n", "TI"], "\[Prime]"], ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], "1", "\[Dagger]"], ",", "\[Ellipsis]", 
              ",", 
              SubsuperscriptBox[
               StyleBox["a", "TI"], 
               StyleBox["n", "TI"], "\[Dagger]"]}], ")"}], 
          StyleBox["T", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\hat b_1, \\ldots, \\hat b_n, b^\\dagger_1, \\ldots, \
b^\\dagger_n)^T=U (\\hat a_1, \\ldots, \\hat a'_n, a^\\dagger_1, \\ldots, \
a^\\dagger_n)^T", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f3749cf2-e3d6-4652-be40-3e3a78ce6334"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["U", "TI"], TraditionalForm], "errors" -> {}, "input" -> "U", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "50c3659c-7a50-4f6b-b71e-86ddc32e8188"],
 " is an unitary operator describing the passive element. In the case of two \
modes, the following unitaries acting on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubsuperscriptBox[
            StyleBox["a", "TI"], "1", "\[Dagger]"], ",", 
           SubsuperscriptBox[
            StyleBox["a", "TI"], "2", "\[Dagger]"]}], ")"}], TraditionalForm],
      "errors" -> {}, "input" -> "(a_1, a_2, a_1^\\dagger, a_2^\\dagger)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfce391b-9ea3-4730-8262-aafa02e712c8"],
 " describe the two basic elements: ",
 StyleBox["beamsplitter",
  FontSlant->"Italic"],
 " (matrix ",
 StyleBox["B",
  FontWeight->"Bold"],
 "), and ",
 StyleBox["balanced phase shift",
  FontSlant->"Italic"],
 " (matrix ",
 StyleBox["P",
  FontWeight->"Bold"],
 "). \nWe are using the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"4", "\[Cross]", "4"}], TraditionalForm], "errors" -> {}, 
     "input" -> "4\\times 4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d0fe8f09-94b8-4d0d-858c-0e7afe367cec"],
 " matrices for easier calculations; this description also allows for easy \
generalization to squeezing operations. For ",
 StyleBox["passive",
  FontSlant->"Italic"],
 " elements, the matrices split into diagonal blocks as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "\[LongEqual]", 
         StyleBox["V", "TI"], "\[CirclePlus]", 
         SuperscriptBox[
          StyleBox["V", "TI"], "*"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "U=V\\oplus V^*", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "276d5557-add3-4d2d-853c-e1244765a3f8"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["V", "TI"], TraditionalForm], "errors" -> {}, "input" -> "V", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7862803f-7c0e-46db-a227-773993094cfd"],
 " acts on the annihilation operators and the conjugate matrix ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["V", "TI"], "*"], TraditionalForm], "errors" -> {}, "input" -> 
     "V^*", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "daa772ac-e4df-4bb5-bc18-539a3bcdd93c"],
 "acts on creation operators."
}], "Text",
 CellChangeTimes->{{3.929096191305237*^9, 3.929096226719604*^9}, {
  3.929096259456402*^9, 3.9290963936186*^9}, {3.92909645395444*^9, 
  3.929096803300857*^9}},ExpressionUUID->"353e80a2-c3eb-4258-a6cf-\
e4beebfafee1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"B", "=", 
    FractionBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "\[ImaginaryI]", "0", "0"},
        {"\[ImaginaryI]", "1", "0", "0"},
        {"0", "0", "1", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"0", "0", 
         RowBox[{"-", "\[ImaginaryI]"}], "1"}
       }], "\[NoBreak]", ")"}], 
     SqrtBox["2"]]}], ";"}], " ", 
  RowBox[{"(*", "beamsplitter", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "]"}], "0", "0", "0"},
       {"0", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}], "]"}], "0", 
        "0"},
       {"0", "0", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}], "]"}], "0"},
       {"0", "0", "0", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"balanced", " ", "phase", " ", "shift"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.87750029233671*^9, 3.8775003766541557`*^9}, {
   3.877500410288145*^9, 3.877500478263955*^9}, {3.877500529280114*^9, 
   3.87750064621939*^9}, {3.877502385964789*^9, 3.87750239758429*^9}, {
   3.877502509199201*^9, 3.877502517810066*^9}, {3.8775025597657213`*^9, 
   3.877502564352618*^9}, {3.877502674560464*^9, 3.8775026900187173`*^9}, {
   3.877502996468659*^9, 3.877502998246778*^9}, {3.877503034141143*^9, 
   3.877503050670691*^9}, {3.8775107544139986`*^9, 3.87751077750244*^9}, {
   3.877510854272921*^9, 3.877510873073705*^9}, 3.877535535012128*^9, {
   3.928228892046017*^9, 3.9282289059412937`*^9}, {3.928229008741539*^9, 
   3.9282290359004393`*^9}, 3.928233730307143*^9, {3.928237187489324*^9, 
   3.928237189016533*^9}, {3.928237587433998*^9, 3.9282376194989*^9}, {
   3.928237767649231*^9, 3.9282377935385857`*^9}, {3.928237835490532*^9, 
   3.928237928928327*^9}, {3.9282379975607986`*^9, 3.92823805180586*^9}, {
   3.928238084572597*^9, 3.928238145557184*^9}, {3.928238705794774*^9, 
   3.928238770690138*^9}, {3.928394556640839*^9, 3.928394591210416*^9}, {
   3.928394623987451*^9, 3.928394626690456*^9}, {3.928394717812331*^9, 
   3.92839477788388*^9}, {3.928395992052342*^9, 3.928395994314287*^9}, {
   3.928396127117742*^9, 3.928396131904269*^9}, {3.92882945021821*^9, 
   3.928829486936781*^9}, {3.92884525361839*^9, 3.928845282602647*^9}, {
   3.928845361994525*^9, 3.928845362170163*^9}, {3.928846582639616*^9, 
   3.928846611816808*^9}, 3.929094630914456*^9, {3.929096234138125*^9, 
   3.929096244041649*^9}, 3.929096490164065*^9, {3.929096717852838*^9, 
   3.929096730420252*^9}, 3.929096813125227*^9, {3.92960574898204*^9, 
   3.929605760571589*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b9af32fb-3b0d-421c-bbbb-9173056c15a2"],

Cell[TextData[{
 "We will manipulate expressions involving complex products of annihilation \
and creation operators with the internal ",
 StyleBox["Dot",
  FontWeight->"Bold"],
 " function (used in Wolfram language to denote the standard matrix product), \
and they are not automatically handled with Mathematica. The following \
function defines rules simplifying such expressions: removal of numerical \
factors outside of the dot product, commutation rules, and mode index \
ordering."
}], "Text",
 CellChangeTimes->{{3.9290968170707808`*^9, 3.929096873283569*^9}, {
   3.929096913332741*^9, 3.929097134974153*^9}, 3.929102882581688*^9, 
   3.9296078263273287`*^9},ExpressionUUID->"b48d6638-1dea-49ff-a477-\
44cee38624cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"simprules", "[", 
     RowBox[{"order_", ":", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          RowBox[{"prefactor_", " ", "op_"}], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"id", ",", 
             SubscriptBox["a", "1"], ",", 
             SubscriptBox["A", "1"], ",", 
             SubscriptBox["a", "2"], ",", 
             SubscriptBox["A", "2"]}], "}"}], ",", "op"}], "]"}], ")"}]}], ":>", 
       RowBox[{"prefactor", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "op", ",", "ops2"}], "]"}]}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"move", " ", "non"}], "-", 
         RowBox[{"operator", " ", "prefactors", " ", 
          RowBox[{"outside", ".", " ", "a", ".", 
           RowBox[{"(", 
            RowBox[{"prefactor", " ", "b"}], ")"}]}]}]}], "=", 
        RowBox[{"prefactor", " ", 
         RowBox[{"a", ".", "b"}]}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          RowBox[{"prefactor_", " ", "op_"}], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"Head", "[", "op", "]"}], "==", "Dot"}]}], ":>", 
       RowBox[{"prefactor", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "op", ",", "ops2"}], "]"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"collapse", " ", "stacked", " ", "dot", " ", "products"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"a", ".", 
          RowBox[{"(", 
           RowBox[{"prefactor", " ", 
            RowBox[{"b", ".", "c"}]}], ")"}], ".", "d"}], "=", 
         RowBox[{"prefactor", " ", 
          RowBox[{"a", ".", "b", ".", "c", ".", "d"}]}]}]}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"ops1_", ",", "id", ",", "ops2_"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"collapse", " ", "identity", " ", "operators"}], ",", " ", 
        RowBox[{"\[Times]", "3"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"id", ",", "ops1_", ",", "ops2_"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"ops1_", ",", "ops2_", ",", "id"}], "]"}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", "ops2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"i", "==", "j"}]}], ":>", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", 
          SubscriptBox["A", "j"], ",", 
          SubscriptBox["a", "i"], ",", "ops2"}], "]"}], "+", 
        RowBox[{"Dot", "[", 
         RowBox[{"ops1", ",", "id", ",", "id", ",", "ops2"}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "creation", " ", "operators", " ", "to", " ", "the", " ",
          "left"}], ",", " ", 
        RowBox[{
        "adding", " ", "identity", " ", "due", " ", "to", " ", "commutation", 
         " ", "rules"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{"i", "!=", "j"}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["A", "j"], ",", 
         SubscriptBox["a", "i"], ",", "ops2"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "creation", " ", "ops", " ", "to", " ", "the", " ", 
         "left"}], " ", "-", " ", 
        RowBox[{
        "they", " ", "commute", " ", "for", " ", "different", " ", 
         "modes"}]}], "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["a", "i_"], ",", 
          SubscriptBox["a", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"order", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ">", 
         RowBox[{"order", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["a", "j"], ",", 
         SubscriptBox["a", "i"], ",", "ops2"}], "]"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "enforce", " ", "mode", " ", "index", " ", "ordering", " ", "for", 
         " ", "easier", " ", "calculations"}], ",", " ", 
        RowBox[{"\[Times]", "2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ops1___", ",", 
          SubscriptBox["A", "i_"], ",", 
          SubscriptBox["A", "j_"], ",", "ops2___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"order", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         RowBox[{"order", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ":>", 
       RowBox[{"Dot", "[", 
        RowBox[{"ops1", ",", 
         SubscriptBox["A", "j"], ",", 
         SubscriptBox["A", "i"], ",", "ops2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pref_", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          SubscriptBox["a", "i_"], ",", "id"}], "]"}]}], ":>", " ", 
       RowBox[{"pref", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"id", ",", 
          SubscriptBox["a", "i"]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "move", " ", "identity", " ", "operators", " ", "to", " ", "the", " ",
          "center"}], ",", " ", 
        RowBox[{
        "they", " ", "have", " ", "to", " ", "be", " ", "preserved", " ", 
         "for", " ", "easier", " ", "symbolic", " ", "calculations"}]}], 
       "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pref_", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{"id", ",", 
          SubscriptBox["A", "i_"]}], "]"}]}], ":>", " ", 
       RowBox[{"pref", " ", 
        RowBox[{"Dot", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", "id"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.929097139765477*^9, 3.929097447872237*^9}, 
   3.929513788527834*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"0473cb4d-5aa6-439f-a42b-b7026eeaec40"],

Cell[TextData[{
 "If the total expression is presented as sum of terms in the normal ordering \
(each term having form ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["a", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"], "\[Dagger]"], "\[Ellipsis]", 
         SubscriptBox[
          StyleBox["a", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], 
           StyleBox["k", "TI"]]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "a^\\dagger_{i_1} \\ldots a_{i_k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f92ce4f6-5f84-4860-81c9-c8d556b75b77"],
 "), only the terms containing ",
 StyleBox["identity operators alone",
  FontSlant->"Italic"],
 " contribute to the vacuum expectation value: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"0", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "|", 
             SubsuperscriptBox[
              StyleBox["a", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"], "\[Dagger]"], "\[Ellipsis]", 
             SubscriptBox[
              StyleBox["a", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], 
               StyleBox["k", "TI"]]], "|", "\[NegativeThinSpace]", 
             "\[NegativeThinSpace]", "0"}], "\[RightAngleBracket]"}], 
         "\[LongEqual]", "0"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle 0\\!\\!\\lvert a^\\dagger_{i_1} \\ldots a_{i_k} \\lvert\\!\\!0\
\\rangle=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b44c7cc-b01b-4c19-b663-fe2447d1d0c6"],
 ", but ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
           
           RowBox[{"0", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "|", 
             "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0"}], 
           "\[RightAngleBracket]"}], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\langle 0\\!\\! \\lvert\\!\\!0\\rangle = 1",
      "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ae1ac83b-d10c-4d26-b732-c86fba5a76da"],
 ". The following function defines the rules to simplify the terms (for \
specific mode ",
 StyleBox["indices",
  FontWeight->"Bold"],
 " \[Dash] later it will be useful to assume that e.g. mode 1 is in vacuum, \
but mode 2 is in a superposition of finitely many Fock states)",
 ", leaving only products of identity operators."
}], "Text",
 CellChangeTimes->{{3.929097449434989*^9, 3.9290976397304993`*^9}, {
  3.929097720338671*^9, 3.929097883123159*^9}, {3.929097922395061*^9, 
  3.929098009971851*^9}},ExpressionUUID->"8fbd5220-25fb-431d-858e-\
adc7b93268ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expvacuumrules", "[", 
     RowBox[{"indices_", ",", 
      RowBox[{"order_", ":", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"simprules", "[", "order", "]"}], "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pref_", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{"ops1__", ",", 
            SubscriptBox["a", "i_"]}], "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"indices", ",", "i"}], "]"}]}], ":>", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pref_", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{
            SubscriptBox["A", "i_"], ",", "ops1__"}], "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"indices", ",", "i"}], "]"}]}], ":>", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pref_", " ", 
         RowBox[{"id", ".", "id", ".", "id"}]}], ":>", 
        RowBox[{"pref", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{"id", ",", "id"}], "]"}]}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.929097442626733*^9, 3.929097442811807*^9}, {
   3.929097509868264*^9, 3.92909751037886*^9}, 3.929097570755053*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"1fafb6b8-d35f-4851-9063-b6e1f54b3b04"],

Cell["\<\
So, the final expression for vacuum expectation value is calculated by the \
following rule, turning identity operators into ones.\
\>", "Text",
 CellChangeTimes->{{3.929097563100377*^9, 3.929097565609479*^9}, {
  3.929097886608778*^9, 3.929097915346574*^9}, {3.9290980158833714`*^9, 
  3.929098045051982*^9}},ExpressionUUID->"bd05db12-d219-4f48-88d2-\
4b9d37a4cba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalizerules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pref_", " ", 
      RowBox[{"id", ".", "id"}]}], ":>", 
     RowBox[{"pref", " ", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.929097898171425*^9, 3.929097902563404*^9}, {
  3.929098047476344*^9, 3.929098047627878*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"925bc0ab-c9c7-4ee5-ab9e-21f479c1cb4e"],

Cell[TextData[StyleBox["Unsqueezed  light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232930022177*^9, 3.9282329334651337`*^9}, {
  3.928846934819381*^9, 
  3.928846935547585*^9}},ExpressionUUID->"d3ce012f-b54d-4e1c-8579-\
c31a90c7844a"],

Cell[TextData[{
 "First, let us calculate the phase determination error of an interferometer \
having coherent state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma \\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "073d0c89-c805-4b4e-87d5-f2ba17de11d5"],
 " as one of its inputs, while the second mode is in vacuum. For consistency, \
we want to use only the vacuum expectation values, and thus the first part is \
to perform the displacement operation ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["D", "TI"], "(", "\[Gamma]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D(\\gamma)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "99bdb5f8-bd69-4b1e-906d-b9e76efec6f3"],
 ", turning ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ae5b9034-db76-490c-bc49-3e85128781f5"],
 " into ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["a", "TI"], "1"], "+", "\[Gamma]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "a_1+\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "071ccaec-cd8e-43d5-a16d-af6a243eaa93"],
 ".\n",
 StyleBox["(In the code, the output annihilation/creation operators are \
denoted by the symbol ",
  FontSlant->"Italic"],
 StyleBox["b/\[Beta]",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[", respectively).",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.929098055629073*^9, 3.929098209060256*^9}, {
  3.929606793744047*^9, 
  3.929606848951034*^9}},ExpressionUUID->"4b8aa022-6fa5-4f6b-925f-\
ee2390c93409"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "1"], "+", 
      RowBox[{"\[Gamma]", " ", "id"}]}], ",", 
     SubscriptBox["a", "2"], ",", 
     RowBox[{
      SubscriptBox["A", "1"], "+", 
      RowBox[{
       RowBox[{"\[Gamma]", "\[Conjugate]"}], " ", "id"}]}], ",", 
     SubscriptBox["A", "2"]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.92909821126877*^9, 3.929098222323228*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"c734449c-f6bd-4297-bb6c-c318eb50541d"],

Cell[TextData[{
 "Then, the final modes at the interferometer output are modified by the \
matrices described above. Expectation value of the photon number difference \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["b", "TI"], "2", "\[Dagger]"], 
         SubscriptBox[
          StyleBox["b", "TI"], "2"], "-", 
         SubsuperscriptBox[
          StyleBox["b", "TI"], "1", "\[Dagger]"], 
         SubscriptBox[
          StyleBox["b", "TI"], "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "b^\\dagger_2 b_2-b^\\dagger_1 b_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d7f4daf-6d38-44fd-ad7e-c9f87a7c479f"],
 " at the interferometer output will be calculated from the following \
expression ",
 StyleBox["exprC",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929098224196476*^9, 3.92909825235671*^9}, {
  3.929098341124178*^9, 3.929098406213184*^9}, {3.929098518138268*^9, 
  3.929098548229991*^9}},ExpressionUUID->"f93d8e2c-402c-47cd-9e89-\
560b8705fc45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        SubscriptBox["b", "2"], ",", 
        SubscriptBox["\[Beta]", "1"], ",", 
        SubscriptBox["\[Beta]", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exprC", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Distribute", "[", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["\[Beta]", "2"], ")"}], ".", 
        RowBox[{"(", 
         SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
      RowBox[{"Distribute", "[", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["\[Beta]", "1"], ")"}], ".", 
        RowBox[{"(", 
         SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
    RowBox[{"simprules", "[", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.877510104926837*^9, 3.877510179645915*^9}, {
   3.877510308434112*^9, 3.8775103204758377`*^9}, {3.8775104264861603`*^9, 
   3.877510451439056*^9}, 3.877510726559623*^9, {3.877510782283139*^9, 
   3.877510790383659*^9}, {3.877510869450303*^9, 3.877510879391086*^9}, {
   3.877533654144614*^9, 3.877533655028832*^9}, {3.877535536701421*^9, 
   3.877535538099533*^9}, {3.877535608629103*^9, 3.877535647662274*^9}, {
   3.87753580266549*^9, 3.877535997757814*^9}, {3.877536067276531*^9, 
   3.877536074922817*^9}, {3.877536120330261*^9, 3.877536121315572*^9}, {
   3.877540239184128*^9, 3.8775402439447517`*^9}, {3.928228922870145*^9, 
   3.928228923642014*^9}, {3.928232576648427*^9, 3.928232603926406*^9}, 
   3.928232749688284*^9, {3.928233089478608*^9, 3.928233089945859*^9}, 
   3.928233168100402*^9, {3.928233440762369*^9, 3.928233453298933*^9}, {
   3.9282351788997183`*^9, 3.928235187746468*^9}, {3.928235258991047*^9, 
   3.928235291215637*^9}, {3.928235427819099*^9, 3.928235455681892*^9}, {
   3.92823684161922*^9, 3.928236843230812*^9}, {3.928237034855301*^9, 
   3.928237036295669*^9}, {3.928238249366626*^9, 3.928238249537783*^9}, {
   3.928394212504321*^9, 3.928394256363037*^9}, 3.928394286646654*^9, {
   3.928394322931553*^9, 3.928394359048991*^9}, {3.928396042900866*^9, 
   3.92839604413211*^9}, {3.928845172056117*^9, 3.92884517297189*^9}, {
   3.929091816236569*^9, 3.929091857006268*^9}, {3.929091942836211*^9, 
   3.929092032346127*^9}, {3.9290921700946198`*^9, 3.929092428835946*^9}, {
   3.929092472909183*^9, 3.9290926365906773`*^9}, {3.929092693866211*^9, 
   3.929092767104327*^9}, {3.9290927976202097`*^9, 3.9290928649372873`*^9}, {
   3.929092900344981*^9, 3.929092940490257*^9}, {3.929093008100308*^9, 
   3.9290930183541594`*^9}, {3.929093079637093*^9, 3.929093093665015*^9}, {
   3.929093131397019*^9, 3.929093178502696*^9}, {3.929093214388701*^9, 
   3.929093214989604*^9}, {3.929093257038352*^9, 3.929093346444541*^9}, {
   3.929093386603266*^9, 3.9290934008123693`*^9}, {3.929093438080965*^9, 
   3.929093515318161*^9}, 3.929093673983427*^9, {3.929093732885015*^9, 
   3.929093743339943*^9}, {3.9290937899549*^9, 3.929093822821428*^9}, {
   3.929093886602148*^9, 3.9290939125783*^9}, {3.929093944755136*^9, 
   3.929093949459553*^9}, {3.9290940309219093`*^9, 3.929094032137701*^9}, {
   3.92909406332516*^9, 3.9290940900377693`*^9}, {3.9290941645031643`*^9, 
   3.929094220451377*^9}, {3.929094298530089*^9, 3.929094336633998*^9}, {
   3.9290947734806843`*^9, 3.92909485611444*^9}, {3.929095003775914*^9, 
   3.929095009871474*^9}, {3.929095052449793*^9, 3.929095052823015*^9}, {
   3.929095171102938*^9, 3.929095207591297*^9}, {3.929095243968359*^9, 
   3.9290952709477262`*^9}, {3.929095681855893*^9, 3.929095682408023*^9}, 
   3.929096808457825*^9, 3.929097434771515*^9, {3.9290981311994743`*^9, 
   3.929098133111816*^9}, {3.92909825999158*^9, 3.9290983043035507`*^9}, {
   3.929098372045371*^9, 3.9290983762039013`*^9}, 3.9290984084341717`*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"f3fa0051-3ad0-4c1a-8fc5-36e6e57cd460"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Gamma]"}], " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"id", ".", "id"}]}], "-", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", "id"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.92909826299591*^9, 3.9290983314459743`*^9}, 
   3.929098376997556*^9, {3.929098409421619*^9, 3.929098415802911*^9}, 
   3.929098556463698*^9, 3.929102143911262*^9, 3.929102891904117*^9, 
   3.929434074520478*^9, 3.929515881355538*^9, 3.9295198536212683`*^9, 
   3.929605787269086*^9, 3.929606860666854*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"8cdb9ca8-9f7e-4bad-aafd-4c230e3e6fe8"]
}, Open  ]],

Cell[TextData[{
 "... while the variance of photon number difference depends on the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            SubsuperscriptBox[
             StyleBox["b", "TI"], "2", "\[Dagger]"], 
            SubscriptBox[
             StyleBox["b", "TI"], "2"], "-", 
            SubsuperscriptBox[
             StyleBox["b", "TI"], "1", "\[Dagger]"], 
            SubscriptBox[
             StyleBox["b", "TI"], "1"]}], ")"}], "2"], TraditionalForm], 
     "errors" -> {}, "input" -> "(b^\\dagger_2 b_2-b^\\dagger_1 b_1)^2", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "450e0335-07af-478b-abe0-974bf220e366"],
 " (too long to print out):"
}], "Text",
 CellChangeTimes->{{3.9290984177500763`*^9, 3.9290984683390007`*^9}, {
  3.929098566517588*^9, 
  3.9290985668798027`*^9}},ExpressionUUID->"7c124203-b043-4588-abb1-\
a5ed70085bf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr2C", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", 
      RowBox[{"exprC", ".", "exprC"}], "]"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"e1288059-4795-4b91-960b-8fd7528c39eb"],

Cell["\<\
The  expectation values of the photon number, as well as its second power, \
and the resulting variance are calculated here to be used later:\
\>", "Text",
 CellChangeTimes->{{3.929098475134253*^9, 3.929098509948094*^9}, {
  3.929098580647091*^9, 
  3.92909859195844*^9}},ExpressionUUID->"cd976194-c723-47a7-88b9-\
e76026365ed4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"firstmomCOH", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"exprC", "//.", 
        RowBox[{"expvacuumrules", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}], "//",
       "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"secmomCOH", "=", 
     RowBox[{
      RowBox[{"expr2C", "//.", 
       RowBox[{"expvacuumrules", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varCOH", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"secmomCOH", "-", 
         SuperscriptBox["firstmomCOH", "2"]}], "//", "Expand"}], "//", 
       "FullSimplify"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: \>\"", ",", 
     "firstmomCOH"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<variance of \!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\): \>\"", ",", "varCOH"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.928238177337919*^9, 3.9282381990114937`*^9}, {
   3.928238714854802*^9, 3.928238719395523*^9}, {3.92909286927872*^9, 
   3.929092885006557*^9}, {3.929092948217854*^9, 3.9290929615606194`*^9}, {
   3.9290930264409246`*^9, 3.929093029967545*^9}, {3.929094353870448*^9, 
   3.929094355806755*^9}, 3.929095209546673*^9, {3.929095275443971*^9, 
   3.929095280571444*^9}, {3.929098595734933*^9, 3.929098638064992*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d3d75803-7d52-4103-aa44-45a779fd62f7"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \\(2\\)]\\)-\
\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "\[Gamma]"}], " ", 
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}],
  SequenceForm[
  "\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: ", \
-$CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
   Cos[2 $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9290986225227213`*^9, 3.929098638373255*^9}, 
   3.929102146769012*^9, 3.929102895549313*^9, 3.929434078484003*^9, 
   3.929515883434529*^9, 3.9295198558831253`*^9, 3.929605790491744*^9, 
   3.92960687684489*^9},
 CellLabel->
  "During evaluation of \
In[79]:=",ExpressionUUID->"2224fe2d-4317-4dc0-a60c-7d68b3511e28"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"variance of \\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}],
  SequenceForm[
  "variance of \!\(\*SubscriptBox[\(N\), \(2\)]\)-\!\(\*SubscriptBox[\(N\), \
\(1\)]\): ", Abs[$CellContext`\[Gamma]]^2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9290986225227213`*^9, 3.929098638373255*^9}, 
   3.929102146769012*^9, 3.929102895549313*^9, 3.929434078484003*^9, 
   3.929515883434529*^9, 3.9295198558831253`*^9, 3.929605790491744*^9, 
   3.9296068768458853`*^9},
 CellLabel->
  "During evaluation of \
In[79]:=",ExpressionUUID->"d92ef6bb-03c1-406c-904a-d81220f267db"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "We recover the standard result that the variance is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[Gamma]", 
         SuperscriptBox["|", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\lvert \\gamma\\rvert^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a09f9ed-eeee-44a3-b739-bfad2333eae3"],
 " for the input coherent state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", "0", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\lvert\\!\\!0\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c458ca66-48f4-4989-8dc6-82485a3cecbe"],
 "."
}], "Text",
 CellChangeTimes->{{3.929098639039614*^9, 
  3.929098675550449*^9}},ExpressionUUID->"ff9523a3-24aa-41de-b148-\
b2c3615af9be"],

Cell[TextData[StyleBox["Squeezed light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928232948196589*^9, 3.9282329518692627`*^9}, {
  3.929095059585193*^9, 
  3.9290950615605793`*^9}},ExpressionUUID->"bb0f9ace-c590-4e13-a749-\
ed52fa08fb6b"],

Cell[TextData[{
 "If the originally vacuum input mode 2 is ",
 StyleBox["squeezed",
  FontSlant->"Italic"],
 ", the operators ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "2"], ",", 
         SubscriptBox[
          StyleBox["a", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "A_2, a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "86717686-348d-46b0-9b71-e5061206a5c7"],
 " are modified by the following matrix:"
}], "Text",
 CellChangeTimes->{{3.929098680648873*^9, 
  3.929098745975438*^9}},ExpressionUUID->"d8b6e969-b2dd-46da-af83-\
c46c4f6d0a14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       RowBox[{"Cosh", "[", "r", "]"}], "0", 
       RowBox[{"-", 
        RowBox[{"Sinh", "[", "r", "]"}]}]},
      {"0", "0", "1", "0"},
      {"0", 
       RowBox[{"-", 
        RowBox[{"Sinh", "[", "r", "]"}]}], "0", 
       RowBox[{"Cosh", "[", "r", "]"}]}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"45308b44-34a9-43e3-9b65-d4add5083661"],

Cell[TextData[{
 "The first mode is, as before, assumed to be coherent ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
         "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
          "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
      "\\lvert\\!\\!\\gamma\\rangle", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], "."}], TraditionalForm]],ExpressionUUID->
  "ac5a280b-8f11-43a5-926b-845788e001ac"],
 " We can calculate the expectation values using the same procedure:"
}], "Text",
 CellChangeTimes->{{3.929098749760459*^9, 
  3.929098806535581*^9}},ExpressionUUID->"dd45bd92-90f3-4531-a081-\
17570ad8ca7d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"S", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", 
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["A", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", 
      SubscriptBox["\[Beta]", "1"], ",", 
      SubscriptBox["\[Beta]", "2"]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"id", " ", "\[Gamma]"}], ",", "0", ",", 
      RowBox[{"id", " ", 
       RowBox[{"\[Gamma]", "\[Conjugate]"}]}], ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        SubscriptBox["b", "2"], ",", 
        SubscriptBox["\[Beta]", "1"], ",", 
        SubscriptBox["\[Beta]", "2"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exprS", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "2"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "1"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr2S", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"Distribute", "[", 
       RowBox[{"exprS", ".", "exprS"}], "]"}], "//.", 
      RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmomSQ", "=", 
   RowBox[{
    RowBox[{"exprS", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secmomSQ", "=", 
   RowBox[{
    RowBox[{"expr2S", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "/.", "finalizerules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varSQ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"secmomSQ", "-", 
       SuperscriptBox["firstmomSQ", "2"]}], "//", "Expand"}], "//", 
     "FullSimplify"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: \>\"", ",", 
   "firstmomSQ"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<variance of \!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\): \>\"", ",", "varSQ"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.877500623652169*^9, 3.877500733117751*^9}, {
   3.8775021644995537`*^9, 3.877502165675181*^9}, {3.877502813670136*^9, 
   3.877502815476026*^9}, {3.877503022159945*^9, 3.877503056071042*^9}, {
   3.877503095737109*^9, 3.877503097031745*^9}, {3.877533658243441*^9, 
   3.877533659499853*^9}, {3.928228988334676*^9, 3.92822899096591*^9}, {
   3.928232887702626*^9, 3.928232888001494*^9}, {3.928233055833056*^9, 
   3.928233071115608*^9}, 3.928233189180749*^9, {3.928233355594795*^9, 
   3.9282333567932043`*^9}, {3.928233512590671*^9, 3.928233516546321*^9}, {
   3.92823368953423*^9, 3.9282337433816*^9}, {3.928234906133181*^9, 
   3.928234954096624*^9}, {3.928236816609837*^9, 3.928236818862172*^9}, {
   3.928237078919482*^9, 3.928237080505129*^9}, {3.928238800735076*^9, 
   3.92823880157329*^9}, 3.9288295139734783`*^9, {3.929094369536067*^9, 
   3.929094414673563*^9}, {3.929094485551856*^9, 3.929094490366754*^9}, {
   3.929094903482718*^9, 3.9290949046636767`*^9}, 3.929096250878549*^9, {
   3.92909881480707*^9, 3.929098860512885*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"f1549c00-d3c4-4eb4-852b-3b3c996f8b5d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \\(2\\)]\\)-\
\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Gamma]"}], " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}]}]}],
  SequenceForm[
  "\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]: ", \
-$CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
    Cos[$CellContext`\[Theta]]^2 + $CellContext`\[Gamma] 
    Conjugate[$CellContext`\[Gamma]] Sin[$CellContext`\[Theta]]^2 + 
   Cos[$CellContext`\[Theta]]^2 Sinh[$CellContext`r]^2 - 
   Sin[$CellContext`\[Theta]]^2 Sinh[$CellContext`r]^2],
  Editable->False]], "Print",
 CellChangeTimes->{3.92909886355081*^9, 3.929434085624631*^9, 
  3.929515889679658*^9, 3.92951986329683*^9, 3.929605804075513*^9, 
  3.92960690234345*^9},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"2d2de66a-c8e2-439d-abdd-ef8e4af9107c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"variance of \\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[Gamma]", "2"], " ", 
     RowBox[{"Cosh", "[", "r", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
     RowBox[{"Sinh", "[", "r", "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "4"], "-", 
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"2", " ", "r"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sinh", "[", "r", "]"}], "2"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"2", " ", "r"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"Sinh", "[", "r", "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"3", " ", "r"}], "]"}]}]}]}],
  SequenceForm[
  "variance of \!\(\*SubscriptBox[\(N\), \(2\)]\)-\!\(\*SubscriptBox[\(N\), \
\(1\)]\): ", 
   Rational[1, 2] $CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] + 
   Rational[1, 2] $CellContext`\[Gamma] Conjugate[$CellContext`\[Gamma]] 
    Cosh[2 $CellContext`r] - $CellContext`\[Gamma]^2 Cosh[$CellContext`r] 
   Sin[2 $CellContext`\[Theta]]^2 Sinh[$CellContext`r] + 
   Rational[3, 4] Sinh[$CellContext`r]^2 - $CellContext`\[Gamma] 
   Conjugate[$CellContext`\[Gamma]] Cos[4 $CellContext`\[Theta]] 
   Sinh[$CellContext`r]^2 + 
   Rational[1, 2] Cos[4 $CellContext`\[Theta]] Cosh[2 $CellContext`r] 
    Sinh[$CellContext`r]^2 + 
   Rational[-1, 2] Conjugate[$CellContext`\[Gamma]]^2 
    Sin[2 $CellContext`\[Theta]]^2 Sinh[2 $CellContext`r] + 
   Rational[1, 4] Sinh[$CellContext`r] Sinh[3 $CellContext`r]],
  Editable->False]], "Print",
 CellChangeTimes->{3.92909886355081*^9, 3.929434085624631*^9, 
  3.929515889679658*^9, 3.92951986329683*^9, 3.929605804075513*^9, 
  3.929606902344935*^9},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"9a47720f-8b9a-48fb-b23b-92bdc21f488d"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "Quite  complicated, but they are closed form expressions. As we can observe \
in the following plots of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
           SubscriptBox[
            StyleBox["N", "TI"], "2"], "-", 
           SubscriptBox[
            StyleBox["N", "TI"], "1"]}], "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle N_2-N_1\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5429f7ca-3484-4747-b9e0-7f75f0356129"],
 ", maximum sensitivity (measured by the derivative with respect to \
interferometric phase change ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46ba1632-b375-435f-9d9e-24b23404f50a"],
 ") appears around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", 
         FractionBox["\[Pi]", "4"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\theta=\\frac\\pi4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f974eba5-d7aa-4433-94bb-31493cedcf26"],
 "."
}], "Text",
 CellChangeTimes->{{3.929098871513104*^9, 3.929098996203375*^9}, 
   3.92960582522329*^9, 
   3.9296075549634457`*^9},ExpressionUUID->"b5de8e3a-0a6f-40b4-a9bd-\
9448c1aade7f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.928237696353594*^9, 3.928237723082648*^9}, {
  3.9290944357985363`*^9, 3.9290944704940853`*^9}, {3.929094508880398*^9, 
  3.929094514862227*^9}, {3.929094920633169*^9, 3.929094924751137*^9}, {
  3.929095230955749*^9, 3.929095232290694*^9}, {3.929095303075623*^9, 
  3.92909530619658*^9}, {3.9290988387869663`*^9, 
  3.929098851008794*^9}},ExpressionUUID->"695ad47f-4b6c-4840-be2c-\
510ccd93fac5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "10"}], ",", 
     RowBox[{"r", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstmomCOH", ",", "firstmomSQ"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"PlotLabels", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] squeezed vacuum |r=\>\"", "<>", 
         RowBox[{"ToString", "@", "r"}], "<>", "\"\<>\>\""}]}], "}"}]}], ",", 
     
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Theta]\>\"", ",", 
        "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]\>\""}], 
       "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.928234045117673*^9, 3.928234097291581*^9}, {
   3.928234142208759*^9, 3.928234142357723*^9}, {3.928234238368437*^9, 
   3.928234244167485*^9}, {3.928237111976069*^9, 3.9282371202094603`*^9}, {
   3.928829597420463*^9, 3.928829600674144*^9}, 3.928847859554748*^9, {
   3.928848031469861*^9, 3.928848040196064*^9}, {3.929098890417326*^9, 
   3.929098892128387*^9}, {3.929098999168831*^9, 3.929099278267648*^9}, {
   3.929605806008423*^9, 3.929605806791296*^9}, {3.929606041436081*^9, 
   3.929606045836009*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"e66bfa79-8520-4ec8-bf6f-b0a3ba4c9df3"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
TS60H6rqtqnCSC1UPHmRARd6/E0vCb/GKOfOnq8cJy4Mq568siqXqq/VwdY7
TnPh2SP5b5wnGIncr/vpdZYLnnXt2l8fU/NbPGt4/DwX8n/WbfNOo+bXFFfa
cCgXfJ/0dDrFY5Sad29nVxYXiuKZ7bOhVD3PWCs353LhQnaxSlwwVT/71krX
53MhxaDbVzMQoxfNj2ZLy7gQrj21nHkFoy8LWa+j3nNhT37XVlMvjHhNXu3b
M8iFP8cdq+TtMLId6DJPUp4B85oo2r/U+1FBI1XvjsoMaFqlqm3ZSs1Hl5zU
w9VmIN9P9SxtMxX/8qGV53fNQN2Wyg2PN2B0fcfkN1PjGQCH9siM1RiVBtGO
LJycgXR7Lekw6n0tvm6zy5HMGZDpr/zbW85CkdHXmZnZM2CUeG286BULCfMN
6k3kzUDy0WXy/s9ZiOdnpnTY8xkY2Xt6nucZCw0lKH4ofD8DEekZPTlJ1PpF
ap2qyPAMyOfyX6jwZSHPFVJTZWqzIGFwZapjKwv99b/QJbh9Fiaeb8pvVmYh
l9HmenPtWYg03lFRu4GFjjXcTf+1dxb0W41+35dmoYMR4ofEGLPgOePnPCjI
QuuEl79w8Z6FfiOT6ybfmegzL/2q5ItZGP3ma6B0lYmGs+8dMSOzYPjh0dBJ
XyYSOrxJO7hiFvK3HWKkejERemYyMVE3C61LOz2FTjFRjv3tEw3ts1BgESMZ
bMlE198qHAhemAX3rK0nD61jIv1A3ZWTenOQde7jtOMrBiqkn0trqJkD9dCE
5de6rFCfr/+fVx/mwDBdUJK0WaHVozc1sj/NwdKMf1exG6n1b8uT8tCWOdjA
XrSA31kh/cd9P/R+z8Epw72ZP7Ks0OcDh1cV0ufB4xnfD+45KzQSsSfknuE8
KFbRnl6l1s+bxUVd7CvnIblldKn6Ykv0N2JqpXrTAnCWdKQeLDVD64KDt55x
4UGOC3UFp2MOoq7Dba16v3hQa5zDnrljhsio9wun0I0X0frPdrriPei8h6Oz
xB9elMU+szz+pxYyKXpgLOHFh54/eqv4j/06NDzr4ss/xYdyOs7+KjESJA+/
+Re4neNHVX88hfHEFsJ11j12YYYfvX4zEacyqk3WzEVZu18UQPKzgfayH/aS
PsPrtXSBRShdtvH4ZOV+8nZjHay9vgh5zap5H91qSlzoaQLyQoLoruSyzJsd
5qQ4ab3u2yhB9B/isDSErcj6BX2fN7cEkanGYe+U5VYk0tax9PVtQeR5XPbB
Mkkr4iyVpvniniDqibzQ36RoRaRiFFUKHwoijbNKTv/ssyK+wcqy6XmCSOqC
3ZHvl62Inpsq7/VPgmiJ6/tK12ErUq+tU2mxnIa6g4K1Ol4ySFjJfzMGYjSU
rNnf3f2WQQw1c7dpi9NQ14Pio93U/pGoKCSsk6ShPxoDLz5/ZZB8ebr3hBwN
1T1t6fX4wyCxtEalO6o0tIT1qbhYmkmOfzkV3mJKQ1Ii5z/s92QSObPU8g/m
NBRP+B6kXmCS73U/2G8saYi1M37x7GUmYVaZOz5m0ZBlwEBDbCiTGJVu3+1z
lIYMo25URyUwiUoi/4jMGRrKUT7BuPKOSdguDyyPRdCQW/w7T0NxFrl5MZnm
F0lDHqvzKg5LscjGsKyy+GjquJ3tXSdZFmFklq1ru0NDzzMtX7tS+/Fnv9rG
GYk0dPWkx9gmXRY57SATc+ApFe8aRp7bcRbptI1v1PpMQ5nem8wFsljE2zU1
hNFIQ0emTtnuy2WRpZeydTybaEjM+EG5Xz61n497mZLXSkOpGvRbnWUscr+1
3XNzNw2l65htsqhjESvWWnGFCRrqCTi5c2KQRarNEhkiEnRkdH3tls0bMXGp
6H1FW01HJSssxqz/wURkx2YlPik6sit4Ux+4GRML2VLu1Bo6CnffXftODZO2
P58TOzfQUf2io0UCgMlwmOBAviZ1P6vgl3ZMTCLnD1rmbKcjDd2PcWqHMFH3
uPUiYycdBS1LCp6zxuT8Ibmb8bp0tO+KwiV/O0z4lHZpBO+jo5vJfY17TmMi
Xul6+TCDjlZnSqQlX8GkZEfBLysWHUWdVvq78homh59wzUwP0dHpkoCdVwIx
SbgVvE7flo6yQshH/TBMlOwfVm9xpCOzaNGxwFuY6Cw0ruD9j47WBKGoXymY
/PCQ9p3xoiPSvi2LnYaJf59d7+R5OvqTnfaSPxOTqg/DxQO+dOR6UaaWlo2J
aRzdtjGAjg4U3z33rgAT+5066ekxdDQsGJ+0/i0mJ/98mPx+h46mZ/z+ClZi
cvbhUf0V9+hIQL4l72cVJn5C1376xtPRo4DsiCu1mMS11EhbpNFRkm3cveOf
MEm+Ye0SnEFHXx1+eAp9weTxnj8lLx7T0YoI89fpjZiUZooyFXOpeEMaEz98
w6TpAitytpiOdksuu/qqHZP2Lb9/bHtOtU84vEaxA5Oenxe3OL2gI9mkEN/Q
TkzG9yfUfiJ0FNpquU6rGxNRqV6B9Bo62t7Kcdbox2RVvZfl9/dUviQ28dr9
xmTtVfqj5fV0dNHiFW/QACZbBjaB72c6ejaYvqt0CBPj5x4XzNvoKHYt42rF
CCbmbgLVQe10NJBhaVUwiglWuCPxooM6nqIcHjeGiVNYaf7GHjraprx/M3MC
E7fdB/hs+uhov4xwjOIkJl5j382i+ulI3+zOsVHKAYd5hmeG6OjOBxlFt2lM
ri+N1tn2l47ShJPl5NmYRJevu35ilI5U3JdcrqP8UNlQ6dMkHUWsf358CReT
jB/NXoJsOuoaixtMovw02qVSm0tHr/8kNm2ZweQV94Z92jwdyY/afFWdxaQy
RzavjUcIvRKu7k+jXGeftyDKL4SUzhUeEZ/DpFFir4nBIiGkeoV/uy/lttrG
OB+aEPrcEu3eRrnr8onBp0JCaN9Fg6Xq85gMqLF39i0WQjw5/CLXKI/2hYZI
LxVCROyZ63vK7PvS38xEhdDdOG3VJQuYLJhkbwhaIYQGr4db7aMsyA+eZSuF
0BXvW61elEWKG8pHJITQZcM95UmUV56yX75RUgh5aIUufktZWnbiqLW0ELL8
dKyonbLCl8CcyDVCKGz6dTm1vifKwavmKmWF0J/WJNX/fT/Ypp15YEZeCP3/
94X/AxmVErw=
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
elqJzuf//1/4P7DxvuU=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, -99.99999999999918}], 
           Offset[{2.9773498107317753`, -0.3679512257561625}, {
            3.2698743536113763`, -99.99999999999918}], 
           Offset[{0, 0}, {3.337193296563781, -100.85696960119024`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -100.85696960119024`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, -99.99999999999918}], 
           Offset[{2.9773498107317753`, -0.3679512257561625}, {
            3.2698743536113763`, -99.99999999999918}], 
           Offset[{0, 0}, {3.337193296563781, -100.85696960119024`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -100.85696960119024`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{144., 8.000000000000032}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{144., -7.999999999999968}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., -7.999999999999997}, {
            3.337193296563781, -100.85696960119024`}], 
           Offset[{10., 8.000000000000002}, {
            3.337193296563781, -100.85696960119024`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{77., 1.709743457922741*^-14}, \
{3.337193296563781, -100.85696960119024}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, -86.84588358199103}], 
           Offset[{2.9773497380731198`, 0.36795181368750807`}, {
            3.2698743536113763`, -86.84588358199103}], 
           Offset[{0, 0}, {3.337193296563781, -85.98891259057663}], 
           Offset[{5., 1.1102230246251565`*^-15}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -85.98891259057663}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {3.141592653589793, -86.84588358199103}], 
           Offset[{2.9773497380731198`, 0.36795181368750807`}, {
            3.2698743536113763`, -86.84588358199103}], 
           Offset[{0, 0}, {3.337193296563781, -85.98891259057663}], 
           Offset[{5., 1.1102230246251565`*^-15}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., 2.220446049250313*^-15}, {
            3.337193296563781, -85.98891259057663}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{227., 8.000000000000052}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{227., -7.999999999999949}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., -7.999999999999998}, {
            3.337193296563781, -85.98891259057663}], 
           Offset[{10., 8.000000000000002}, {
            3.337193296563781, -85.98891259057663}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=10\[RightAngleBracket]\
\[CircleTimes] squeezed vacuum |r=2>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{118.5, 2.631228568361621*^-14}, \
{3.337193296563781, -85.98891259057663}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\[Theta]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox[
     "\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]\"",
       HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 254.86269219985522`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, Pi}, {-99.99999999999918, 99.9999883073172}}, {{
     0, 3.141592653589793}, {-99.99999999999918, 99.9999883073172}}],
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.928234050916918*^9, 3.92823409759352*^9}, 
   3.928234142543556*^9, {3.928234238650971*^9, 3.92823424539441*^9}, {
   3.928237112847659*^9, 3.928237120587472*^9}, 3.928238818049718*^9, 
   3.928396016007423*^9, 3.92839606193083*^9, 3.928829536466553*^9, {
   3.928829597623012*^9, 3.928829600923201*^9}, 3.928843867461921*^9, 
   3.928845199819831*^9, 3.928846953243968*^9, 3.92884785989251*^9, 
   3.928848040728587*^9, 3.929094521766678*^9, 3.929094927665521*^9, 
   3.929095020992186*^9, 3.929095067934265*^9, 3.929095310650785*^9, 
   3.929095694571839*^9, {3.929099011496425*^9, 3.929099131348783*^9}, {
   3.929099166777546*^9, 3.929099224272694*^9}, {3.929099266841694*^9, 
   3.929099278766501*^9}, 3.929434097239084*^9, 3.929515894006731*^9, 
   3.929519863636734*^9, 3.9296058079837008`*^9, 3.929605845319563*^9, {
   3.9296060422002783`*^9, 3.92960604643782*^9}, 3.929606903754711*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"292152cf-df85-48b4-97d2-7146aa690e45"]
}, Open  ]],

Cell[TextData[{
 "Error of phase determination around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", 
         FractionBox["\[Pi]", "4"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\theta=\\frac\\pi4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c2fc3e91-12bb-4f6f-8add-9101af4ac48b"],
 " is calculated using the standard error propagation formula: it is \
proportional to the square root of variance, and inverse proportional to the \
derivative of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
           SubscriptBox[
            StyleBox["N", "TI"], "2"], "-", 
           SubscriptBox[
            StyleBox["N", "TI"], "1"]}], "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\langle N_2-N_1\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a3057f72-bd16-484e-8ad6-3ea8c217e581"],
 " with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f95b4ed8-1ff0-4cd7-a62e-d66cadc4a5dd"],
 ". Squeezing improves the phase determination uncertainty significantly:"
}], "Text",
 CellChangeTimes->{{3.929099291652415*^9, 3.929099374194726*^9}, {
  3.929099472450871*^9, 
  3.929099521403895*^9}},ExpressionUUID->"c0c1408e-944f-435c-a93f-\
7a3f64888b94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "20"}], ",", 
     RowBox[{"\[Theta]0", "=", 
      RowBox[{"\[Pi]", "/", "4"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"errCOH", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varCOH"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomCOH", ",", "\[Theta]"}], "]"}]], "/.", 
      RowBox[{"\[Theta]", "->", "\[Theta]0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"errSQ", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varSQ"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomSQ", ",", "\[Theta]"}], "]"}]], "/.", 
      RowBox[{"\[Theta]", "->", "\[Theta]0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"improvement", "=", 
     RowBox[{"errSQ", "/", "errCOH"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"errCOH", ",", "errSQ"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<squeezing parameter r\>\"", ",", 
         "\"\<phase estimation inaccuracy\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabels", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] squeezed vacuum \
|r>\>\""}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.928234168558448*^9, 3.928234213597878*^9}, {
  3.928234834012498*^9, 3.928234837978031*^9}, {3.928237147265188*^9, 
  3.92823714780927*^9}, {3.928239148511973*^9, 3.9282392090238943`*^9}, {
  3.928239242720806*^9, 3.928239242863816*^9}, {3.928396232545305*^9, 
  3.928396322441305*^9}, {3.92909931130685*^9, 3.929099311387757*^9}, {
  3.929099381568681*^9, 3.929099492977828*^9}, {3.929099529293942*^9, 
  3.92909970500648*^9}, {3.929605814055736*^9, 3.929605814183625*^9}, {
  3.9296058520563297`*^9, 3.929605878584764*^9}, {3.929606908755262*^9, 
  3.929606954878916*^9}, {3.929607517589973*^9, 3.929607533844541*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"182858f8-3e46-436e-86a2-509929521696"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQHVOnc+X///f7Z80EA/tlfLPD0/e9g/M/zOO8fa7m
LZy/aqX4lebDr+B824b7GnkWL+D8vOsd3HK7nsL5RyWSH2xmfQznf1X9LlBf
/wDOn25VkZ7QdhvOr9c6esJX/RqcL7mp9eFSlYtw/n/pgL2Ts4/D+fFsP3yS
enfB+WvT8i3Vls+C89cwF9naX11rD+N77P//bV3bQTifO/R+aFnBGThfp2TO
vsmTL8P5CsuuzmqcdAPOP8G8dtLiv3fh/PspHZm6bQ/h/C2xneKLnZ/A+a+v
rjAP/vIMzvds4vtztuwlnN/o4nwuSf8NnP/Aap/LoZ3v4PzAG6vF1s3+AOfL
yz0Q7Pj6Ec5nqDOPd7f4DOefyyjbLDztC5zvN/mIQ+3br3D+w+umCmd0v8P5
icv72DQ6f8D5XyZw2Wee/QnnW+6ausGd+zecn5XHoWmc8gfOX28z7zPzsr8I
86dKH33I9B/On8wSVxKkwuAA4/Pd27qI6QiCz1DbGGJZyAjn/14Rt/6REBOc
nztrfa/QIQR/h3YHh2AeM5zP41Wk08THAudf171wuXIPgr96nr3KkzhWOD9i
vZmg7D8Ev7p1YeOdVWxw/ooXsrP5fNjhfIUWEQ/2ZQj+dHnur///I/gAIQGz
6Q==
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
6ZStTMD/AIhdS+s=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.999999918367347, 0.025}], 
           Offset[{2.1388832431309712`, 2.1036108176783888`}, {
            3.1633332450340137`, 0.025}], 
           Offset[{0, 0}, {3.3337092403381297`, 0.02962330337149221}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.02962330337149221}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.999999918367347, 0.025}], 
           Offset[{2.1388832431309712`, 2.1036108176783888`}, {
            3.1633332450340137`, 0.025}], 
           Offset[{0, 0}, {3.3337092403381297`, 0.02962330337149221}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.02962330337149221}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{144., 8.000000000000032}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{144., -7.999999999999968}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., -7.999999999999997}, {3.3337092403381297`, 
            0.02962330337149221}], 
           Offset[{10., 8.000000000000002}, {3.3337092403381297`, 
            0.02962330337149221}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=20\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{77., 1.709743457922741*^-14}, \
{3.3337092403381297, 0.02962330337149221}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.999999918367347, 0.016798767213498163`}], 
           Offset[{2.6544297181027563`, -1.3978565275638701`}, {
            3.1633332450340137`, 0.016798767213498163`}], 
           Offset[{0, 0}, {3.3337092403381297`, 0.014323252896824448`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {2.999999918367347, 0.016798767213498163`}], 
           Offset[{2.6544297181027563`, -1.3978565275638701`}, {
            3.1633332450340137`, 0.016798767213498163`}], 
           Offset[{0, 0}, {3.3337092403381297`, 0.014323252896824448`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., 2.220446049250313*^-15}, {3.3337092403381297`, 
            0.014323252896824448`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{213., 8.000000000000048}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{213., -7.999999999999953}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., -7.999999999999998}, {3.3337092403381297`, 
            0.014323252896824448`}], 
           Offset[{10., 8.000000000000002}, {3.3337092403381297`, 
            0.014323252896824448`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=20\[RightAngleBracket]\
\[CircleTimes] squeezed vacuum |r>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{111.5, 2.475797344914099*^-14}, \
{3.3337092403381297, 0.014323252896824448}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"squeezing parameter r\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation inaccuracy\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 253.05414432518631`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., All}},
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.929094549574757*^9, 3.929094587823131*^9, 3.929094930919038*^9, 
   3.92909502541684*^9, 3.929095070514318*^9, 3.929095313239493*^9, 
   3.929095698344741*^9, 3.929099311565793*^9, 3.929099408205792*^9, {
   3.929099440579236*^9, 3.929099493361874*^9}, {3.929099583149643*^9, 
   3.929099663075268*^9}, 3.929099706735907*^9, 3.929434098853071*^9, 
   3.929515896532328*^9, 3.929519863796903*^9, {3.929605867831765*^9, 
   3.929605878833679*^9}, {3.929606905419875*^9, 3.929606955091103*^9}, {
   3.9296075125752497`*^9, 3.929607534077229*^9}},
 CellLabel->
  "Out[356]=",ExpressionUUID->"893e36ca-e97e-4eaa-80e8-52db8f50b2a5"]
}, Open  ]],

Cell[TextData[StyleBox["Zero+two photons approximation to squeezed light",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.928845210265777*^9, 3.92884522417776*^9}, {
  3.929605946792506*^9, 
  3.929605953447912*^9}},ExpressionUUID->"85797ec8-37bd-41dc-907d-\
70e23204ed2d"],

Cell[TextData[{
 "In  the article, we show that a finite photon number approximation to the \
squeezed vacuum represented as a superposition of two Fock states (",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\tau\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9b31153-10a3-40cf-9aa3-261d3e0e3df5"],
 ") also improves accuracy to some degree, and can be probabilistically \
prepared by a ",
 StyleBox["device commuting with the interferometer given input ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "vacuum", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\text{vacuum}\\\
rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e3ef7bd8-6060-4db7-8bc3-a23cf99c1af6"],
 StyleBox[" ",
  FontSlant->"Italic"],
 ". This means that the device can be placed before the interferometer (and \
used to prepare the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5e4b2cd8-c2f0-420a-ab50-b4d77cee3edc"],
 "), or transform the output state of the interferometer (product of coherent \
states) ",
 StyleBox["into a result of feeding the interferometer with ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\tau\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "77c846d8-ddbd-456f-be0d-bc1db72ba388"],
 ". In short: postprocessing is equivalent to preparation, given certain \
mathematical criteria. In this section we show that the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\tau\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d51589a2-5991-43c1-9f86-7f21a3fdc674"],
 " offers a reduction in phase estimation inaccuracy  (compared to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "vacuum", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\text{vacuum}\\\
rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a64251b5-d24e-40fa-9e99-828ae2f186cb"],
 StyleBox[" ",
  FontSlant->"Italic"],
 ")  of factor ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"3", "-", 
          SqrtBox["6"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\sqrt{3-\\sqrt6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d9cb347-c34e-4502-8ee4-a3b98be5a8f2"],
 " (asymptotically). First, the calculations are done as previously:"
}], "Text",
 CellChangeTimes->{{3.929100065861938*^9, 3.929100371534491*^9}, {
  3.929100424147745*^9, 3.929100437733879*^9}, {3.929100468220813*^9, 
  3.929100736228984*^9}, {3.929434163447237*^9, 
  3.929434168159276*^9}},ExpressionUUID->"9ca9269b-87b5-4409-a84b-\
b69961ff3699"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", 
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["A", "2"]}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], ",", 
         RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", 
      SubscriptBox["\[Beta]", "1"], ",", 
      SubscriptBox["\[Beta]", "2"]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Gamma]", " ", "id"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"\[Gamma]", "\[Conjugate]"}], "id"}], ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", 
     SubscriptBox["\[Beta]", "1"], ",", 
     SubscriptBox["\[Beta]", "2"]}], "}"}], "=", 
   RowBox[{"Expand", "/@", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B", ".", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["b", "1"], ",", 
         SubscriptBox["b", "2"], ",", 
         SubscriptBox["\[Beta]", "1"], ",", 
         SubscriptBox["\[Beta]", "2"]}], "}"}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], ",", 
         RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr01", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "2"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "2"], ")"}]}], "]"}], "-", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"(", 
          SubscriptBox["\[Beta]", "1"], ")"}], ".", 
         RowBox[{"(", 
          SubscriptBox["b", "1"], ")"}]}], "]"}]}], ")"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr201", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"Distribute", "[", 
      RowBox[{"expr01", ".", "expr01"}], "]"}], "//.", 
     RowBox[{"simprules", "[", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928845308722274*^9, 3.928845336220846*^9}, {
   3.928845406971631*^9, 3.928845431329391*^9}, {3.928845463700645*^9, 
   3.928845590498641*^9}, {3.92884562392206*^9, 3.928845950324718*^9}, {
   3.928846228075332*^9, 3.928846231297236*^9}, {3.928846273044492*^9, 
   3.928846290665881*^9}, {3.928846335140945*^9, 3.928846335354129*^9}, {
   3.928846718766649*^9, 3.9288467190050983`*^9}, {3.928846967010287*^9, 
   3.928847070623625*^9}, {3.928847238929918*^9, 3.928847239701251*^9}, {
   3.928847595264288*^9, 3.928847614141056*^9}, {3.92884765375803*^9, 
   3.928847696797955*^9}, {3.929094935730975*^9, 3.9290949943611603`*^9}, 
   3.929095031035021*^9, {3.929100739602658*^9, 3.929100740079557*^9}, {
   3.9291007752419*^9, 3.929100778386445*^9}, {3.9296059838365393`*^9, 
   3.929605987293211*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"9f936469-8256-4b4d-bcc0-73799fc82387"],

Cell[TextData[{
 "Remember that ",
 StyleBox["expr01",
  FontWeight->"Bold"],
 " is a polynomial in the annihilation and creation operators of the input \
modes (and ",
 StyleBox["expr201",
  FontWeight->"Bold"],
 " is its square):"
}], "Text",
 CellChangeTimes->{{3.929100744958555*^9, 
  3.9291008129116364`*^9}},ExpressionUUID->"4850de06-7b2c-4f4f-8f20-\
ce44629c60d6"],

Cell[CellGroupData[{

Cell[BoxData["expr01"], "Input",
 CellChangeTimes->{{3.929100814209503*^9, 3.9291008151436243`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"609dcc98-0a9d-4156-950d-eb2ba7f9a006"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Gamma]"}], " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"id", ".", "id"}]}], "-", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", "id"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"id", ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{
    SubscriptBox["A", "1"], ".", "id"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "1"], ".", 
    SubscriptBox["a", "1"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "2"], ".", 
    SubscriptBox["a", "2"]}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.929100815366357*^9, 3.9294341082081413`*^9, 
  3.929515900015833*^9, 3.929519867114087*^9, 3.929605990186696*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"fc41a312-b3fe-4cf8-82c4-c3dd786985a0"]
}, Open  ]],

Cell[TextData[{
 "We now have to assume that the input mode 1 is in vacuum (which is then \
displaced by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["D", "TI"], "(", "\[Gamma]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D(\\gamma)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "16f98787-6b32-4c37-822a-cf14beeacbb9"],
 " and fed into the interferometer), and the monomials ending with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "79e5c612-f99d-459a-ab1e-8c5f25cce3df"],
 " (or beginning with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["a", "TI"], "1", "\[Dagger]"], TraditionalForm], 
     "errors" -> {}, "input" -> "a^\\dagger_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e570dfe1-834f-41a6-87f8-8f5e761ad6ca"],
 " ) do not contribute to the expectation values, while we replace the \
operators ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["a", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bbbe1e64-d9d2-4d81-baf0-1228d8cccce6"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["a", "TI"], "2", "\[Dagger]"], TraditionalForm], 
     "errors" -> {}, "input" -> "a_2^\\dagger", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f5a90216-c239-41a0-802e-54e9fe61a915"],
 " with finite-dimensional matrices (which leads to strict result, since the \
state has finite maximal photon number), and calculate the expectation values \
of with the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\psi\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3df9243c-1285-4bbb-b9ce-7e9ecb074676"],
 ".\nFirst, let\[CloseCurlyQuote]s define the state and the matrices:"
}], "Text",
 CellChangeTimes->{{3.929100818673018*^9, 
  3.9291010895288477`*^9}},ExpressionUUID->"b47f42d5-246b-4ad2-8c25-\
bea0a0c2437f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxdim", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ANN", "[", "dim_", "]"}], ":=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       SqrtBox["k"], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec01", "=", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}]}], "}"}], ",", "maxdim"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covec01", "=", 
   RowBox[{
    RowBox[{"vec01", "\[ConjugateTranspose]"}], "//", "ComplexExpand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<truncated dimension = \>\"", ",", "maxdim"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<2-photon approximation = \>\"", ",", 
    RowBox[{"vec01", "//", "MatrixForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Truncated annihilation operator = \>\"", ",", 
    RowBox[{
     RowBox[{"ANN", "[", "maxdim", "]"}], "//", "MatrixForm"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.929101075306791*^9, 3.929101196887734*^9}, 
   3.929101424333439*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"26c656fe-df68-4f3d-a245-f1fc929c23b4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"truncated dimension = \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["truncated dimension = ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.92951986833336*^9, 3.929605994504135*^9},
 CellLabel->
  "During evaluation of \
In[39]:=",ExpressionUUID->"9c904324-03d7-48b7-9fe5-ba2fd4fb6aa7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"2-photon approximation = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"Cos", "[", "\[Tau]", "]"}]},
        {"0"},
        {
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Tau]", "]"}]}]},
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["2-photon approximation = ", 
   MatrixForm[{
     Cos[$CellContext`\[Tau]], 0, -Sin[$CellContext`\[Tau]], 0, 0, 0, 0, 0}]],
  
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.92951986833336*^9, 3.9296059945069532`*^9},
 CellLabel->
  "During evaluation of \
In[39]:=",ExpressionUUID->"6b91bcbc-840d-47ec-b06e-5ad7b27a8306"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Truncated annihilation operator = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", 
        SqrtBox["2"], "0", "0", "0", "0", "0"},
       {"0", "0", "0", 
        SqrtBox["3"], "0", "0", "0", "0"},
       {"0", "0", "0", "0", "2", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SqrtBox["5"], "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        SqrtBox["6"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        SqrtBox["7"]},
       {"0", "0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Truncated annihilation operator = ", 
   MatrixForm[{{0, 1, 0, 0, 0, 0, 0, 0}, {
     0, 0, 2^Rational[1, 2], 0, 0, 0, 0, 0}, {
     0, 0, 0, 3^Rational[1, 2], 0, 0, 0, 0}, {0, 0, 0, 0, 2, 0, 0, 0}, {
     0, 0, 0, 0, 0, 5^Rational[1, 2], 0, 0}, {
     0, 0, 0, 0, 0, 0, 6^Rational[1, 2], 0}, {
     0, 0, 0, 0, 0, 0, 0, 7^Rational[1, 2]}, {0, 0, 0, 0, 0, 0, 0, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929101135835848*^9, 3.9291011970354652`*^9}, 
   3.929101424492178*^9, 3.929102156318342*^9, 3.92910290150287*^9, 
   3.929434110771911*^9, 3.929434193043633*^9, 3.929515901177427*^9, 
   3.92951986833336*^9, 3.9296059945081873`*^9},
 CellLabel->
  "During evaluation of \
In[39]:=",ExpressionUUID->"9e1a5644-d58a-4267-bb97-ed8584158ef5"]
}, Open  ]]
}, Open  ]],

Cell["The expectation values are calculated in the following step.", "Text",
 CellChangeTimes->{{3.929101202896002*^9, 
  3.9291012241842613`*^9}},ExpressionUUID->"28a49835-5a16-4645-b881-\
67a2d25990fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"finalizetomatrices", "[", 
    RowBox[{"idx_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "idx"], "->", 
      RowBox[{"ANN", "[", "dim", "]"}]}], ",", 
     RowBox[{
      SubscriptBox["A", "idx"], "->", 
      RowBox[{
       RowBox[{"ANN", "[", "dim", "]"}], "\[ConjugateTranspose]"}]}], ",", 
     RowBox[{"id", "->", 
      RowBox[{"IdentityMatrix", "[", "dim", "]"}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmom01OP", "=", 
   RowBox[{
    RowBox[{"expr01", "//.", 
     RowBox[{"expvacuumrules", "[", 
      RowBox[{"{", "1", "}"}], "]"}]}], "/.", 
    RowBox[{"finalizetomatrices", "[", 
     RowBox[{"2", ",", "maxdim"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"secmom01OP", "=", 
    RowBox[{
     RowBox[{"expr201", "//.", 
      RowBox[{"expvacuumrules", "[", 
       RowBox[{"{", "1", "}"}], "]"}]}], "/.", 
     RowBox[{"finalizetomatrices", "[", 
      RowBox[{"2", ",", "maxdim"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstmom01", "=", 
   RowBox[{"covec01", ".", "firstmom01OP", ".", "vec01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secmom01", "=", 
   RowBox[{"covec01", ".", "secmom01OP", ".", "vec01"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"var01", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"secmom01", "-", 
      SuperscriptBox["firstmom01", "2"]}], "//", "Expand"}], "//", 
    "FullSimplify"}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.9290950889557*^9, 3.929095119017602*^9}, {
   3.929095362348563*^9, 3.929095552693774*^9}, {3.9290957256444902`*^9, 
   3.92909575245385*^9}, 3.929101095812745*^9, {3.929101201058881*^9, 
   3.9291012273286457`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"eea2a739-1737-455e-8e17-b0f9f6d3867e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
  RowBox[{"\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "\[Theta]"}], "]"}]}], "-", 
  RowBox[{"2", " ", "\[Gamma]", " ", 
   RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Gamma]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Tau]"}], "]"}]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Tau]"}], "]"}]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{{3.92884767123901*^9, 3.928847758191268*^9}, 
   3.928911253989176*^9, 3.928911295284363*^9, {3.929095723205349*^9, 
   3.929095756115891*^9}, 3.929101231076439*^9, 3.929101429863179*^9, 
   3.929102161128192*^9, 3.929102907095174*^9, 3.929434117516408*^9, 
   3.929434221458383*^9, 3.929515905552671*^9, 3.929519872474265*^9, 
   3.9296060003412724`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"d038d934-af20-4e50-b928-c9a8b1694d00"]
}, Open  ]],

Cell[TextData[{
 "As before, the maximal accuracy of phase determination is attained around \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", 
         FractionBox["\[Pi]", "4"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\theta=\\frac\\pi4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6fc35830-a201-4da1-91c1-164b59d1aba9"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929101318745997*^9, 
  3.929101352392041*^9}},ExpressionUUID->"2877c0e7-23c8-42e5-8f11-\
55f88b7bdcc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "5"}], ",", 
     RowBox[{"\[Tau]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"firstmomCOH", ",", "firstmom01"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotLabels", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
        RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
         RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
         "\"\<\[RightAngleBracket]\[CircleTimes] |\[Tau]=\[Pi]/2>\>\""}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Theta]\>\"", ",", 
        "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(N\), \
\(2\)]\)-\!\(\*SubscriptBox[\(N\), \(1\)]\)\[RightAngleBracket]\>\""}], 
       "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.929101290562842*^9, 3.9291013168669686`*^9}, {
  3.929101361277061*^9, 3.9291013938961983`*^9}, {3.929606004555292*^9, 
  3.929606034347135*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"208af341-3a27-414f-870d-b7f49091e66d"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
n+JVa59tm1rKh9H/z6/4f4O0Z7k=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, {GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {1.5707963267948966`, 24.999999999999947`}], 
           Offset[{2.7732838702759928`, 1.1440701791704087`}, {
            1.6349371768056882`, 24.999999999999947`}], 
           Offset[{0, 0}, {1.6753434026578022`, 25.85850809478397}], 
           Offset[{5., 1.1102230246251565`*^-15}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            25.85850809478397}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {1.5707963267948966`, 24.999999999999947`}], 
           Offset[{2.7732838702759928`, 1.1440701791704087`}, {
            1.6349371768056882`, 24.999999999999947`}], 
           Offset[{0, 0}, {1.6753434026578022`, 25.85850809478397}], 
           Offset[{5., 1.1102230246251565`*^-15}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            25.85850809478397}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{138., 8.00000000000003}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{138., -7.99999999999997}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., -7.999999999999998}, {1.6753434026578022`, 
            25.85850809478397}], 
           Offset[{10., 8.000000000000002}, {1.6753434026578022`, 
            25.85850809478397}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=5\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{74., 1.6431300764452317*^-14}, \
{1.6753434026578022, 25.85850809478397}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
        {GrayLevel[1], AbsoluteThickness[4], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
         "Round"], 
         BSplineCurveBox[{
          Offset[{3, 0}, {1.5707963267948966`, 22.99999999999995}], 
           Offset[{2.7732828128279836`, -1.1440727424744055`}, {
            1.6349371768056882`, 22.99999999999995}], 
           Offset[{0, 0}, {1.6753434026578022`, 22.141489654369057`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            22.141489654369057`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], 
         BSplineCurveBox[{
          Offset[{3, 0}, {1.5707963267948966`, 22.99999999999995}], 
           Offset[{2.7732828128279836`, -1.1440727424744055`}, {
            1.6349371768056882`, 22.99999999999995}], 
           Offset[{0, 0}, {1.6753434026578022`, 22.141489654369057`}], 
           Offset[{5., 1.1102230246251565`*^-15}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., 2.220446049250313*^-15}, {1.6753434026578022`, 
            22.141489654369057`}]}]}, 
        {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
          NCache[
           Rational[2, 3], 0.6666666666666666]]}], 
         PolygonBox[{
          Offset[{139., 8.00000000000003}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{139., -7.999999999999969}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., -7.999999999999997}, {1.6753434026578022`, 
            22.141489654369057`}], 
           Offset[{10., 8.000000000000002}, {1.6753434026578022`, 
            22.141489654369057`}]}]}, 
        {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666],
          AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
         StyleBox[
          
          RotationBox["\<\"coherent |\[Gamma]=5\[RightAngleBracket]\
\[CircleTimes] |\[Tau]=\[Pi]/2>\"\>",
           BoxRotation->0.],
          StripOnInput->False,
          LineOpacity->1,
          FrontFaceOpacity->1,
          BackFaceOpacity->1,
          Opacity->1,
          FontOpacity->1], 
         Offset[{74.5, 1.6542323066914832*^-14}, \
{1.6753434026578022, 22.141489654369057}], NCache[
         ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
          ImageScaled[{0.5, 0.5}]]]}]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"\[Theta]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox[
     "\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(N\\), \
\\(2\\)]\\)-\\!\\(\\*SubscriptBox[\\(N\\), \\(1\\)]\\)\[RightAngleBracket]\"",
       HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 169.33667972722264`}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, Rational[1, 2] Pi}, {-24.999999999999947`, 
     24.999999999999947`}}, {{0, 1.5707963267948966`}, {-24.999999999999947`, 
     24.999999999999947`}}],
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.929101302783597*^9, 3.929101317082081*^9}, {
   3.929101353570821*^9, 3.929101394306154*^9}, 3.929101431594524*^9, 
   3.929102162452602*^9, 3.929434120533881*^9, 3.929434225958493*^9, 
   3.929515905655013*^9, 3.929519872567637*^9, {3.929606008055223*^9, 
   3.9296060345436983`*^9}, 3.929606232148787*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"255f5489-1d0c-4077-a44b-c094240c3bc5"]
}, Open  ]],

Cell["\<\
And there is a modest improvement in phase determination inaccuracy around \
this point:\
\>", "Text",
 CellChangeTimes->{{3.92910144583396*^9, 3.9291014799060097`*^9}, {
  3.929101625794734*^9, 
  3.929101644290411*^9}},ExpressionUUID->"9171b97e-9ab2-4a74-b702-\
729924f50017"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "=", "100"}], ",", 
     RowBox[{"\[Theta]0", "=", 
      RowBox[{"\[Pi]", "/", "4"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"errCOH", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["varCOH"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmomCOH", ",", "\[Theta]"}], "]"}]], "/.", 
      RowBox[{"\[Theta]", "->", "\[Theta]0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"err01", "=", 
     RowBox[{
      FractionBox[
       SqrtBox["var01"], 
       RowBox[{"D", "[", 
        RowBox[{"firstmom01", ",", "\[Theta]"}], "]"}]], "/.", 
      RowBox[{"\[Theta]", "->", "\[Theta]0"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"errCOH", ",", "err01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2", "errCOH"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<state parameter \[Tau]\>\"", ",", 
         "\"\<phase estimation inaccuracy\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabels", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] vacuum\>\""}], ",", 
         RowBox[{"\"\<coherent |\[Gamma]=\>\"", "<>", 
          RowBox[{"ToString", "[", "\[Gamma]", "]"}], "<>", 
          "\"\<\[RightAngleBracket]\[CircleTimes] |\[Psi](\[Tau])\
\[RightAngleBracket]\>\""}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.929101491442459*^9, 3.929101637308511*^9}, {
  3.929102596362795*^9, 3.929102603055075*^9}, {3.929434125329625*^9, 
  3.929434125903805*^9}, {3.929606235629716*^9, 3.92960625751842*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"02e14d07-6722-480e-8116-e623907e891b"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQzbyf69xj00S7apF17g+rSuyDciRvzZjUbw/jT/wU
s3napPlwvvVRLy6n4g1wfkGVX+Lmgh1wfu6O1D4m5QNw/pUXnpzLk47A+V36
3xi2RZ6A8wu1T0w9sPQMnP8rOXvd3bwLcH7S3rCACWmX4Pzkj1cOHOi4Auf3
GGzPX9Z2Dc5nOrDdvKXqBpwvqOV97v6MW3C+x3ynxR8m3YHzxd+fcavffg/O
n3V8FyNz5gM430bW8b9CykM4X/uBwJPakkdw/toVQhlbix7D+TX3Yi9rtz1B
+M/GwnvelKcI/813SXo94Rmcf6FgVkL5oudwvqW70r+7C1/A+SddLVc4zHkJ
5y/dONPy0epXcL6osk5W3MrXcP4lRo4myT1v4PytHMXLLpx8C+friApkJR19
B+e/7/smYnztPZyv3N6un5/1Ac5/FHX7ltNzBN/j6eWfW/M+wvkVRakZYm8R
fL9ts73Eyj7B+e/+ZNUwf0PwF15v3JJX/BkRHhm2CZW/EXzZvxOjC6u+wPnP
3LtPcbB8hfMPq52xl+tG8LM4lrEocn6D87cvULE9PBHBP2dtczRI8Duc/yNr
dnBCH4J/ImB+KK/YD0R6s7RZvnwKgu+1q6gy8DaCb2i90vu34k84HwAcZ43O

       "]]},
     Annotation[#, "Charting`Private`Tag#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[2], Opacity[
      1.], LineBox[CompressedData["
1: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
abf6BcxbGPT4y7vv8F36TL+HeQH/B/Pbs+k=
       "]]},
     Annotation[#, "Charting`Private`Tag#2"]& ]}, {{{}, GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.5707962947378287`, 0.005}], 
          Offset[{1.1192433727492397`, -2.7833961759973924`}, {
           1.6349371421306265`, 0.005}], 
          Offset[{0, 0}, {1.729184917891472, 0.002585710278976511}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.002585710278976511}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.5707962947378287`, 0.005}], 
          Offset[{1.1192433727492397`, -2.7833961759973924`}, {
           1.6349371421306265`, 0.005}], 
          Offset[{0, 0}, {1.729184917891472, 0.002585710278976511}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.002585710278976511}]}]}, 
       {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]]}], 
        PolygonBox[{
         Offset[{151., 8.000000000000034}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{151., -7.999999999999966}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., -7.999999999999998}, {1.729184917891472, 
           0.002585710278976511}], 
          Offset[{10., 8.000000000000002}, {1.729184917891472, 
           0.002585710278976511}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox["\<\"coherent |\[Gamma]=100\[RightAngleBracket]\
\[CircleTimes] vacuum\"\>",
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], Offset[{80.5, 1.787459069646502*^-14}, 
        {1.729184917891472, 0.002585710278976511}], NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.3032042067648606`, 0.01}], 
          Offset[{1.6943083273372936`, -2.47574620910858}, {
           1.6349371421306265`, 0.01}], 
          Offset[{0, 0}, {1.729184917891472, 0.008581424130700534}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.008581424130700534}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], 
        BSplineCurveBox[{
         Offset[{3, 0}, {1.3032042067648606`, 0.01}], 
          Offset[{1.6943083273372936`, -2.47574620910858}, {
           1.6349371421306265`, 0.01}], 
          Offset[{0, 0}, {1.729184917891472, 0.008581424130700534}], 
          Offset[{5., 1.1102230246251565`*^-15}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., 2.220446049250313*^-15}, {1.729184917891472, 
           0.008581424130700534}]}]}, 
       {EdgeForm[None], FaceForm[{GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]]}], 
        PolygonBox[{
         Offset[{137., 8.00000000000003}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{137., -7.99999999999997}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., -7.999999999999998}, {1.729184917891472, 
           0.008581424130700534}], 
          Offset[{10., 8.000000000000002}, {1.729184917891472, 
           0.008581424130700534}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        AbsoluteThickness[1.25], EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox["\<\"coherent |\[Gamma]=100\[RightAngleBracket]\
\[CircleTimes] |\[Psi](\[Tau])\[RightAngleBracket]\"\>",
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{73.5, 1.63202784619898*^-14}, \
{1.729184917891472, 0.008581424130700534}], NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}]}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"state parameter \[Tau]\"", HoldForm], TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation inaccuracy\"", HoldForm], TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->{{All, 201.08}, {All, All}},
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., 0.01}},
  PlotRangeClipping->False,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.929606258797216*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"25462f2c-87dd-4406-ab21-2ac53ac478fe"]
}, Open  ]],

Cell[TextData[{
 "The asymptotic improvement of accuracy can be determined analytically. Let\
\[CloseCurlyQuote]s assume for simplicity that the input coherent state has \
real positive displacement \[Gamma], and calculate the ",
 StyleBox["improvement",
  FontWeight->"Bold"],
 " as a function of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "295a941f-3f4c-4522-b4b4-31a2d7ec5b1b"],
 " and the parameterization angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa46877d-14ce-4ebf-94fb-191345610ff6"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929101656764954*^9, 3.929101697506556*^9}, {
  3.92910176408313*^9, 3.929101860027881*^9}, {3.929101894732038*^9, 
  3.929101895803157*^9}},ExpressionUUID->"3c0058f5-616b-43e9-9a55-\
a8eae74ad4d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"errCOH", "=", 
   FractionBox[
    SqrtBox["varCOH"], 
    RowBox[{"D", "[", 
     RowBox[{"firstmomCOH", ",", "\[Theta]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"err01", "=", 
   FractionBox[
    SqrtBox[
     RowBox[{"var01", "//", "ComplexExpand"}]], 
    RowBox[{"D", "[", 
     RowBox[{"firstmom01", ",", "\[Theta]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"improvement", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"err01", "/", "errCOH"}], "/.", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"\[Pi]", "/", "4"}]}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Improvement = \>\"", ",", "improvement"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.929101702683208*^9, 3.929101757780043*^9}, {
  3.929101795189035*^9, 3.929101807675816*^9}, {3.929101864870141*^9, 
  3.929101928917044*^9}, {3.929606268573032*^9, 3.929606277021044*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"cb5b2296-32bc-43e5-bb22-a932ec3c9538"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Improvement = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "-", 
       RowBox[{
        SuperscriptBox["\[Gamma]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Tau]"}], "]"}]}]}], ")"}]}]}]]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Gamma]", "2"], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Tau]"}], "]"}]}]]}],
  SequenceForm[
  "Improvement = ", $CellContext`\[Gamma] (-1 + $CellContext`\[Gamma]^2 + 
     Cos[2 $CellContext`\[Tau]])^(-1) (
     2 Sin[$CellContext`\[Tau]]^2 - $CellContext`\[Gamma]^2 (-3 + 
      2 Cos[2 $CellContext`\[Tau]] + 
      2^Rational[1, 2] Sin[2 $CellContext`\[Tau]]))^Rational[1, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9291019271540117`*^9, 3.929101929213242*^9}, 
   3.929102167011374*^9, 3.929102911667788*^9, 3.929434135848633*^9, 
   3.9294342314292393`*^9, 3.929515909677943*^9, 3.929519874353231*^9, 
   3.929606277447384*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"34952704-7993-4983-9b62-0b46f437b887"]
}, Open  ]],

Cell[TextData[{
 "The minimum (and extremum, removed manually) can be determined by \
postulating that the derivative with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8a2b906c-a232-46a6-9563-fdbe125d4466"],
 " vanishes. The optimal \[Tau] can be determined for arbitrary \[Gamma], \
although it is a rather involved function of it. With increasing \[Gamma] it \
quickly stabilizes, so let\[CloseCurlyQuote]s determine its asymptotic value \
instead. For this, let\[CloseCurlyQuote]s calculate the derivative of ",
 StyleBox["improvement",
  FontWeight->"Bold"],
 " (squared, for easier calculations) and expand it around ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\gamma \\rightarrow\\infty", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d963fc69-31be-414d-a3cc-12bc10205331"],
 ", and then find the solutions:"
}], "Text",
 CellChangeTimes->{{3.929101905350159*^9, 3.929102061045022*^9}, {
  3.929103151282426*^9, 3.929103270451091*^9}, {3.929103385907072*^9, 
  3.92910342301194*^9}},ExpressionUUID->"2dae0297-3c3e-4403-b2b7-\
3db2fa8635df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dd", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     SuperscriptBox["improvement", "2"], ",", "\[Tau]"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"dd", ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//",
       "Normal"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"dd", "==", "0"}], ",", "\[Tau]"}], "]"}], "//", "Normal"}], 
     ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"1"},
       "C"], "->", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928848288456199*^9, 3.92884850527309*^9}, {
  3.929102076449527*^9, 3.929102108813753*^9}, {3.929102172992856*^9, 
  3.92910217483001*^9}, {3.929102462337941*^9, 3.929102465314139*^9}, {
  3.929102779008226*^9, 3.929102806505568*^9}, {3.929103033684037*^9, 
  3.929103078322719*^9}, {3.929103278956938*^9, 3.929103312411542*^9}, {
  3.9291033501337748`*^9, 3.92910338165222*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"5ebe5836-e604-4a96-96a9-d74d3ee56230"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Gamma]", "2"], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], ")"}], "3"]], 
  RowBox[{
   SuperscriptBox["\[Gamma]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Gamma]", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SuperscriptBox["\[Gamma]", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Tau]"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "4"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Tau]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Tau]"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9291030439343653`*^9, 3.929103078980011*^9}, {
   3.929103282239019*^9, 3.929103314794714*^9}, {3.929103352746044*^9, 
   3.929103382513404*^9}, 3.9291034250966263`*^9, 3.929434145802839*^9, 
   3.929434233231762*^9, 3.929515919409546*^9, 3.929519875993594*^9, 
   3.929606281502798*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"3e6173ee-dc6e-482d-b448-a6f4f84130db"]
}, Open  ]],

Cell["The first solution corresponds to the minimum. It is:", "Text",
 CellChangeTimes->{{3.929102262054519*^9, 3.929102293398402*^9}, {
  3.929103433387639*^9, 3.9291034339480543`*^9}, {3.929103524372547*^9, 
  3.929103525988099*^9}},ExpressionUUID->"2eeb011a-dcfa-4c51-9dd8-\
1043366114fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Asymptotically optimal \[Tau] = \>\"", ",", 
    RowBox[{"\[Tau]", "/.", 
     RowBox[{"sols", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<For this \[Tau], improvement = \>\"", ",", 
   RowBox[{
    RowBox[{"improvement", "/.", 
     RowBox[{"sols", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Asymptotic improvement = \>\"", ",", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"improvement", "/.", 
       RowBox[{"sols", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"\[Gamma]", "->", "\[Infinity]"}]}], "]"}], "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"improvement", "/.", 
      RowBox[{"sols", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     SqrtBox[
      RowBox[{"3", "-", 
       SqrtBox["6"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Gamma]", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"Dotted", ",", "Black"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Input coherent state amplitude \[Gamma]\>\"", ",", 
      "\"\<phase estimation improvement\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.92910305612397*^9, 3.929103076385487*^9}, {
  3.929103437986318*^9, 3.929103438307919*^9}, {3.929103527412791*^9, 
  3.929103764007015*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"6c09b3d5-8cb2-4a16-b968-9b4ded5c5eb1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Asymptotically optimal \[Tau] = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"ArcTan", "[", 
     FractionBox["1", 
      SqrtBox["2"]], "]"}]}]}],
  SequenceForm[
  "Asymptotically optimal \[Tau] = ", Rational[1, 2] 
   ArcTan[2^Rational[-1, 2]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.929519877548809*^9, 3.929606284723331*^9},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"1fe55f3d-44a5-4281-a52b-a608bc84c394"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"For this \[Tau], improvement = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{"9", "-", 
       RowBox[{"3", " ", 
        SqrtBox["6"]}]}]], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     SqrtBox["6"], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["\[Gamma]", "2"]}]}]]}],
  SequenceForm[
  "For this \[Tau], improvement = ", (9 - 3 6^Rational[1, 2])^
    Rational[1, 2] $CellContext`\[Gamma] (1 + 3 $CellContext`\[Gamma]^2)^
    Rational[1, 2]/(-3 + 6^Rational[1, 2] + 3 $CellContext`\[Gamma]^2)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.929519877548809*^9, 3.9296062848672523`*^9},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"9e5cddc7-89fa-4934-898d-378788bc9f9a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Asymptotic improvement = \"\>", "\[InvisibleSpace]", 
   SqrtBox[
    RowBox[{"3", "-", 
     SqrtBox["6"]}]]}],
  SequenceForm[
  "Asymptotic improvement = ", (3 - 6^Rational[1, 2])^Rational[1, 2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.929103551369914*^9, 3.929103558575903*^9}, {
   3.929103597702966*^9, 3.929103685929801*^9}, {3.929103733658357*^9, 
   3.929103764785222*^9}, 3.929434150427299*^9, 3.92943423423828*^9, 
   3.929515921718975*^9, 3.929519877548809*^9, 3.929606284922607*^9},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"39e8112c-9bcd-433d-9443-874a4e932a4b"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[
  InterpretationBox[{
    TagBox[{{{}, {}, 
       TagBox[
        {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[2], 
         Opacity[1.], LineBox[CompressedData["
1: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
          "]]},
        Annotation[#, "Charting`Private`Tag#1"]& ], 
       TagBox[
        {GrayLevel[0], AbsoluteThickness[2], Opacity[1.], Dashing[{0, Small}],
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
          "]]},
        Annotation[#, "Charting`Private`Tag#2"]& ]}, {}},
     {"WolframDynamicHighlight", <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
    StyleBox[
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{{{}, {}, 
           Annotation[{
             Directive[
              Opacity[1.], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]], 
             Line[CompressedData["
1:eJwd0Xk41GsbB/AxsmarLNG8MaaSEEfZIvdTEamUDKmGVMeaOAmVpbIVskuK
ogUJx0E6FUWJrKEUImuY32/GGGM3wvt73+e6nuu+Pn/c13Pf34d61ueYC5lE
IpUQ93/1TJVvYpkJD0j/PxMQmXDxXZMHD5z8rt/s/cwF38Kvikr+PKhxS09s
+8AF54YdAe43eBCxN5jb/5ILuwRntwul8aB/2nTXsUwuTAQEPjKt4cEmo3LT
oL+4wHAKDy/ZOAm2Hm3BqYpc0NVKPZDWPgleBh16A8HjQPbeueFH/yRQcpxb
SZfG4WtR+5jS2CSM9Q1MG3iMw0WdtYmZq6aAriJYj9mNQ/GOhI4cvSnAo3rF
D+uMw/Zd0efK0qbgD+VbNkyMA8uBW/Vmn06BbW3vA5sBDrRU1AkbFk9BoJp2
SEsnBy7sFs6vqJ+C6ewS5ZVPHChE4RPVC1NQGp8ipZ/LgW0WISFfTk1D5VNs
e4sbB/i3KEfWuU+DgJ9M6AFnDjTWV6jY+U1D7vOkQ98cOOBhxf/YFTsNBRbL
jxSsOJB3+LL4wLtpUHvOyDiqxYEt9Itp48ozkHCqNMN9dgyoZ1xKVg/PAJVH
ddRNHoOfvczkEO4MuJR1zr+MHYO7Jz39uPwZqL5C1d13awzE6T4G7Wtm4fqC
IzUweAym9199lw6zoKK3P+S42xjUa8Y1qGfMgs1uN8Y70zHwni8btDg2B88L
P7YUTLFhq7/BxzeOc9A1xjc25rLhF+9NtobHHKSlPu75wmKDA7vSTfrGHDyI
LfOVHWLDnr56TsffczA3yDnEaWODbM3PBRexedDFLXIG/mFDRcKqtRHv5+Hs
2Nv4C75sKE2NCnzbNA8ML9HPP7zZkJ8h8Wu6Yx6+SpjZHzzPhvRnsmUunHkw
diMrm/7JhitVm+wtlBZgp1Styxl7NuhzzdLF/RagWFl0JdWYDcXWkapJanz4
9qhbLECMDXl0sdsNunzwdLUYuSLMhqyTcVMCpnzoEMkfuS7IhnjX1BpfOh/+
idbQT19iwYVrOa70UD6Q72xGKzwWbCuqzVfo4YPGw9ywiB4WZEsK78iMXwSf
O+M3Dpaw4JpBvUxj+iIkRspFxxexwOFMzPhM7iJE67tf/F7AAomXUvmHqxbh
lNNojXcuC/wYCtQl7iKoNd0saMlggVnBVmmGzW/gP1y02X2LBb8sD7IVZZfg
WpDe5jxnFrz1lWwwV1kCjum01EknFtx90Jp7UXMJFu44ikszWGA1YXu2wWwJ
ypJUVMKOs6A0jfHjiv8S0GVeacdasyBs9EJdZ8cSSHbrHtDYzQLViMSnqfeX
wXW0SPgShQVMXC+Jl70MngZ7yjOVWFB4pOfa4eJlOGR8I6V5PQv0Nmw5KVS3
DNZw4fl2ORZYllbI+E8vQ+hlhpCEFJHXwGgI/cgKLNJGcraSWMDI3FgYTSYh
rdFHa76N4GBqw3tiIEpCCh1rnUyHcVBZVXN/RJKEXOvoPvlDOIx4eNzao0hC
rfG532/14+CtV3Z2QZuE1EHT/fgPHEKbDyh6OJLQzHYlT4vPOOTy/W5aviah
U5vnl0/8i0Ng1ajBX5UkVDj4JKq7DIfDEQ54Wg0J7Rw508x4gcO0pMkhZhsJ
XdZ0u+xajMNequDamzgJKWVXrInPx6HPIunhRyUBNFCZoKiZhYN86t9lpiEC
qD5YMzQ5GgfWCWVX13AB1B7vFGgehcO7jUkK8dEC6K8Z5cGFmzj8mecX2Jsq
gOJ0h8ddI3AorTBGwUUCiD9I/2JzHQfroYamN/0CaGnjKY67Pw6R2qNDO/eS
0U35cqWEszjMv+7qBEsyklQL3HfxDA6ee5uarazJqIZtnkx3Jvrtiv91PklG
Tsp5GRudiPmCAmNifclo/0rtH+9PEHl8ktIdfkJGFxjP5AxtcKh3NAhNERRE
Ir5FKRMIB4nYKOXJGkGUX3PizS4aDn4vvCipjYKIe+qDl6cqDj3dRxUN2wRR
cs+HznQqDvnqiuuu9Qii1ED1L0vKOFjWPRcWnxREEsOUXc0UHMLJTRyq8irk
24drxsjjwL8i+dbm6ir06VmyfKQ4DrhLskOJlhDivkqLsZ7GYG+WnEzLDiFk
WzJFujeFQXrXvTqWkRDSm/dVHJrE4NDBLP1N+4WQxvtOrSs8DIp0CmXTnIRQ
rcPp1oJxDHwXa9uCE4RQmOC2Yzo4Br8TFywteULoXNXSped9GMi8dTbqLxNG
/l3fTA2bMHBK+T6fUi6MIr0Yr4saMSj0tHpt+V4YJfT8ythM2FJxp0FpkzBa
ajbJkm3A4EaAiF7kkDCKuAy35z5hwNUp0tGQEUEKvskZbdUYtOQsql0+L4Is
JWhfmssxiEu4Ky+tKooOOQXWdBVgEKgRq/hMTRT5t/Vz3Qm71oVSQEsUnbZK
8FzIxwCteKn6GIqinVezDm0gPOm9b3urtSiK3e9UcTYPA3vrCfOEIFFkl7xH
kJSDgYqklb/0d1GUJ+Z82DcTg9KYpXbpKDF0/jeTrpaMAZWsbnRdYjUKSPgl
/i4Qg9HZivSJAAm0pK9dZuyOwYzbuuy2FUlkbebVpHic2J/0IC40VBrJ2crb
FVtiwFj9ySjdTwYd6zU9Lbgbgyj6I1KBwRo03uibOPkHBqcZRbVvOWvQSpj9
8MBWDE49yewTerEWhX6t7d2pgoFG8DO3V37r0HDxv3NF6zHIkR0e91CXRTn3
sKrzazEwZ5MbbTmySC7uSKe9BAaJN+yemmbLoR5NXrWJCPG/z9+PJR2XR7fv
VjWXkYk8ZKRiKEoKiNyiEY6WmTCon7A5r1UBLea1Ylf5TJhJn5Q9f2c9mugK
aKmaZUJvsrffXTtFNEnRrvCcYoLPgY1fq8WUkAAaNk+aYIKaaXH4ls9K6AnX
O7qcw4QYnv+O2+EbkLNxi74VmwnvDem2DvoUVP6m/cU6nAmUStk6xjwFuQSY
492jTKCRxYzO/v0fdLlaVpM7zIQjEf3LmRc3ojHnTf6kX0zYUotX/9yqjNqD
HmvbDjKh7b7EXNhPZSRSd0ynsZ8JRzuioPiICnqcI2Rv0scEKcgJy8pXQeU1
v90GfzKh71OpzzZJKqp0OvAmtIcJ9+4138EvUFFk4lOOaTcT8g6QjNTrqSi2
29xo0w8mNCpuvrVqmypymCiirepiwt6Gc3TnSFVEl3NWF+lkQnZ10YmJPlX0
M46yROlgwvoeligF0dA7d9ij9Z0JQ1+RQX06De1OMhQ6+Y0JmVsPyjs+oKFo
q98+9oRPXLOb4T2koQSzzJ5jhNvUPV9seExDWT1BLw8SrryRou3zjIZWV6de
2k04Y/uomnwZDR3VEVakEqbH3F7/52ca0vTkCOPtTJAZSJ2bb6Gh6zARO0K4
Se9RR1wb8V5y/bohwnsHy+68aqeh4kfztB7COoZ9Mqu7aaiSbW39mbDEqI5Y
6SgNWYvdbywhXG9sjO3HaEhist2xiHB4knldD05DgSoDvHzCfJOTkUIcGhIz
O0/JJoylhAucmKIhp3PmQXcJZ+NxA5xpGjLRF5RLIXwa7lWFzdJQrUniPwmE
O1iFIYULNPS9V54ZRTgZvWLsWaShdTPSEZGEre9+MO74TUN+Rp3UMMLiY01K
55dp6I6H1/trhGv3dCysrNCQllnr6SDC/wXnlnlu
              "]]}, "Charting`Private`Tag#1"], 
           Annotation[{
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              Dashing[{0, Small}], 
              GrayLevel[0]], 
             Line[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
              "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {1.0000001836734715`, 0}, 
           "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              Opacity[1.], 
              AbsoluteThickness[2], 
              Dashing[{0, Small}], 
              GrayLevel[0]], 
             Directive[
              Opacity[1.], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           Plot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {1.0000001836734715`, 0}, 
          "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             Opacity[1.], 
             AbsoluteThickness[2], 
             Dashing[{0, Small}], 
             GrayLevel[0]], 
            Directive[
             Opacity[1.], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          Plot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}],
     Selectable->False]},
   Annotation[{{{{}, {}, 
       Annotation[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Line[CompressedData["
1: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
          "]]}, "Charting`Private`Tag#1"], 
       Annotation[{
         Directive[
          Opacity[1.], 
          AbsoluteThickness[2], 
          Dashing[{0, Small}], 
          GrayLevel[0]], 
         Line[CompressedData["
1:eJxTTMoPSmViYGAwAWIQfeOjryEDwwd7ho09V7X2Pbdv7S/cezrzI5xvpDvV
c/rlT3C+YmLqRu4nX+H83f0sQi0HfsD5S3jZjOf1/YbzlVomLJ468x+cv+xX
SZvHDgYHuH36zx6ZODHB+Tw9HfKfjjDD+S9TJ0Vs1GWF8wX2JFje38IG5/f2
TxPjV+KA8zd1/b3M38EJ5ysyaVrW83DD+c++7Z71oYwHzv+aLrzkwn9eOH8N
w5zexkZ+OD+G+5jlrBIBOL8jZAHDanNBOD8+Zt3RPW8R/OhF8+6xbhaC87Vr
lqdvLxGG85eKPHmXqSkC57u+ZjoV/BbBn9AQuthuiSicv27lgTcTw8Xg/E8C
fF0yUuJw/kOzftUV5xH8r7M+iWRPkYDz707KK5kWKgnn53vKXTrEKQXnq9tt
aFY7i+B3fSw17m6WhvMPWIQER5jJwPky+0SOx/xA8JWZOC2T1srC+f4t9//N
K5SD89WOvjx0R0Mezr8wk+d70x0EP+Bah/0GfwU4n89+adP8VQj+vWOb8rV4
FeH8GTPOTHmZi+Cv8GSw1DyB4J+SVG1n0VKC851OJocktCL4Sw6ti/xwD8GX
uP2KQ8ZBGc5/dMnB/MQsBD+kq1si5SyCf9Tx2s///xF8AEgniqw=
          "]]}, "Charting`Private`Tag#2"]}}, {}}, <|
    "HighlightElements" -> <|
      "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
     "LayoutOptions" -> <|
      "PanelPlotLayout" -> <||>, "PlotRange" -> {All, {0., 1.}}, 
       "Frame" -> {{False, False}, {False, False}}, 
       "AxesOrigin" -> {1.0000001836734715`, 0}, 
       "ImageSize" -> {576, 576/GoldenRatio}, "Axes" -> {True, True}, 
       "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
         Directive[
          Opacity[1.], 
          AbsoluteThickness[2], 
          Dashing[{0, Small}], 
          GrayLevel[0]], 
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]]}, 
       "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), 
         "ScalingFunctions" -> {{Identity, Identity}, {Identity, Identity}}|>,
        "Primitives" -> {}, "GCFlag" -> False|>, 
     "Meta" -> <|
      "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
       Plot, "GroupHighlight" -> False|>|>, "DynamicHighlight"]],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox[
     TagBox["\"Input coherent state amplitude \[Gamma]\"", HoldForm], 
     TraditionalForm], 
    FormBox[
     TagBox["\"phase estimation improvement\"", HoldForm], TraditionalForm]},
  AxesOrigin->{1.0000001836734715`, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.929103648678112*^9, 3.929103686143764*^9}, {
   3.92910373385146*^9, 3.929103764977265*^9}, 3.929434150658032*^9, 
   3.929434234437051*^9, 3.9295159219409*^9, 3.92951987769389*^9, 
   3.929606284994075*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"bbb56bec-726c-4089-b343-6de2b3741d41"]
}, Open  ]],

Cell[TextData[StyleBox["Characteristic functions",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.9288301696625957`*^9, 
  3.928830174796299*^9}},ExpressionUUID->"6f743431-7967-4419-b533-\
60392802e628"],

Cell[TextData[{
 "Such a state offers metrological advantage, and here we show that it can be \
produced from bimodal input of coherent and vacuum states. First, let\
\[CloseCurlyQuote]s calculate its characteristic function with respect to the \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "709b43a9-01d6-4eb6-933f-920a12ea51db"],
 " group corresponding to the interferometer action. The ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "26eafe96-bacc-47a6-b35b-79e6d980de3e"],
 " parameter is exactly the angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b25ab966-c4b8-447a-a668-09f8de3865ea"],
 " of differential phase shift inside the interferometer. \nThe ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ca7f768f-fb08-41fa-9374-be408db68005"],
 " group is a subgroup of the overall ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0f198cc3-d252-4748-af09-e6feae6d5f65"],
 " structure, related to arbitrary mode mixing operations. Let us notice that \
the matrix describing the interferometer action on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["a", "TI"], "1"], ",", 
         SubscriptBox[
          StyleBox["a", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "a_1, a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "613a3300-45f1-4f6e-bd66-55dba538a885"],
 " operators is indeed a standard 2D rotation, which can be thought of as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["U", "TI"], "(", "1", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "U(1)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1841430b-0cfd-4925-88d0-237ffab9d827"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929104138228947*^9, 3.929104330896306*^9}, {
  3.929434529366324*^9, 3.929434571308627*^9}, {3.9294346106097403`*^9, 
  3.929434670359533*^9}, {3.929434721779547*^9, 3.929434726116576*^9}, {
  3.929434791272606*^9, 
  3.929434858244568*^9}},ExpressionUUID->"477af2e5-eed7-47ee-90ba-\
3bb6eff880be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"B", "\[ConjugateTranspose]"}], ".", "P", ".", "B"}], ")"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "//", "FullSimplify"}],
   "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.92943472692667*^9, 3.929434761030216*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"ca0732f6-37bc-48a1-a3d7-047171f1c90d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.929434731935095*^9, 3.929434761424795*^9}, 
   3.92943485933433*^9, 3.929515934155878*^9, 3.929519879087347*^9, 
   3.929606289026248*^9, 3.9296078710427437`*^9},
 CellLabel->
  "Out[357]//MatrixForm=",ExpressionUUID->"7a778a91-eab0-4faa-9e08-\
5cf0031de248"]
}, Open  ]],

Cell[TextData[{
 "Comparing it to the most general form of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "59aa103d-5184-4876-a38f-127a1fc89f1f"],
 " matrix , ",
 Cell[BoxData[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"u", 
      RowBox[{"-", 
       RowBox[{"v", "\[Conjugate]"}]}]},
     {"v", 
      RowBox[{"u", "\[Conjugate]"}]}
    }], "\[NoBreak]", ")"}]], "Input",
  CellChangeTimes->{{3.928844015916676*^9, 3.9288440160807743`*^9}},
  ExpressionUUID->"45523dd9-88e8-405b-adbe-c5c2526e6124"],
 ", we see that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["u", "TI"], "\[LongEqual]", "cos", "\[Theta]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "u=\\cos{{\\theta}}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e06f7dae-73c7-4174-a3da-2d90bd17b167"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", "sin", "\[Theta]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "v=\\sin{\\theta}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e4939087-e646-4886-bdbd-046a9480ff4e"],
 ". With ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", 
         StyleBox["u", "TI"], "+", 
         StyleBox["i", "TI"], 
         StyleBox["v", "TI"], "\[LongEqual]", "exp", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "\[Theta]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "z=u+i v=\\exp(i\\theta)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "967afdb2-8163-46f4-9689-30ea2ee0a10a"],
 " (and the constraint that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", 
         StyleBox["z", "TI"], "|", "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\lvert z\\rvert=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ac0ae8f-80f0-4ca5-a91f-8426c98708ce"],
 "), one can write the matrix as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "z"}]], 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"1", "+", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]},
        {
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}], 
         RowBox[{"1", "+", 
          SuperscriptBox["z", "2"]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], TraditionalForm]],ExpressionUUID->
  "5f5efa57-2e32-417b-a517-3392fcd82f95"],
 ", and this can be directly used in the calculation of the characteristic \
functions related to the interferometer action. \n\nThe initial state is",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\tau\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "834fa225-7aad-48c2-8820-278875f310dd"],
 " , where  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]", "\[LongEqual]", "cos", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]", "+", "sin", "\[Tau]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "2", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\tau\\rangle=\\cos\\tau \\lvert\\!\\!0\\rangle+\\sin\\tau\
\\lvert\\!\\!2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "98650aed-eb08-48e8-a24c-12a6ff58b8c4"],
 " and  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-|", "\[Alpha]", 
            SuperscriptBox["|", "2"]}]], 
         UnderscriptBox["\[Sum]", 
          StyleBox["n", "TI"], LimitsPositioning -> True], 
         FractionBox[
          SuperscriptBox["\[Alpha]", 
           StyleBox["n", "TI"]], 
          SqrtBox[
           RowBox[{
             StyleBox["n", "TI"], "!"}]]], "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "\[RightAngleBracket]"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle=e^{-\\lvert \
\\alpha\\rvert^2}\\sum_{n}\\frac{\\alpha^n}{\\sqrt{n!}} \
\\lvert\\!\\!n\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b726d83c-da7d-48d8-a940-b89dbc2363fe"],
 " is a coherent state, and in the product basis the total state can be \
written as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Psi]", 
         "\[RightAngleBracket]", "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-|", "\[Alpha]", 
            SuperscriptBox["|", "2"]}]], 
         RowBox[{"(", 
           RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
             RowBox[{"0", ",", "0"}]}], "\[RightAngleBracket]"}], "cos", 
         "\[Tau]", "+", "\[Alpha]", "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", 
         RowBox[{"1", ",", "0"}], "\[RightAngleBracket]", "cos", "\[Tau]", 
         "+", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "2"}], LimitsPositioning -> 
          True], 
         RowBox[{"[", 
           RowBox[{
             FractionBox[
              SuperscriptBox["\[Alpha]", 
               StyleBox["n", "TI"]], 
              SqrtBox[
               RowBox[{
                 StyleBox["n", "TI"], "!"}]]], "|", "\[NegativeThinSpace]", 
             "\[NegativeThinSpace]", 
             StyleBox["n", "TI"], ",", "0"}], "\[RightAngleBracket]"}], "cos",
          "\[Tau]", "-", 
         FractionBox[
          SuperscriptBox["\[Alpha]", 
           RowBox[{
             StyleBox["n", "TI"], "-", "2"}]], 
          SqrtBox[
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 StyleBox["n", "TI"], "-", "2"}], ")"}], "!"}]]], "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "-", "2", ",", "2", "\[RightAngleBracket]", 
         "sin", "\[Tau]", "]", ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\psi\\rangle=e^{-\\\
lvert \\alpha\\rvert^2}\\left( \
\\lvert\\!\\!{0,0}\\rangle\\cos\\tau+\\alpha\\lvert\\!\\!{1,0}\\rangle\\cos\\\
tau+\\sum_{n=2} [\\frac{\\alpha^n}{\\sqrt{n!}} \\lvert\\!\\! n,0\\rangle  \
\\cos\\tau-\\frac{\\alpha^{n-2}}{\\sqrt{(n-2)!}}  \\lvert\\!\\! n-2,2\\rangle \
\\sin\\tau ] \\right)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "19ca021b-1053-4ca7-bc16-6a6e2928d512"],
 " .\nThus, for characteristic function we need only the matrix elements of \
the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["S", "TI"], 
         StyleBox["U", "TI"], 
         RowBox[{"(", "2", ")"}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "SU(2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e5f8fa0d-7db6-46f3-8316-e3f654d29f08"],
 " unitary representation between ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], ",", "0", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\! n,0\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db25b241-0871-4198-8ec1-dc06fb11f6c2"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         StyleBox["n", "TI"], "-", "2", ",", "2", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\! n-2,2\\rangle", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1f17a803-275e-4d7b-acc8-5a75ea9be21e"],
 "  states. They can be found explicitly, and the following code defines the \
matrix elements (as a ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"2", "\[Cross]", "2"}], TraditionalForm], "errors" -> {}, 
     "input" -> "2\\times 2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b855061-f912-4c9f-8da7-abdc556b2b23"],
 " matrix) in the function ",
 StyleBox["RedSU2",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.929434861314918*^9, 3.9294349956800747`*^9}, {
  3.9294350350605283`*^9, 3.929435153520013*^9}, {3.9294354602770643`*^9, 
  3.929435597700728*^9}, {3.929518336494903*^9, 
  3.92951835832664*^9}},ExpressionUUID->"e39aa447-bbab-44ae-b8e1-\
3ffcda782ec1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"statetopoly", "[", 
    RowBox[{"j_", ",", "\[Psi]_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"j", "-", "m"}], ")"}]}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"2", "j"}], ",", 
         RowBox[{"j", "-", "m"}]}], "]"}], "]"}], 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "m"}], ")"}], "+", "1"}], "]"}], "]"}], 
      RowBox[{"z1", "^", 
       RowBox[{"(", 
        RowBox[{"j", "+", "m"}], ")"}]}], 
      RowBox[{"z2", "^", 
       RowBox[{"(", 
        RowBox[{"j", "-", "m"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "j"}], ",", "j"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Majorana", " ", "polynomial", " ", "for", " ", "a", " ", "given", " ", 
    "state", " ", "\[Psi]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transformpoly", "[", 
    RowBox[{"poly_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"poly", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z1", ",", "z2"}], "}"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z1", ",", "z2"}], "}"}], ".", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"u", 
            RowBox[{"-", "v"}]},
           {"V", "U"}
          }], "\[NoBreak]", ")"}]}], ")"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getcoeff", "[", 
    RowBox[{"j_", ",", "poly_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "coeff", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff", " ", "=", 
       RowBox[{"Reverse", "@", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"poly", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeff", "=", 
       RowBox[{"Diagonal", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"coeff", "=", 
       RowBox[{"coeff", " ", "*", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}]}], "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"2", "*", "j"}], ",", 
              RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"2", "j"}], "+", "1"}]}], "}"}]}], "]"}]}]}]}]}], 
    "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"state", " ", "for", " ", "a", " ", "given", " ", "polynomial"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SU2Unitary", "[", "j_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basisstates", ",", "basispolys", ",", "z"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"basisstates", "=", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{
         RowBox[{"2", "j"}], "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"basispolys", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"transformpoly", "[", 
          RowBox[{
           RowBox[{"statetopoly", "[", 
            RowBox[{"j", ",", "#", ",", 
             RowBox[{"{", 
              RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], "&"}], "/@", 
        "basisstates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"getcoeff", "[", 
         RowBox[{"j", ",", "#", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}], "&"}], "/@", 
       "basispolys"}]}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Hilbert", " ", "state", " ", "picture", " ", "of", " ", "the", " ", 
    "transformation", " ", "defined", " ", "in", " ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"how", " ", "are", " ", "basis", " ", "states", " ", 
      RowBox[{"transformed", "?"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SU2Unitary", "[", 
   RowBox[{"jmin_", ",", "jmax_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Hold", "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SU2Unitary", "[", "j", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jmin", ",", "jmax", ",", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "]"}], "//", 
    "ReleaseHold"}], "//", "ArrayFlatten"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SUB1Unitary", "[", "j_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"SU2Unitary", "[", "j", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "+", 
          RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], ",", 
      RowBox[{"v", "->", 
       RowBox[{"\[ImaginaryI]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}]}], ",", 
      RowBox[{"U", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "+", 
          RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], ",", 
      RowBox[{"V", "->", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "z"}], "-", "z"}], ")"}], "/", "2"}]}]}]}], 
     "}"}]}], "//", "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RedSU2", "[", "j_", "]"}], ":=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SuperscriptBox["u", 
        RowBox[{"2", "j"}]], 
       RowBox[{
        SqrtBox[
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"2", "j"}], ",", "2"}], "]"}]], " ", 
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "2"}]], " ", 
        SuperscriptBox["V", "2"]}]},
      {
       RowBox[{
        SqrtBox[
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"2", "j"}], ",", "2"}], "]"}]], " ", 
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "2"}]], " ", 
        SuperscriptBox["v", "2"]}], 
       RowBox[{
        SuperscriptBox["u", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "4"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["U", "2"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "j"}], "-", "4"}], ")"}], " ", "u", " ", "U", " ", 
           "v", " ", "V"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "j"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "j"}]}], ")"}], " ", 
           SuperscriptBox["v", "2"], " ", 
           SuperscriptBox["V", "2"]}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]}], "Input",
 CellChangeTimes->{{3.928844015916676*^9, 3.9288440160807743`*^9}, {
  3.9294356011077003`*^9, 3.929435609102232*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"7f765123-f10d-4ce3-9553-995633c30e81"],

Cell[TextData[{
 "Characteristic  function  is parameterized by a complex variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a6966fa-abaf-4c2f-92c6-55f0ac62064f"],
 ", as mentioned before. The characteristic function can be calculated \
explicitly by the following code block. Here, for simplification we \
reparameterize ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cos", "\[Tau]", "\[RightTeeArrow]", 
         SqrtBox[
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\cos\\tau \\mapsto \\sqrt{1-r}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "730c296d-9a13-4bbf-b60c-72f71b9f5c3d"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", "\[Tau]", "\[RightTeeArrow]", 
         SqrtBox[
          StyleBox["r", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\sin\\tau\\mapsto\\sqrt{r}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e9a62f4a-f71a-4215-aa3c-9518d9259974"],
 ", perform the summation, and switch back to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b84560c2-8345-41d8-9bc7-ea96bcc48cb6"],
 " variables at the end; the characteristic function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Chi]", "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\chi(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20be789b-6da4-4870-8c18-241e3b36c27d"],
 " is exactly the overlap between the output of the interferometer and its \
input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Tau]", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!\\tau\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "17da9948-da06-493f-ae75-ff321241f44e"],
 ", for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "exp", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "\[Theta]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "z=\\exp(i\\theta)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "10073d3a-269f-4018-aa77-fa74d141a1c6"],
 "."
}], "Text",
 CellChangeTimes->{{3.929104338727257*^9, 3.929104349839161*^9}, {
  3.929104654778036*^9, 3.929104687844733*^9}, {3.929435646943065*^9, 
  3.929435725501505*^9}, {3.929435771333397*^9, 
  3.929435896710464*^9}},ExpressionUUID->"5254597e-d0ab-4e49-a673-\
c469d2754bb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"u", "=", 
       FractionBox[
        RowBox[{"z", "+", 
         RowBox[{"1", "/", "z"}]}], "2"]}], ",", 
      RowBox[{"U", "=", 
       FractionBox[
        RowBox[{"z", "+", 
         RowBox[{"1", "/", "z"}]}], "2"]}], ",", 
      RowBox[{"v", "=", 
       FractionBox[
        RowBox[{"z", "-", 
         RowBox[{"1", "/", "z"}]}], 
        RowBox[{"2", "\[ImaginaryI]"}]]}], ",", 
      RowBox[{"V", "=", 
       FractionBox[
        RowBox[{"z", "-", 
         RowBox[{"1", "/", "z"}]}], 
        RowBox[{"2", "\[ImaginaryI]"}]]}], ",", "n"}], "}"}], ",", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vec", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "/", "2"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Gamma]", "n"], 
           SqrtBox[
            RowBox[{"1", "-", "r"}]]}], 
          SqrtBox[
           RowBox[{"n", "!"}]]], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", 
            SuperscriptBox["\[Gamma]", 
             RowBox[{"n", "-", "2"}]]}], 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}], "!"}]]], 
          SqrtBox["r"]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"covec", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "/", "2"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "n"], 
           SqrtBox[
            RowBox[{"1", "-", "r"}]]}], 
          SqrtBox[
           RowBox[{"n", "!"}]]], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], 
             RowBox[{"n", "-", "2"}]]}], 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}], "!"}]]], 
          SqrtBox["r"]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ex0", "=", 
      RowBox[{
       RowBox[{"covec", ".", 
        RowBox[{"RedSU2", "[", "j", "]"}], ".", "vec"}], "//", "Expand"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ex1", "=", "ex0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"ex1", ",", 
         RowBox[{"Assumptions", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", ">=", "2"}], ",", 
            RowBox[{"r", ">", "0"}], ",", 
            RowBox[{"r", "<", "1"}]}], "}"}]}]}], "]"}], "//", "Expand"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{"ex2", "/.", 
       RowBox[{
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "r", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], "!"}], " ", 
            RowBox[{"n", "!"}]}], ")"}]}]], ":>", 
        RowBox[{
         RowBox[{"n", "!"}], 
         SqrtBox[
          RowBox[{"r", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ex2", "=", 
      RowBox[{"ex2", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"ex2", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "2", ",", "\[Infinity]"}], "}"}]}], "]"}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Gamma]"}], " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "z"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["z", "2"]}], ")"}], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "z"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{
       RowBox[{"\[Chi]", "/.", 
        RowBox[{"{", 
         RowBox[{"r", "->", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"]}]}], "}"}]}], "//", 
       "Simplify"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.928835865621401*^9, 3.928836032169384*^9}, {
   3.928836079526668*^9, 3.928836137177278*^9}, {3.928836171615386*^9, 
   3.9288361887964582`*^9}, {3.928836245494801*^9, 3.928836284864968*^9}, {
   3.928836338163987*^9, 3.928836488812563*^9}, {3.9288365271133842`*^9, 
   3.928836598287652*^9}, {3.928836695563793*^9, 3.928836871863175*^9}, {
   3.928836912754777*^9, 3.928836914937295*^9}, {3.928836954116003*^9, 
   3.928837054772881*^9}, {3.92883710071955*^9, 3.92883719396315*^9}, {
   3.928837275774677*^9, 3.9288374468413*^9}, {3.928837511028903*^9, 
   3.928837597654594*^9}, 3.928837849140325*^9, {3.92883787970463*^9, 
   3.928837880567122*^9}, {3.928838087714375*^9, 3.92883813404102*^9}, {
   3.928838328477874*^9, 3.928838433672863*^9}, {3.928839036380371*^9, 
   3.928839045617124*^9}, {3.928839437294225*^9, 3.92883950625383*^9}, {
   3.928839583048129*^9, 3.928839584365975*^9}, {3.928839731184886*^9, 
   3.928839744736106*^9}, {3.9288398009540043`*^9, 3.9288398256977997`*^9}, {
   3.928840033811348*^9, 3.928840034406275*^9}, {3.928840145730562*^9, 
   3.928840145866111*^9}, 3.92884063049382*^9, {3.928844035511318*^9, 
   3.92884403643027*^9}, {3.929104371904838*^9, 3.92910441015731*^9}, {
   3.929104459455519*^9, 3.929104467475481*^9}, {3.9291045365838213`*^9, 
   3.929104636169947*^9}, {3.929104693044354*^9, 3.9291047349805803`*^9}, {
   3.929104800792921*^9, 3.929104935377956*^9}, {3.92910519422802*^9, 
   3.929105235057697*^9}, {3.9294357666938467`*^9, 3.929435767469143*^9}, {
   3.929435801278122*^9, 3.929435808435357*^9}, {3.929435916534561*^9, 
   3.929435917512598*^9}, {3.929435956753663*^9, 3.92943595694708*^9}, {
   3.929435997518243*^9, 3.929436027643856*^9}, {3.92943633301816*^9, 
   3.9294363559867*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"6d9dba03-a33a-475b-9169-89547d2fb890"],

Cell[TextData[{
 "It  is a rather complex expression involving the defining variables ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ffe11949-ebf4-478b-8cac-6a768a2c3922"],
 " (coherent state amplitude), ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d3bb7a5-9abc-4fca-9da5-9065f5ef5f1f"],
 " (squeezed state approximation parameter), and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0d72a360-dfac-451c-8b1c-f697f333771d"],
 " (describing the interferometer phase difference angle). If we plug in the \
calculated (in the previous section) optimal angle we obtain:"
}], "Text",
 CellChangeTimes->{{3.9294359736319437`*^9, 3.929435982415983*^9}, {
  3.929436042215863*^9, 
  3.929436135496669*^9}},ExpressionUUID->"130d0ac1-556b-4f33-a082-\
644e1d3f4d13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Chi]opt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Tau]", "->", "\[InvisibleSpace]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ArcTan", "[", 
          FractionBox["1", 
           SqrtBox["2"]], "]"}]}]}], "}"}]}], "//", "TrigToExp"}], "//", 
    "Expand"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.929435968056211*^9, 3.929435970184808*^9}, {
  3.92943613685322*^9, 3.9294361379857283`*^9}, {3.929436364001829*^9, 
  3.929436395082978*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"bf5ded0b-f9a8-427c-9293-a13e3c7e66c8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    SqrtBox["6"], " ", 
    SuperscriptBox["z", "4"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}], "-", 
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SuperscriptBox["z", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]], " ", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
           RowBox[{"2", " ", "z"}]]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"], "+", 
           SuperscriptBox["\[Gamma]", "2"], "+", 
           RowBox[{
            SuperscriptBox["z", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"6", " ", 
               SqrtBox["6"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Gamma]", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["z", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              SqrtBox["6"], "+", 
              SuperscriptBox["\[Gamma]", "2"]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"8", " ", "z", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]], " ", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[Gamma]", " ", 
           RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
           RowBox[{"2", " ", "z"}]]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]}], ")"}], " ", 
      "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
         RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
        RowBox[{"2", " ", "z"}]]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["z", "2"]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SqrtBox["6"]}], ")"}], " ", 
         SuperscriptBox["z", "4"], " ", 
         SuperscriptBox["\[Gamma]", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"8", "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              SqrtBox["6"]}], ")"}], " ", 
            SuperscriptBox["\[Gamma]", "2"]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.929435970617123*^9, 3.9294360392916193`*^9, 3.929436090679518*^9, 
   3.929436138436926*^9, {3.929436387227943*^9, 3.929436395999606*^9}, 
   3.92951595586476*^9, 3.929519892641469*^9, 3.929607888655736*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"2c05a90d-6ca6-42aa-a364-373907d52cc0"]
}, Open  ]],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Tau]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\tau=0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1b1839f1-625a-448e-bf41-8af9666aafcc"],
 ", the characteristic function corresponds to the interferometer input being \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma\\rangle\\otimes\\lvert\\!\\!0\\rangle", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f2bd44da-d8bd-4fdd-a453-b0e495eb7df9"],
 " \[Dash] coherent in the first port, vacuum in the second. As it turns out, \
the form of the characteristic function of this state is a (rescaled) \
generating function of the modified Bessel functions ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], "(", 
         StyleBox["a", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5c1bf090-24d6-4468-ade2-a832090c2ce4"],
 " (see Appendix B of [1], Eq. B.51), and can be decomposed into a sum ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Chi]", "\[LongEqual]", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[Element]", 
            StyleBox["Z", FontSlant -> "Plain"]}], LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["k", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            SuperscriptBox["\[Gamma]\[Gamma]", "*"]}]], 
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           SuperscriptBox["\[Gamma]\[Gamma]", "*"], ")"}]}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "\\chi=\\sum_{k\\in \\mathbb{Z}} z^k e^{-\\gamma \\gamma^*}I_k(\\gamma \
\\gamma^*)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e942b33e-e385-422c-a77a-9bad368a62a8"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929436156090006*^9, 3.929436217969096*^9}, {
  3.929436521193947*^9, 3.92943658003662*^9}, {3.929516850874923*^9, 
  3.929516866947013*^9}, {3.929518419251515*^9, 3.929518467713565*^9}, {
  3.92952067648927*^9, 3.9295206781825333`*^9}, {3.9295207352552433`*^9, 
  3.929520769767442*^9}, {3.929520832107142*^9, 
  3.929520863266062*^9}},ExpressionUUID->"96eb2e9c-435b-4da2-ba6f-\
6cce03e83b92"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Chi]coh", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]", "/.", 
     RowBox[{"\[Tau]", "->", "0"}]}], "//", "FullSimplify"}], "//", 
   "PowerExpand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BesselIGeneratingFn", "[", 
   RowBox[{"a_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"a", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{"1", "/", "z"}]}], ")"}], "/", "2"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Is \!\(\*SubscriptBox[\(\[Chi]\), \(\(coherent\)\(\\\ \)\)]\)equal to \
\!\(\*SuperscriptBox[\(e\), \(\(-\[Gamma]\)\\\  \[Gamma]\[Conjugate] \
\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(\[Sum]\), \(\[Infinity]\)], \(k = \
\(-\[Infinity]\)\)]\)\!\(\*SuperscriptBox[\(z\), \
\(k\)]\)\!\(\*SubscriptBox[\(I\), \(k\)]\)(\[Gamma]\[Gamma]\[Conjugate])? :\>\
\"", ",", 
   RowBox[{
    RowBox[{"\[Chi]coh", "==", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", 
        RowBox[{"\[Gamma]", "\[Conjugate]"}]}], "]"}], 
      RowBox[{"BesselIGeneratingFn", "[", 
       RowBox[{
        RowBox[{"\[Gamma]", " ", 
         RowBox[{"\[Gamma]", "\[Conjugate]"}]}], ",", "z"}], "]"}]}]}], "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ck", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]], " ", 
    RowBox[{"BesselI", "[", 
     RowBox[{"k", ",", 
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9294362202147284`*^9, 3.929436280897497*^9}, {
  3.929436405124446*^9, 3.929436429250927*^9}, {3.9294364938053927`*^9, 
  3.929436515068973*^9}, {3.929436582384362*^9, 3.929436588342338*^9}, {
  3.929436682209029*^9, 3.929436721949092*^9}, {3.9294390701264057`*^9, 
  3.929439160734522*^9}, {3.929439197481487*^9, 3.929439198392118*^9}, {
  3.929439234813191*^9, 3.929439263924613*^9}, {3.929439295839961*^9, 
  3.929439381771067*^9}, {3.92943941296488*^9, 3.929439548810053*^9}, {
  3.929439812024003*^9, 3.929439885329472*^9}, {3.929440748501072*^9, 
  3.929440769176251*^9}, {3.929516879185458*^9, 3.929517034738635*^9}, {
  3.929518475164882*^9, 3.929518551155999*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"b4bb6867-fd32-4a33-aa04-98bed124fbc6"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "z"}], ")"}], "2"], " ", "\[Gamma]", " ", 
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
   RowBox[{"2", " ", "z"}]]]], "Output",
 CellChangeTimes->{{3.929439149700138*^9, 3.929439161136772*^9}, {
   3.92943924904593*^9, 3.929439264290958*^9}, {3.929439307008562*^9, 
   3.92943934202562*^9}, {3.929439375251663*^9, 3.929439382012821*^9}, {
   3.929439418798646*^9, 3.9294394975589437`*^9}, {3.929439528125622*^9, 
   3.929439549320179*^9}, {3.92943982803125*^9, 3.929439885948931*^9}, {
   3.929440760614939*^9, 3.929440769680421*^9}, 3.929515965264391*^9, {
   3.929516879965859*^9, 3.929516917728491*^9}, {3.9295169477481203`*^9, 
   3.929516968581228*^9}, 3.929517035097662*^9, 3.929518475785369*^9, {
   3.9295185289646072`*^9, 3.929518552416358*^9}, 3.929519892778652*^9, 
   3.929520864412726*^9, 3.929607888805978*^9},
 CellLabel->
  "Out[367]=",ExpressionUUID->"1e1186dd-8e59-4d25-84dd-350212bb87ec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Is \\!\\(\\*SubscriptBox[\\(\[Chi]\\), \
\\(\\(coherent\\)\\(\\\\ \\)\\)]\\)equal to \\!\\(\\*SuperscriptBox[\\(e\\), \
\\(\\(-\[Gamma]\\)\\\\  \[Gamma]\[Conjugate] \
\\)]\\)\\!\\(\\*SubscriptBox[SuperscriptBox[\\(\[Sum]\\), \\(\[Infinity]\\)], \
\\(k = \\(-\[Infinity]\\)\\)]\\)\\!\\(\\*SuperscriptBox[\\(z\\), \
\\(k\\)]\\)\\!\\(\\*SubscriptBox[\\(I\\), \\(k\\)]\\)(\[Gamma]\[Gamma]\
\[Conjugate])? :\"\>", "\[InvisibleSpace]", "True"}],
  SequenceForm[
  "Is \!\(\*SubscriptBox[\(\[Chi]\), \(\(coherent\)\(\\ \)\)]\)equal to \
\!\(\*SuperscriptBox[\(e\), \(\(-\[Gamma]\)\\  \[Gamma]\[Conjugate] \)]\)\!\(\
\*SubscriptBox[SuperscriptBox[\(\[Sum]\), \(\[Infinity]\)], \(k = \(-\
\[Infinity]\)\)]\)\!\(\*SuperscriptBox[\(z\), \
\(k\)]\)\!\(\*SubscriptBox[\(I\), \(k\)]\)(\[Gamma]\[Gamma]\[Conjugate])? :", 
   True],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9295185289661694`*^9, 3.929518552417985*^9}, 
   3.9295198927948637`*^9, 3.929520864414058*^9, 3.929607888830181*^9},
 CellLabel->
  "During evaluation of \
In[367]:=",ExpressionUUID->"6754e3f2-0090-4ccb-ae73-883d22bf7ce8"]
}, Open  ]],

Cell[TextData[{
 "The  characteristic function ",
 StyleBox["\[Chi]opt",
  FontWeight->"Bold"],
 " of the optimal state is the one of the coherent state ",
 StyleBox["\[Chi]coh",
  FontWeight->"Bold"],
 " multiplied by a expression involving powers of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f43dacd8-7303-4d48-9d2d-e29340f0c2d0"],
 " from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["z", "TI"], "-4"], TraditionalForm], "errors" -> {}, "input" -> 
     "z^{-4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "728de9af-cbe1-428c-9b44-a4d6e577b274"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["z", "TI"], "4"], TraditionalForm], "errors" -> {}, "input" -> 
     "z^{4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0e7de1c8-f2ef-4de0-84c5-d6e34808fcd5"],
 ":"
}], "Text",
 CellChangeTimes->{{3.929436459106413*^9, 3.929436478762716*^9}, {
   3.929439592956551*^9, 3.9294396859657183`*^9}, 
   3.929439799041803*^9},ExpressionUUID->"71cab039-3de7-40a2-a986-\
856847ad4839"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"charfnprod", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["\[Chi]opt", 
           RowBox[{"\[Chi]coh", " ", 
            SuperscriptBox["z", 
             RowBox[{"-", "4"}]]}]], "//", "FullSimplify"}], ")"}], 
        SuperscriptBox["z", 
         RowBox[{"-", "4"}]]}], "//", "Expand"}], ")"}], ",", "z"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.928835507715638*^9, 3.928835576502369*^9}, {
  3.928835614315892*^9, 3.928835651769873*^9}, {3.928835717491887*^9, 
  3.928835725000546*^9}, {3.928836661330082*^9, 3.928836685920833*^9}, {
  3.92910501451429*^9, 3.929105021080008*^9}, {3.929436445428214*^9, 
  3.929436456603797*^9}, {3.929439712150739*^9, 3.929439794082394*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"e8fdb5b9-f07c-46f2-b00a-0b73aadb0691"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], "+", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["6"]}]], "-", 
  FractionBox[
   SuperscriptBox["\[Gamma]", "2"], 
   RowBox[{"4", " ", 
    SqrtBox["6"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "32"], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["3", "2"]], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
  FractionBox[
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "64"], "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
     RowBox[{"32", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "4"]], "+", 
  RowBox[{
   SuperscriptBox["z", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "64"], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
      RowBox[{"32", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
   RowBox[{"4", " ", 
    SqrtBox["6"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "8"], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "3"]], "+", 
  RowBox[{
   SuperscriptBox["z", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "8"], " ", "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "-", 
     FractionBox[
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], " ", "\[Gamma]", " ", 
     RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]]}], "z"], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], " ", "\[Gamma]", " ", 
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], "+", 
     FractionBox[
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    FractionBox["1", "8"], "-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      SqrtBox["6"]}]], "+", 
    FractionBox[
     SuperscriptBox["\[Gamma]", "2"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]], "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "16"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
     RowBox[{"8", " ", 
      SqrtBox["6"]}]]}], 
   SuperscriptBox["z", "2"]], "+", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["1", 
      RowBox[{"4", " ", 
       SqrtBox["6"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[Gamma]", "2"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "16"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"], 
      RowBox[{"8", " ", 
       SqrtBox["6"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.928835509513639*^9, 3.928835579213209*^9}, {
   3.928835633309031*^9, 3.9288356521741877`*^9}, {3.9288357202994432`*^9, 
   3.928835725495573*^9}, {3.928836656157196*^9, 3.92883668616003*^9}, 
   3.928841370583318*^9, {3.9288438985910254`*^9, 3.928843928517374*^9}, 
   3.9288440497057257`*^9, 3.929104439801717*^9, 3.929104476055002*^9, 
   3.929105026997994*^9, 3.929105083793121*^9, 3.929105277223466*^9, 
   3.929436459659875*^9, {3.929439715655026*^9, 3.929439797069887*^9}, 
   3.92951603579163*^9, 3.929517049169763*^9, 3.929518560379745*^9, 
   3.929519895482537*^9, 3.929607891394437*^9},
 CellLabel->
  "Out[371]=",ExpressionUUID->"ecc99440-2aa2-47b5-83e0-c1a9a9ad695e"]
}, Open  ]],

Cell[TextData[{
 "Thus, the characteristic function ",
 StyleBox["\[Chi]opt",
  FontWeight->"Bold"],
 " can be written as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Chi]", "opt"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[LongEqual]", "-", "\[Infinity]"}], 
          "\[Infinity]", LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["k", "TI"]], 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\chi_{\\text{opt}}=\\sum_{k=-\\infty}^{\\infty}z^k P_k", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04822151-036e-48ee-b62a-0fe172c4ec70"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a63d564b-56a2-4282-a8f7-9086f5f1827f"],
 " is convolution of the coherent state coefficients ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["k", "TI"]], "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            SuperscriptBox["\[Gamma]\[Gamma]", "*"]}]], 
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           SuperscriptBox["\[Gamma]\[Gamma]", "*"], ")"}]}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "C_k=e^{-\\gamma \\gamma^*}I_k(\\gamma \\gamma^*)", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bed4301-9155-4c3e-b64d-2e01377057e3"],
 " and the following zero-centered list:"
}], "Text",
 CellChangeTimes->{{3.9294399242353773`*^9, 3.929439970115415*^9}, {
  3.929440000398734*^9, 3.929440082426811*^9}, {3.929440119293194*^9, 
  3.929440121213119*^9}, {3.929518569184698*^9, 3.929518569601443*^9}, {
  3.929518600351902*^9, 
  3.9295186024397917`*^9}},ExpressionUUID->"839138bd-5834-48e7-a35a-\
02d3a4d73838"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"convcoeffs", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"charfnprod", " ", 
       SuperscriptBox["z", "4"]}], " ", ",", "z"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"convcoeffs", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.928835666643525*^9, 3.928835729958687*^9}, {
  3.928835781587989*^9, 3.928835816104151*^9}, {3.928841412672934*^9, 
  3.928841439463752*^9}, {3.928841747423244*^9, 3.928841879237912*^9}, {
  3.928841970199197*^9, 3.928841971955068*^9}, {3.9288420616383133`*^9, 
  3.928842170368587*^9}, {3.928842275377273*^9, 3.928842321254661*^9}, {
  3.9288433373336*^9, 3.928843357583253*^9}, {3.9291053314304867`*^9, 
  3.929105368548133*^9}, {3.929105527709672*^9, 3.929105531166029*^9}, {
  3.929439919483512*^9, 3.929439921267784*^9}, {3.929440064110744*^9, 
  3.929440107923448*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"fc50b002-2630-4ca8-8322-d1fe8a885d4a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "192"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "24"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "48"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"2", " ", 
           SqrtBox["6"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "24"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "96"], " ", 
        RowBox[{"(", 
         RowBox[{"72", "+", 
          RowBox[{"8", " ", 
           SqrtBox["6"]}], "-", 
          RowBox[{"4", " ", 
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "-", 
          RowBox[{"4", " ", 
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "24"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        FractionBox["1", "48"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"2", " ", 
           SqrtBox["6"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             SqrtBox["6"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}], "+", 
          RowBox[{
           SqrtBox["6"], " ", 
           SuperscriptBox[
            RowBox[{"Conjugate", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "24"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", "\[Gamma]", " ", 
        RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "192"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SqrtBox["6"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.928842081310185*^9, 3.928842170726266*^9}, {
   3.928842278327949*^9, 3.928842321609696*^9}, {3.928843340935176*^9, 
   3.9288433584007587`*^9}, 3.928843899804861*^9, 3.928843930028338*^9, 
   3.928844051752718*^9, {3.929105357192143*^9, 3.929105369177505*^9}, 
   3.929105531584475*^9, 3.9294399223705397`*^9, {3.929440064403727*^9, 
   3.9294401224867783`*^9}, 3.929517056131875*^9, {3.9295185954202127`*^9, 
   3.929518603403113*^9}, 3.9295198958132553`*^9, 3.92960789169312*^9},
 CellLabel->
  "Out[373]//MatrixForm=",ExpressionUUID->"87d02996-bb14-4dbd-9617-\
4de61f176110"]
}, Open  ]],

Cell[TextData[{
 "Let' s  assume that the coherent light amplitude is real an positive; then ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[LongEqual]", 
         SqrtBox[
          StyleBox["a", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma=\\sqrt{a}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2eed41ae-af70-481b-9e84-eb565d3e2b35"],
 " and the tails of the resulting ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9495d40-9576-4ca1-b39a-b965cb8389f1"],
 " determine feasibility of the state extraction. The state can be extracted \
if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["k", "TI"]], "\[LongEqual]", 
         StyleBox["p", "TI"], 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"]], "+", 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             StyleBox["p", "TI"]}], ")"}], 
         SubscriptBox[
          StyleBox["D", "TI"], 
          StyleBox["k", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "C_k=p P_k +(1-p) D_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a24f04d0-a035-4aa2-9143-dbdfe1102a14"],
 ", with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"0", "\[LessEqual]", 
         StyleBox["p", "TI"], "\[LessEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "0\\le p \\le 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c40ba93d-a7bf-45be-b2e6-d63c86ce6a56"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["D", "TI"], 
          StyleBox["k", "TI"]], "\[GreaterEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "D_k\\ge 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e0dd3567-5498-4e27-808f-249f4bcca877"],
 ": the extraction succeeds with probability ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["p", "TI"], TraditionalForm], "errors" -> {}, "input" -> "p", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a9771112-138e-48ac-8f8d-10f27bdbfda8"],
 ", and with probability ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{"1", "-", 
           StyleBox["p", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(1-p)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4d93ca64-d5d0-46b4-8d07-b03632afd3e3"],
 " a state corresponding to the probability distribution ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["D", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "D_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f77c15eb-908d-48c3-a820-31c715a11dda"],
 " is prepared. This is possible if the tails of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a0aa690b-7158-45e7-abe8-4edbb1d78b4c"],
 " (variable ",
 StyleBox["Pk",
  FontWeight->"Bold"],
 ") fall off at least as quickly as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "C_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d67eb68-2c34-4575-a8e2-530a2724b7dc"],
 ". Here we calculate the the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "44eb9b63-c4a5-4079-bb80-c34081cd8638"],
 " coefficients."
}], "Text",
 CellChangeTimes->{{3.929440172695979*^9, 3.9294401964154863`*^9}, {
  3.929440291327694*^9, 3.929440325923628*^9}, {3.929440369218334*^9, 
  3.929440375667289*^9}, {3.9294405277125*^9, 3.9294406175060883`*^9}, {
  3.929440672162531*^9, 3.929440735283312*^9}, {3.929518623221471*^9, 
  3.9295186724957657`*^9}},ExpressionUUID->"0d28ae4a-153b-45de-b2bf-\
f7e739fe95cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"convexpr", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"convcoeffs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"\[Gamma]", "->", 
          SqrtBox["a"]}]}], ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{"a", ">", "0"}], "}"}]}]}], "]"}], 
      RowBox[{"DiscreteDelta", "[", 
       RowBox[{"k", "+", "i", "-", "5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "convcoeffs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cks", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Ck", "/.", 
      RowBox[{"\[Gamma]", "->", 
       SqrtBox["a"]}]}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{"a", ">", "0"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pk", "=", 
   RowBox[{
    RowBox[{"DiscreteConvolve", "[", 
     RowBox[{"Cks", ",", "convexpr", ",", "k", ",", "l"}], "]"}], "/.", 
    RowBox[{"l", "->", "k"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928842437144192*^9, 3.928842495537055*^9}, {
   3.9291053916217403`*^9, 3.929105394720165*^9}, {3.929440199321819*^9, 
   3.9294402815884933`*^9}, 3.929440347106402*^9, {3.929440462931896*^9, 
   3.929440541520206*^9}, 3.929517364817901*^9, {3.929518894225994*^9, 
   3.929518934184603*^9}, {3.929519016238762*^9, 3.929519020214203*^9}, {
   3.929519132540462*^9, 3.9295191340387487`*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"d6706272-bcd4-49dc-9cf3-36acabaf1920"],

Cell[TextData[{
 "Asymptotically (for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "k\\rightarrow\\infty", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3a3a5ef7-ffb0-49b7-ae4c-905e6cfa8cad"],
 "), the Bessel function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], "(", 
         StyleBox["a", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bcce534-c5eb-4cc5-994a-5bdea9f2cdfd"],
 " has the expansion of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["k", "TI"]], 
         RowBox[{"(", 
           StyleBox["a", "TI"], ")"}], "\[TildeTilde]", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["a", "TI"], "/", "2"}], ")"}], 
           StyleBox["k", "TI"]], 
          RowBox[{
            StyleBox["k", "TI"], "!"}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "I_k(a) \\approx \\frac{(a/2)^k}{k!}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "318f4afb-5e0d-4e5b-bf00-120bae8b12a9"],
 "(Appendix B of [1], Eq. B.47). Thus, the ratio of tails can be calculated: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["P", "TI"], 
             StyleBox["k", "TI"]], "(", 
            RowBox[{
              RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
              StyleBox["a", "TI"]}], ")"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["C", "TI"], 
             StyleBox["k", "TI"]], "(", 
            StyleBox["a", "TI"], ")"}]], "\[Rule]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{P_k ((1-\\varepsilon)a)}{C_k(a)}\\rightarrow 0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "557cc109-72b8-4d02-8ac4-45027acbb1d4"],
 " with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], "\[Rule]", "\[Infinity]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "k\\rightarrow \\infty", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "098ef6ea-8786-4e1b-910a-aba8df745e45"],
 " if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Epsilon]", ">", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\varepsilon>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bdec13e-2def-4f90-a8c0-552e94e52b0a"],
 ". Therefore, a state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", 
         SuperscriptBox["\[Gamma]", "\[Prime]"], "\[RightAngleBracket]", 
         "\[CircleTimes]", "|", "\[NegativeThinSpace]", 
         "\[NegativeThinSpace]", "\[Psi]", "\[RightAngleBracket]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert\\!\\!\\gamma' \\rangle \\otimes \\lvert\\!\\!\\psi\\rangle", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "421aac57-eabd-4391-bca0-f00abb03ec8b"],
 " can be extracted from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
        "|", "\[NegativeThinSpace]", "\[NegativeThinSpace]", "\[Gamma]", 
         "\[RightAngleBracket]", "\[CircleTimes]", "|", 
         "\[NegativeThinSpace]", "\[NegativeThinSpace]", "0", 
         "\[RightAngleBracket]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\lvert \\!\\!\\gamma\\rangle \\otimes \\lvert\\!\\!0\\rangle", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "acfc132d-06e5-4e58-9f33-e23b1d131da5"],
 " for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Gamma]", "\[Prime]"], "<", "\[Gamma]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\gamma'<\\gamma", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fae5bce1-755b-4bba-95f4-fce613e6bfe1"],
 " with nonzero probability: one has to sacrifice arbitrarily small amplitude \
of the input coherent state in order to extract the end state."
}], "Text",
 CellChangeTimes->{{3.929440782218281*^9, 3.929440785603823*^9}, {
  3.929440865280184*^9, 3.929440871268714*^9}, {3.929517068144234*^9, 
  3.929517081216177*^9}, {3.9295173730035973`*^9, 3.929517415332082*^9}, {
  3.929517544270033*^9, 3.929517550062297*^9}, {3.929517987710252*^9, 
  3.929517989072079*^9}, {3.929518021288886*^9, 3.929518063280748*^9}, {
  3.929518102193203*^9, 3.929518177137145*^9}, {3.929518240408703*^9, 
  3.929518311960938*^9}, {3.9295188335203333`*^9, 3.92951888050786*^9}, {
  3.929520777719838*^9, 
  3.929520791721651*^9}},ExpressionUUID->"34025c3b-37e3-4d4c-8880-\
241a7d4649a5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BesselIasymp", "[", 
    RowBox[{"k_", ",", "a_"}], "]"}], ":=", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", " ", 
      RowBox[{"a", "/", "2"}], ")"}], "k"], 
    RowBox[{"k", "!"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ckasymp", "=", 
   RowBox[{
    RowBox[{"BesselIasymp", "[", 
     RowBox[{"k", ",", "a"}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", "a"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pkasymp", "=", 
   RowBox[{
    RowBox[{"DiscreteConvolve", "[", 
     RowBox[{"Ckasymp", ",", "convexpr", ",", "k", ",", "l"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "a"}]}], ",", 
      RowBox[{"l", "->", "k"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Limit of \!\(\*SubscriptBox[\(P\), \(k\)]\)/\!\(\*SubscriptBox[\(C\), \
\(k\)]\) for k\[Rule]\[Infinity]: \>\"", ",", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{
      FractionBox["Pkasymp", 
       RowBox[{"Ckasymp", "\[IndentingNewLine]"}]], "//", "Expand"}], ",", 
     RowBox[{"k", "->", "\[Infinity]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Epsilon]", "<", "1"}], ",", 
        RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.928842937049304*^9, 3.9288430022443542`*^9}, {
   3.928843032596299*^9, 3.928843087615505*^9}, {3.928843143680833*^9, 
   3.928843150694783*^9}, {3.92884434001333*^9, 3.928844342397996*^9}, {
   3.928844396847191*^9, 3.9288444933514357`*^9}, 3.92884452844178*^9, 
   3.928844582857114*^9, 3.928844850266835*^9, {3.928844895487753*^9, 
   3.928844899714588*^9}, {3.928844932194846*^9, 3.928844948555367*^9}, {
   3.929105458692974*^9, 3.92910550213408*^9}, {3.92910554463015*^9, 
   3.929105544758781*^9}, {3.929105753410906*^9, 3.929105754553975*^9}, {
   3.929517592874148*^9, 3.929517681734695*^9}, {3.929517755002388*^9, 
   3.92951776099509*^9}, {3.929518037101331*^9, 3.929518038772575*^9}, {
   3.929518181748121*^9, 3.929518181885063*^9}, {3.929518220947361*^9, 
   3.929518231808968*^9}, 3.929518313900527*^9, {3.929518791554606*^9, 
   3.929518824192205*^9}, {3.929519024394299*^9, 3.929519048369509*^9}, {
   3.929519137825513*^9, 3.929519147456764*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"5339f98d-ff59-456a-8804-87087f315eea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Limit of \\!\\(\\*SubscriptBox[\\(P\\), \
\\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(C\\), \\(k\\)]\\) for \
k\[Rule]\[Infinity]: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[
  "Limit of \!\(\*SubscriptBox[\(P\), \(k\)]\)/\!\(\*SubscriptBox[\(C\), \
\(k\)]\) for k\[Rule]\[Infinity]: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.929519149295738*^9, 3.929519897441711*^9, 
  3.929607893276528*^9},
 CellLabel->
  "During evaluation of \
In[377]:=",ExpressionUUID->"f5c20425-17a5-4977-b3bf-f9cc31d5560b"]
}, Open  ]],

Cell["\<\
[1] Francesco Mainardi, Fractional Calculus and Waves in Linear \
Viscoelasticity, Francesco Mainardi (Appendix B)\
\>", "Text",
 CellChangeTimes->{{3.929520681470402*^9, 3.929520727319387*^9}, {
  3.9296078887000723`*^9, 
  3.92960789192689*^9}},ExpressionUUID->"beb3cffc-497f-43a1-b601-\
877c2b3c3e9b"]
}, Open  ]]
},
WindowSize->{805.5, 1415.25},
WindowMargins->{{Automatic, -807.75}, {-78.75, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2526b19d-949c-4101-9ec6-f428d626e6ae"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 304, 7, 222, "Title",ExpressionUUID->"11a8116b-a7a3-404f-94f0-4110b7cf94c8"],
Cell[887, 31, 322, 8, 58, "Text",ExpressionUUID->"d0b994b3-16be-4731-9d24-871a0127f604"],
Cell[1212, 41, 368, 7, 81, "Text",ExpressionUUID->"468b8d79-6b7d-4042-877c-a358d8d2fe81"],
Cell[1583, 50, 251, 5, 35, "Text",ExpressionUUID->"25439731-9b14-430c-8881-c1ba9dfdbd82"],
Cell[1837, 57, 5224, 133, 211, "Text",ExpressionUUID->"353e80a2-c3eb-4258-a6cf-e4beebfafee1"],
Cell[7064, 192, 3008, 62, 239, "Input",ExpressionUUID->"b9af32fb-3b0d-421c-bbbb-9173056c15a2"],
Cell[10075, 256, 726, 14, 104, "Text",ExpressionUUID->"b48d6638-1dea-49ff-a477-44cee38624cc"],
Cell[10804, 272, 7124, 189, 488, "Input",ExpressionUUID->"0473cb4d-5aa6-439f-a42b-b7026eeaec40"],
Cell[17931, 463, 2940, 69, 135, "Text",ExpressionUUID->"8fbd5220-25fb-431d-858e-adc7b93268ee"],
Cell[20874, 534, 1459, 40, 115, "Input",ExpressionUUID->"1fafb6b8-d35f-4851-9063-b6e1f54b3b04"],
Cell[22336, 576, 377, 7, 58, "Text",ExpressionUUID->"bd05db12-d219-4f48-88d2-4b9d37a4cba4"],
Cell[22716, 585, 410, 10, 31, "Input",ExpressionUUID->"925bc0ab-c9c7-4ee5-ab9e-21f479c1cb4e"],
Cell[23129, 597, 251, 5, 35, "Text",ExpressionUUID->"d3ce012f-b54d-4e1c-8579-c31a90c7844a"],
Cell[23383, 604, 2173, 55, 108, "Text",ExpressionUUID->"4b8aa022-6fa5-4f6b-925f-ee2390c93409"],
Cell[25559, 661, 719, 21, 31, "Input",ExpressionUUID->"c734449c-f6bd-4297-bb6c-c318eb50541d"],
Cell[26281, 684, 1118, 28, 83, "Text",ExpressionUUID->"f93d8e2c-402c-47cd-9e89-560b8705fc45"],
Cell[CellGroupData[{
Cell[27424, 716, 4306, 80, 72, "Input",ExpressionUUID->"f3fa0051-3ad0-4c1a-8fc5-36e6e57cd460"],
Cell[31733, 798, 3076, 87, 94, "Output",ExpressionUUID->"8cdb9ca8-9f7e-4bad-aafd-4c230e3e6fe8"]
}, Open  ]],
Cell[34824, 888, 986, 25, 41, "Text",ExpressionUUID->"7c124203-b043-4588-abb1-a5ed70085bf1"],
Cell[35813, 915, 321, 8, 29, "Input",ExpressionUUID->"e1288059-4795-4b91-960b-8fd7528c39eb"],
Cell[36137, 925, 339, 7, 58, "Text",ExpressionUUID->"cd976194-c723-47a7-88b9-e76026365ed4"],
Cell[CellGroupData[{
Cell[36501, 936, 1847, 45, 154, "Input",ExpressionUUID->"d3d75803-7d52-4103-aa44-45a779fd62f7"],
Cell[CellGroupData[{
Cell[38373, 985, 983, 22, 25, "Print",ExpressionUUID->"2224fe2d-4317-4dc0-a60c-7d68b3511e28"],
Cell[39359, 1009, 763, 17, 23, "Print",ExpressionUUID->"d92ef6bb-03c1-406c-904a-d81220f267db"]
}, Open  ]]
}, Open  ]],
Cell[40149, 1030, 1113, 26, 37, "Text",ExpressionUUID->"ff9523a3-24aa-41de-b148-b2c3615af9be"],
Cell[41265, 1058, 250, 5, 35, "Text",ExpressionUUID->"bb0f9ace-c590-4e13-a749-ed52fa08fb6b"],
Cell[41518, 1065, 707, 20, 37, "Text",ExpressionUUID->"d8b6e969-b2dd-46da-af83-c46c4f6d0a14"],
Cell[42228, 1087, 515, 15, 77, "Input",ExpressionUUID->"45308b44-34a9-43e3-9b65-d4add5083661"],
Cell[42746, 1104, 706, 16, 60, "Text",ExpressionUUID->"dd45bd92-90f3-4531-a081-17570ad8ca7d"],
Cell[CellGroupData[{
Cell[43477, 1124, 4978, 136, 239, "Input",ExpressionUUID->"f1549c00-d3c4-4eb4-852b-3b3c996f8b5d"],
Cell[CellGroupData[{
Cell[48480, 1264, 1627, 39, 23, "Print",ExpressionUUID->"2d2de66a-c8e2-439d-abdd-ef8e4af9107c"],
Cell[50110, 1305, 2987, 74, 112, "Print",ExpressionUUID->"9a47720f-8b9a-48fb-b23b-92bdc21f488d"]
}, Open  ]]
}, Open  ]],
Cell[53124, 1383, 1557, 39, 97, "Text",ExpressionUUID->"b5de8e3a-0a6f-40b4-a9bd-9448c1aade7f"],
Cell[54684, 1424, 445, 7, 29, "Input",ExpressionUUID->"695ad47f-4b6c-4840-be2c-510ccd93fac5"],
Cell[CellGroupData[{
Cell[55154, 1435, 1891, 40, 143, "Input",ExpressionUUID->"e66bfa79-8520-4ec8-bf6f-b0a3ba4c9df3"],
Cell[57048, 1477, 24882, 454, 221, "Output",ExpressionUUID->"292152cf-df85-48b4-97d2-7146aa690e45"]
}, Open  ]],
Cell[81945, 1934, 1619, 39, 97, "Text",ExpressionUUID->"c0c1408e-944f-435c-a93f-7a3f64888b94"],
Cell[CellGroupData[{
Cell[83589, 1977, 2723, 64, 268, "Input",ExpressionUUID->"182858f8-3e46-436e-86a2-509929521696"],
Cell[86315, 2043, 14686, 287, 247, "Output",ExpressionUUID->"893e36ca-e97e-4eaa-80e8-52db8f50b2a5"]
}, Open  ]],
Cell[101016, 2333, 279, 5, 35, "Text",ExpressionUUID->"85797ec8-37bd-41dc-907d-70e23204ed2d"],
Cell[101298, 2340, 5193, 110, 241, "Text",ExpressionUUID->"9ca9269b-87b5-4409-a84b-b69961ff3699"],
Cell[106494, 2452, 4034, 112, 154, "Input",ExpressionUUID->"9f936469-8256-4b4d-bcc0-73799fc82387"],
Cell[110531, 2566, 372, 12, 58, "Text",ExpressionUUID->"4850de06-7b2c-4f4f-8f20-ce44629c60d6"],
Cell[CellGroupData[{
Cell[110928, 2582, 179, 2, 29, "Input",ExpressionUUID->"609dcc98-0a9d-4156-950d-eb2ba7f9a006"],
Cell[111110, 2586, 2882, 84, 94, "Output",ExpressionUUID->"fc41a312-b3fe-4cf8-82c4-c3dd786985a0"]
}, Open  ]],
Cell[114007, 2673, 3024, 69, 161, "Text",ExpressionUUID->"b47f42d5-246b-4ad2-8c25-bea0a0c2437f"],
Cell[CellGroupData[{
Cell[117056, 2746, 1585, 47, 164, "Input",ExpressionUUID->"26c656fe-df68-4f3d-a245-f1fc929c23b4"],
Cell[CellGroupData[{
Cell[118666, 2797, 539, 11, 23, "Print",ExpressionUUID->"9c904324-03d7-48b7-9fe5-ba2fd4fb6aa7"],
Cell[119208, 2810, 1370, 40, 132, "Print",ExpressionUUID->"6b91bcbc-840d-47ec-b06e-5ad7b27a8306"],
Cell[120581, 2852, 1821, 43, 149, "Print",ExpressionUUID->"9e1a5644-d58a-4267-bb97-ed8584158ef5"]
}, Open  ]]
}, Open  ]],
Cell[122429, 2899, 204, 3, 35, "Text",ExpressionUUID->"28a49835-5a16-4645-b881-67a2d25990fb"],
Cell[CellGroupData[{
Cell[122658, 2906, 1951, 54, 190, "Input",ExpressionUUID->"eea2a739-1737-455e-8e17-b0f9f6d3867e"],
Cell[124612, 2962, 1934, 51, 80, "Output",ExpressionUUID->"d038d934-af20-4e50-b928-c9a8b1694d00"]
}, Open  ]],
Cell[126561, 3016, 587, 15, 47, "Text",ExpressionUUID->"2877c0e7-23c8-42e5-8f11-55f88b7bdcc6"],
Cell[CellGroupData[{
Cell[127173, 3035, 1522, 36, 143, "Input",ExpressionUUID->"208af341-3a27-414f-870d-b7f49091e66d"],
Cell[128698, 3073, 17919, 341, 279, "Output",ExpressionUUID->"255f5489-1d0c-4077-a44b-c094240c3bc5"]
}, Open  ]],
Cell[146632, 3417, 288, 7, 35, "Text",ExpressionUUID->"9171b97e-9ab2-4a74-b702-729924f50017"],
Cell[CellGroupData[{
Cell[146945, 3428, 2244, 56, 247, "Input",ExpressionUUID->"02e14d07-6722-480e-8116-e623907e891b"],
Cell[149192, 3486, 12648, 254, 240, "Output",ExpressionUUID->"25462f2c-87dd-4406-ab21-2ac53ac478fe"]
}, Open  ]],
Cell[161855, 3743, 1110, 27, 85, "Text",ExpressionUUID->"3c0058f5-616b-43e9-9a55-a8eae74ad4d9"],
Cell[CellGroupData[{
Cell[162990, 3774, 1216, 35, 145, "Input",ExpressionUUID->"cb5b2296-32bc-43e5-bb22-a932ec3c9538"],
Cell[164209, 3811, 1521, 40, 53, "Print",ExpressionUUID->"34952704-7993-4983-9b62-0b46f437b887"]
}, Open  ]],
Cell[165745, 3854, 1420, 30, 131, "Text",ExpressionUUID->"2dae0297-3c3e-4403-b2b7-3db2fa8635df"],
Cell[CellGroupData[{
Cell[167190, 3888, 1440, 40, 72, "Input",ExpressionUUID->"5ebe5836-e604-4a96-96a9-d74d3ee56230"],
Cell[168633, 3930, 1869, 53, 79, "Output",ExpressionUUID->"3e6173ee-dc6e-482d-b448-a6f4f84130db"]
}, Open  ]],
Cell[170517, 3986, 292, 4, 35, "Text",ExpressionUUID->"2eeb011a-dcfa-4c51-9dd8-1043366114fd"],
Cell[CellGroupData[{
Cell[170834, 3994, 2002, 55, 177, "Input",ExpressionUUID->"6c09b3d5-8cb2-4a16-b968-9b4ded5c5eb1"],
Cell[CellGroupData[{
Cell[172861, 4053, 752, 18, 41, "Print",ExpressionUUID->"1fe55f3d-44a5-4281-a52b-a608bc84c394"],
Cell[173616, 4073, 1147, 29, 50, "Print",ExpressionUUID->"9e5cddc7-89fa-4934-898d-378788bc9f9a"],
Cell[174766, 4104, 662, 15, 26, "Print",ExpressionUUID->"39e8112c-9bcd-433d-9443-874a4e932a4b"]
}, Open  ]],
Cell[175443, 4122, 20660, 403, 257, "Output",ExpressionUUID->"bbb56bec-726c-4089-b343-6de2b3741d41"]
}, Open  ]],
Cell[196118, 4528, 209, 4, 35, "Text",ExpressionUUID->"6f743431-7967-4419-b533-60392802e628"],
Cell[196330, 4534, 3290, 79, 183, "Text",ExpressionUUID->"477af2e5-eed7-47ee-90ba-3bb6eff880be"],
Cell[CellGroupData[{
Cell[199645, 4617, 543, 17, 29, "Input",ExpressionUUID->"ca0732f6-37bc-48a1-a3d7-047171f1c90d"],
Cell[200191, 4636, 951, 26, 111, "Output",ExpressionUUID->"7a778a91-eab0-4faa-9e08-5cf0031de248"]
}, Open  ]],
Cell[201157, 4665, 10758, 267, 364, "Text",ExpressionUUID->"e39aa447-bbab-44ae-b8e1-3ffcda782ec1"],
Cell[211918, 4934, 8470, 257, 565, "Input",ExpressionUUID->"7f765123-f10d-4ce3-9553-995633c30e81"],
Cell[220391, 5193, 3407, 81, 134, "Text",ExpressionUUID->"5254597e-d0ab-4e49-a673-c469d2754bb2"],
Cell[223801, 5276, 7040, 184, 393, "Input",ExpressionUUID->"6d9dba03-a33a-475b-9169-89547d2fb890"],
Cell[230844, 5462, 1317, 31, 83, "Text",ExpressionUUID->"130d0ac1-556b-4f33-a082-644e1d3f4d13"],
Cell[CellGroupData[{
Cell[232186, 5497, 666, 18, 51, "Input",ExpressionUUID->"bf5ded0b-f9a8-427c-9293-a13e3c7e66c8"],
Cell[232855, 5517, 5345, 155, 332, "Output",ExpressionUUID->"2c05a90d-6ca6-42aa-a364-373907d52cc0"]
}, Open  ]],
Cell[238215, 5675, 3038, 71, 124, "Text",ExpressionUUID->"96eb2e9c-435b-4da2-ba6f-6cce03e83b92"],
Cell[CellGroupData[{
Cell[241278, 5750, 2490, 60, 152, "Input",ExpressionUUID->"b4bb6867-fd32-4a33-aa04-98bed124fbc6"],
Cell[243771, 5812, 1078, 21, 49, "Output",ExpressionUUID->"1e1186dd-8e59-4d25-84dd-350212bb87ec"],
Cell[244852, 5835, 1141, 21, 31, "Print",ExpressionUUID->"6754e3f2-0090-4ccb-ae73-883d22bf7ce8"]
}, Open  ]],
Cell[246008, 5859, 1390, 38, 60, "Text",ExpressionUUID->"71cab039-3de7-40a2-a986-856847ad4839"],
Cell[CellGroupData[{
Cell[247423, 5901, 943, 23, 75, "Input",ExpressionUUID->"e8fdb5b9-f07c-46f2-b00a-0b73aadb0691"],
Cell[248369, 5926, 4811, 153, 299, "Output",ExpressionUUID->"ecc99440-2aa2-47b5-83e0-c1a9a9ad695e"]
}, Open  ]],
Cell[253195, 6082, 2381, 63, 82, "Text",ExpressionUUID->"839138bd-5834-48e7-a35a-02d3a4d73838"],
Cell[CellGroupData[{
Cell[255601, 6149, 1011, 20, 52, "Input",ExpressionUUID->"fc50b002-2630-4ca8-8322-d1fe8a885d4a"],
Cell[256615, 6171, 4751, 142, 256, "Output",ExpressionUUID->"87d02996-bb14-4dbd-9617-4de61f176110"]
}, Open  ]],
Cell[261381, 6316, 5019, 131, 138, "Text",ExpressionUUID->"0d28ae4a-153b-45de-b2bf-f7e739fe95cf"],
Cell[266403, 6449, 1693, 46, 112, "Input",ExpressionUUID->"d6706272-bcd4-49dc-9cf3-36acabaf1920"],
Cell[268099, 6497, 5440, 133, 153, "Text",ExpressionUUID->"34025c3b-37e3-4d4c-8880-241a7d4649a5"],
Cell[CellGroupData[{
Cell[273564, 6634, 2531, 60, 216, "Input",ExpressionUUID->"5339f98d-ff59-456a-8804-87087f315eea"],
Cell[276098, 6696, 564, 13, 23, "Print",ExpressionUUID->"f5c20425-17a5-4977-b3bf-f9cc31d5560b"]
}, Open  ]],
Cell[276677, 6712, 314, 7, 58, "Text",ExpressionUUID->"beb3cffc-497f-43a1-b601-877c2b3c3e9b"]
}, Open  ]]
}
]
*)

